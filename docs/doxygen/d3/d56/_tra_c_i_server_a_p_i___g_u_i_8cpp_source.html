<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SUMO - Simulation of Urban MObility: TraCIServerAPI_GUI.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="../../dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_46b8f36974b309f038ffc35aa047a32b.html">boni</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_52e5be8ca53cec2b5437a8ba83e8e4f0.html">Desktop</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_7de3ce0f65e0314f747915173f89e60e.html">DanielTouched</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_a0096e276045b3ff0719c75e0b3c59bf.html">sumo-0.14.0</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_e9b8d709919855cd07b0394009af2578.html">src</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_d83bd6893ed5bf1b7b655b05147498c3.html">gui</a>
  </div>
</div>
<div class="contents">
<h1>TraCIServerAPI_GUI.cpp</h1><a href="../../d3/d56/_tra_c_i_server_a_p_i___g_u_i_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************/</span>
<a name="l00009"></a>00009 <span class="comment">// APIs for getting/setting GUI values via TraCI</span>
<a name="l00010"></a>00010 <span class="comment">/****************************************************************************/</span>
<a name="l00011"></a>00011 <span class="comment">// SUMO, Simulation of Urban MObility; see http://sumo.sourceforge.net/</span>
<a name="l00012"></a>00012 <span class="comment">// Copyright (C) 2001-2012 DLR (http://www.dlr.de/) and contributors</span>
<a name="l00013"></a>00013 <span class="comment">/****************************************************************************/</span>
<a name="l00014"></a>00014 <span class="comment">//</span>
<a name="l00015"></a>00015 <span class="comment">//   This file is part of SUMO.</span>
<a name="l00016"></a>00016 <span class="comment">//   SUMO is free software: you can redistribute it and/or modify</span>
<a name="l00017"></a>00017 <span class="comment">//   it under the terms of the GNU General Public License as published by</span>
<a name="l00018"></a>00018 <span class="comment">//   the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00019"></a>00019 <span class="comment">//   (at your option) any later version.</span>
<a name="l00020"></a>00020 <span class="comment">//</span>
<a name="l00021"></a>00021 <span class="comment">/****************************************************************************/</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="comment">// ===========================================================================</span>
<a name="l00025"></a>00025 <span class="comment">// included modules</span>
<a name="l00026"></a>00026 <span class="comment">// ===========================================================================</span>
<a name="l00027"></a>00027 <span class="preprocessor">#ifdef _MSC_VER</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d3/d99/windows__config_8h.html">windows_config.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#else</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../db/d16/config_8h.html">config.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#endif</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a>00033 <span class="preprocessor">#ifndef NO_TRACI</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;fx.h&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="../../db/d7d/_g_u_i_main_window_8h.html">utils/gui/windows/GUIMainWindow.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="../../d6/db3/_g_u_i_gl_child_window_8h.html">utils/gui/windows/GUIGlChildWindow.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="../../d8/d3a/_g_u_i_s_u_m_o_abstract_view_8h.html">utils/gui/windows/GUISUMOAbstractView.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="../../d9/dfd/_g_u_i_perspective_changer_8h.html">utils/gui/windows/GUIPerspectiveChanger.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/d94/_m_f_x_image_helper_8h.html">utils/foxtools/MFXImageHelper.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html">traci-server/TraCIConstants.h</a>&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;<a class="code" href="../../d0/da0/_g_u_i_net_8h.html">guisim/GUINet.h</a>&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="../../d0/dbc/_g_u_i_vehicle_8h.html">guisim/GUIVehicle.h</a>&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/db6/_tra_c_i_server_a_p_i___g_u_i_8h.html">TraCIServerAPI_GUI.h</a>&quot;</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="preprocessor">#ifdef CHECK_MEMORY_LEAKS</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d7/d8d/debug__new_8h.html">foreign/nvwa/debug_new.h</a>&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#endif // CHECK_MEMORY_LEAKS</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="comment">// ===========================================================================</span>
<a name="l00052"></a>00052 <span class="comment">// used namespaces</span>
<a name="l00053"></a>00053 <span class="comment">// ===========================================================================</span>
<a name="l00054"></a>00054 <span class="keyword">using namespace </span>traci;
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">// ===========================================================================</span>
<a name="l00058"></a>00058 <span class="comment">// method definitions</span>
<a name="l00059"></a>00059 <span class="comment">// ===========================================================================</span>
<a name="l00060"></a>00060 <span class="keywordtype">bool</span>
<a name="l00061"></a><a class="code" href="../../d1/d4a/class_tra_c_i_server_a_p_i___g_u_i.html#aca0b53ff36e44f88712213f15501848a">00061</a> <a class="code" href="../../d1/d4a/class_tra_c_i_server_a_p_i___g_u_i.html#aca0b53ff36e44f88712213f15501848a" title="Processes a get value command (Command 0xac: Get GUI Variable).">TraCIServerAPI_GUI::processGet</a>(<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html">TraCIServer</a>&amp; server, tcpip::Storage&amp; inputStorage,
<a name="l00062"></a>00062                                tcpip::Storage&amp; outputStorage) <span class="keywordflow">throw</span>(<a class="code" href="../../d0/d48/classtraci_1_1_tra_c_i_exception.html">TraCIException</a>, std::invalid_argument) {
<a name="l00063"></a>00063     std::string warning = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// additional description for response</span>
<a name="l00064"></a>00064     <span class="comment">// variable &amp; id</span>
<a name="l00065"></a>00065     <span class="keywordtype">int</span> variable = inputStorage.readUnsignedByte();
<a name="l00066"></a>00066     std::string <span class="keywordtype">id</span> = inputStorage.readString();
<a name="l00067"></a>00067     <span class="comment">// check variable</span>
<a name="l00068"></a>00068     <span class="keywordflow">if</span> (variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a28687ff0fca27086bca2dfb0c0aa8708">ID_LIST</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a6223fc3eef58008e64e425ddf4136ea8">VAR_VIEW_ZOOM</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac7a52c618e295256a64a55c94bd754a2">VAR_VIEW_OFFSET</a>
<a name="l00069"></a>00069             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a48b64030823e73abcea5f383a07a6b60">VAR_VIEW_SCHEMA</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a3de049e7d6d515e3250a8af1bcd04565">VAR_VIEW_BOUNDARY</a>) {
<a name="l00070"></a>00070         server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a6f83cac4993ab850b3bf4ee317e185c3">CMD_GET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Get GUI Variable: unsupported variable specified&quot;</span>, outputStorage);
<a name="l00071"></a>00071         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00072"></a>00072     }
<a name="l00073"></a>00073     <span class="comment">// begin response building</span>
<a name="l00074"></a>00074     tcpip::Storage tempMsg;
<a name="l00075"></a>00075     <span class="comment">//  response-code, variableID, objectID</span>
<a name="l00076"></a>00076     tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ab8aa0b8c58b89bd0dcb5449e92c82b8c">RESPONSE_GET_GUI_VARIABLE</a>);
<a name="l00077"></a>00077     tempMsg.writeUnsignedByte(variable);
<a name="l00078"></a>00078     tempMsg.writeString(<span class="keywordtype">id</span>);
<a name="l00079"></a>00079     <span class="comment">// process request</span>
<a name="l00080"></a>00080     <span class="keywordflow">if</span> (variable == <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a28687ff0fca27086bca2dfb0c0aa8708">ID_LIST</a>) {
<a name="l00081"></a>00081         std::vector&lt;std::string&gt; ids = getMainWindow()-&gt;getViewIDs();
<a name="l00082"></a>00082         tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5561b6050ea28ec6d322e28848460c17">TYPE_STRINGLIST</a>);
<a name="l00083"></a>00083         tempMsg.writeStringList(ids);
<a name="l00084"></a>00084     } <span class="keywordflow">else</span> {
<a name="l00085"></a>00085         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html">GUISUMOAbstractView</a>* v = getNamedView(<span class="keywordtype">id</span>);
<a name="l00086"></a>00086         <span class="keywordflow">if</span> (v == 0) {
<a name="l00087"></a>00087             server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a6f83cac4993ab850b3bf4ee317e185c3">CMD_GET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;View &#39;&quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot;&#39; is not known&quot;</span>, outputStorage);
<a name="l00088"></a>00088             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00089"></a>00089         }
<a name="l00090"></a>00090         <span class="keywordflow">switch</span> (variable) {
<a name="l00091"></a>00091             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a6223fc3eef58008e64e425ddf4136ea8">VAR_VIEW_ZOOM</a>:
<a name="l00092"></a>00092                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00093"></a>00093                 tempMsg.writeDouble(v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a9434d003a5d244fca03c7ac3538f4ba6">getChanger</a>().<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aae37ebcfff45a2726cf3d65c6a8a33d5" title="Returns the zoom factor computed stored in this changer.">getZoom</a>());
<a name="l00094"></a>00094                 <span class="keywordflow">break</span>;
<a name="l00095"></a>00095             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac7a52c618e295256a64a55c94bd754a2">VAR_VIEW_OFFSET</a>:
<a name="l00096"></a>00096                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a9fc3eb37a8ae494084b863c411cf8c17">POSITION_2D</a>);
<a name="l00097"></a>00097                 tempMsg.writeDouble(v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a9434d003a5d244fca03c7ac3538f4ba6">getChanger</a>().<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a62baa29ee8d9e12cde85b816ce34f85e" title="Returns the x-offset of the field to show stored in this changer.">getXPos</a>());
<a name="l00098"></a>00098                 tempMsg.writeDouble(v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a9434d003a5d244fca03c7ac3538f4ba6">getChanger</a>().<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a6df84b97f6dd25f4ff750ed91c6b1aba" title="Returns the y-offset of the field to show stored in this changer.">getYPos</a>());
<a name="l00099"></a>00099                 <span class="keywordflow">break</span>;
<a name="l00100"></a>00100             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a48b64030823e73abcea5f383a07a6b60">VAR_VIEW_SCHEMA</a>: {
<a name="l00101"></a>00101                 FXComboBox&amp; c = v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a23237f35d730c6b98a8c33632de15320">getColoringSchemesCombo</a>();
<a name="l00102"></a>00102                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>);
<a name="l00103"></a>00103                 tempMsg.writeString((std::string)c.getItem(c.getCurrentItem()).text());
<a name="l00104"></a>00104                 <span class="keywordflow">break</span>;
<a name="l00105"></a>00105             }
<a name="l00106"></a>00106             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a3de049e7d6d515e3250a8af1bcd04565">VAR_VIEW_BOUNDARY</a>: {
<a name="l00107"></a>00107                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ad6279a78dbab9ba005c6c1ff819fb2bb">TYPE_BOUNDINGBOX</a>);
<a name="l00108"></a>00108                 <a class="code" href="../../d5/dda/class_boundary.html" title="A class that stores a 2D geometrical boundary.">Boundary</a> b = v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a82f8e51bbe0bae76c9049256e943a187">getVisibleBoundary</a>();
<a name="l00109"></a>00109                 tempMsg.writeDouble(b.<a class="code" href="../../d5/dda/class_boundary.html#a68c581ea01becd3954fcc808ac476040" title="Returns minimum x-coordinate.">xmin</a>());
<a name="l00110"></a>00110                 tempMsg.writeDouble(b.<a class="code" href="../../d5/dda/class_boundary.html#a23f3304d1d057aec6a5255f519cc567d" title="Returns minimum y-coordinate.">ymin</a>());
<a name="l00111"></a>00111                 tempMsg.writeDouble(b.<a class="code" href="../../d5/dda/class_boundary.html#ace0f25069b6d972da95a747136261fcd" title="Returns maximum x-coordinate.">xmax</a>());
<a name="l00112"></a>00112                 tempMsg.writeDouble(b.<a class="code" href="../../d5/dda/class_boundary.html#ab908d8e6c0fc8abdee797e789176a43e" title="Returns maximum y-coordinate.">ymax</a>());
<a name="l00113"></a>00113                 <span class="keywordflow">break</span>;
<a name="l00114"></a>00114             }
<a name="l00115"></a>00115             <span class="keywordflow">default</span>:
<a name="l00116"></a>00116                 <span class="keywordflow">break</span>;
<a name="l00117"></a>00117         }
<a name="l00118"></a>00118     }
<a name="l00119"></a>00119     server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a6f83cac4993ab850b3bf4ee317e185c3">CMD_GET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a541fc8755958a227fe412e2df7fa31fa">RTYPE_OK</a>, warning, outputStorage);
<a name="l00120"></a>00120     server.writeResponseWithLength(outputStorage, tempMsg);
<a name="l00121"></a>00121     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00122"></a>00122 }
<a name="l00123"></a>00123 
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 <span class="keywordtype">bool</span>
<a name="l00126"></a><a class="code" href="../../d1/d4a/class_tra_c_i_server_a_p_i___g_u_i.html#a4926a756556c8585407bc379aec1c702">00126</a> <a class="code" href="../../d1/d4a/class_tra_c_i_server_a_p_i___g_u_i.html#a4926a756556c8585407bc379aec1c702" title="Processes a set value command (Command 0xcc: Change GUI State).">TraCIServerAPI_GUI::processSet</a>(<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html">TraCIServer</a>&amp; server, tcpip::Storage&amp; inputStorage,
<a name="l00127"></a>00127                                tcpip::Storage&amp; outputStorage) <span class="keywordflow">throw</span>(<a class="code" href="../../d0/d48/classtraci_1_1_tra_c_i_exception.html">TraCIException</a>, std::invalid_argument) {
<a name="l00128"></a>00128     std::string warning = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// additional description for response</span>
<a name="l00129"></a>00129     <span class="comment">// variable</span>
<a name="l00130"></a>00130     <span class="keywordtype">int</span> variable = inputStorage.readUnsignedByte();
<a name="l00131"></a>00131     <span class="keywordflow">if</span> (variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a6223fc3eef58008e64e425ddf4136ea8">VAR_VIEW_ZOOM</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac7a52c618e295256a64a55c94bd754a2">VAR_VIEW_OFFSET</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a48b64030823e73abcea5f383a07a6b60">VAR_VIEW_SCHEMA</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a3de049e7d6d515e3250a8af1bcd04565">VAR_VIEW_BOUNDARY</a>
<a name="l00132"></a>00132             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4ae01bdb5b0bcb9237faecf1930af5b2">VAR_SCREENSHOT</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5762708bbdd17c389bfffb5a19143b4e">VAR_TRACK_VEHICLE</a>
<a name="l00133"></a>00133        ) {
<a name="l00134"></a>00134         server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54a1de506a4c7ca2344bb204cd19af8e">CMD_SET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Change GUI State: unsupported variable specified&quot;</span>, outputStorage);
<a name="l00135"></a>00135         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00136"></a>00136     }
<a name="l00137"></a>00137     <span class="comment">// id</span>
<a name="l00138"></a>00138     std::string <span class="keywordtype">id</span> = inputStorage.readString();
<a name="l00139"></a>00139     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html">GUISUMOAbstractView</a>* v = getNamedView(<span class="keywordtype">id</span>);
<a name="l00140"></a>00140     <span class="keywordflow">if</span> (v == 0) {
<a name="l00141"></a>00141         server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54a1de506a4c7ca2344bb204cd19af8e">CMD_SET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;View &#39;&quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot;&#39; is not known&quot;</span>, outputStorage);
<a name="l00142"></a>00142         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00143"></a>00143     }
<a name="l00144"></a>00144     <span class="comment">// process</span>
<a name="l00145"></a>00145     <span class="keywordtype">int</span> valueDataType = inputStorage.readUnsignedByte();
<a name="l00146"></a>00146     <span class="keywordflow">switch</span> (variable) {
<a name="l00147"></a>00147         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a6223fc3eef58008e64e425ddf4136ea8">VAR_VIEW_ZOOM</a>:
<a name="l00148"></a>00148             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>) {
<a name="l00149"></a>00149                 server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54a1de506a4c7ca2344bb204cd19af8e">CMD_SET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The zoom must be given as a double.&quot;</span>, outputStorage);
<a name="l00150"></a>00150                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00151"></a>00151             }
<a name="l00152"></a>00152             v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ab3018e0a20bfcf32bfc1271cd8a565fb" title="applies the given viewport settings">setViewport</a>(inputStorage.readDouble(), v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a9434d003a5d244fca03c7ac3538f4ba6">getChanger</a>().<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a62baa29ee8d9e12cde85b816ce34f85e" title="Returns the x-offset of the field to show stored in this changer.">getXPos</a>(), v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a9434d003a5d244fca03c7ac3538f4ba6">getChanger</a>().<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a6df84b97f6dd25f4ff750ed91c6b1aba" title="Returns the y-offset of the field to show stored in this changer.">getYPos</a>());
<a name="l00153"></a>00153             <span class="keywordflow">break</span>;
<a name="l00154"></a>00154         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac7a52c618e295256a64a55c94bd754a2">VAR_VIEW_OFFSET</a>: {
<a name="l00155"></a>00155             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a9fc3eb37a8ae494084b863c411cf8c17">POSITION_2D</a>) {
<a name="l00156"></a>00156                 server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54a1de506a4c7ca2344bb204cd19af8e">CMD_SET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The view port must be given as a position.&quot;</span>, outputStorage);
<a name="l00157"></a>00157                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00158"></a>00158             }
<a name="l00159"></a>00159             v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ab3018e0a20bfcf32bfc1271cd8a565fb" title="applies the given viewport settings">setViewport</a>(v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a9434d003a5d244fca03c7ac3538f4ba6">getChanger</a>().<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aae37ebcfff45a2726cf3d65c6a8a33d5" title="Returns the zoom factor computed stored in this changer.">getZoom</a>(), inputStorage.readDouble(), v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a9434d003a5d244fca03c7ac3538f4ba6">getChanger</a>().<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a6df84b97f6dd25f4ff750ed91c6b1aba" title="Returns the y-offset of the field to show stored in this changer.">getYPos</a>());
<a name="l00160"></a>00160             v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ab3018e0a20bfcf32bfc1271cd8a565fb" title="applies the given viewport settings">setViewport</a>(v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a9434d003a5d244fca03c7ac3538f4ba6">getChanger</a>().<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aae37ebcfff45a2726cf3d65c6a8a33d5" title="Returns the zoom factor computed stored in this changer.">getZoom</a>(), v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a9434d003a5d244fca03c7ac3538f4ba6">getChanger</a>().<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a62baa29ee8d9e12cde85b816ce34f85e" title="Returns the x-offset of the field to show stored in this changer.">getXPos</a>(), inputStorage.readDouble());
<a name="l00161"></a>00161         }
<a name="l00162"></a>00162         <span class="keywordflow">break</span>;
<a name="l00163"></a>00163         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a48b64030823e73abcea5f383a07a6b60">VAR_VIEW_SCHEMA</a>:
<a name="l00164"></a>00164             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00165"></a>00165                 server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54a1de506a4c7ca2344bb204cd19af8e">CMD_SET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The scheme must be specified by a string.&quot;</span>, outputStorage);
<a name="l00166"></a>00166                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00167"></a>00167             }
<a name="l00168"></a>00168             <span class="keywordflow">if</span> (!v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7368954c1a1294c71bb233f4405a626d">setColorScheme</a>(inputStorage.readString())) {
<a name="l00169"></a>00169                 server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54a1de506a4c7ca2344bb204cd19af8e">CMD_SET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The scheme is not known.&quot;</span>, outputStorage);
<a name="l00170"></a>00170                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00171"></a>00171             }
<a name="l00172"></a>00172             <span class="keywordflow">break</span>;
<a name="l00173"></a>00173         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a3de049e7d6d515e3250a8af1bcd04565">VAR_VIEW_BOUNDARY</a>: {
<a name="l00174"></a>00174             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ad6279a78dbab9ba005c6c1ff819fb2bb">TYPE_BOUNDINGBOX</a>) {
<a name="l00175"></a>00175                 server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54a1de506a4c7ca2344bb204cd19af8e">CMD_SET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The boundary must be specified by a bounding box.&quot;</span>, outputStorage);
<a name="l00176"></a>00176                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00177"></a>00177             }
<a name="l00178"></a>00178             <span class="keyword">const</span> <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> xmin = inputStorage.readDouble();
<a name="l00179"></a>00179             <span class="keyword">const</span> <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> ymin = inputStorage.readDouble();
<a name="l00180"></a>00180             <span class="keyword">const</span> <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> xmax = inputStorage.readDouble();
<a name="l00181"></a>00181             <span class="keyword">const</span> <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> ymax = inputStorage.readDouble();
<a name="l00182"></a>00182             <a class="code" href="../../d5/dda/class_boundary.html" title="A class that stores a 2D geometrical boundary.">Boundary</a> b(xmin, ymin, xmax, ymax);
<a name="l00183"></a>00183             v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a89f07a97c8886dcaed14eb4863b234d2" title="centers to the chosen artifact">centerTo</a>(b);
<a name="l00184"></a>00184             <span class="keywordflow">break</span>;
<a name="l00185"></a>00185         }
<a name="l00186"></a>00186         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4ae01bdb5b0bcb9237faecf1930af5b2">VAR_SCREENSHOT</a>: {
<a name="l00187"></a>00187             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00188"></a>00188                 server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54a1de506a4c7ca2344bb204cd19af8e">CMD_SET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Making a snapshot requires a file name.&quot;</span>, outputStorage);
<a name="l00189"></a>00189                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00190"></a>00190             }
<a name="l00191"></a>00191             std::string filename = inputStorage.readString();
<a name="l00192"></a>00192             std::string error = v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7f64e2ff0aae75bc0149c9d60aee1dce" title="Takes a snapshots and writes it into the given file.">makeSnapshot</a>(filename);
<a name="l00193"></a>00193             <span class="keywordflow">if</span> (error != <span class="stringliteral">&quot;&quot;</span>) {
<a name="l00194"></a>00194                 server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54a1de506a4c7ca2344bb204cd19af8e">CMD_SET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, error, outputStorage);
<a name="l00195"></a>00195                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00196"></a>00196             }
<a name="l00197"></a>00197         }
<a name="l00198"></a>00198         <span class="keywordflow">break</span>;
<a name="l00199"></a>00199         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5762708bbdd17c389bfffb5a19143b4e">VAR_TRACK_VEHICLE</a>: {
<a name="l00200"></a>00200             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00201"></a>00201                 server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54a1de506a4c7ca2344bb204cd19af8e">CMD_SET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Tracking requires a string vehicle ID.&quot;</span>, outputStorage);
<a name="l00202"></a>00202                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00203"></a>00203             }
<a name="l00204"></a>00204             std::string <span class="keywordtype">id</span> = inputStorage.readString();
<a name="l00205"></a>00205             <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == <span class="stringliteral">&quot;&quot;</span>) {
<a name="l00206"></a>00206                 v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ad00156161e3b71cfa827a8a1c415a7d2">stopTrack</a>();
<a name="l00207"></a>00207             } <span class="keywordflow">else</span> {
<a name="l00208"></a>00208                 <a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html" title="Representation of a vehicle.">SUMOVehicle</a>* veh = <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;<a class="code" href="../../dc/d5d/class_m_s_net.html#a5e74ee833cafefa74b84e2091ef135a3" title="Returns the vehicle control.">getVehicleControl</a>().<a class="code" href="../../db/d2f/class_m_s_vehicle_control.html#a7e0bba043cf6d995661667fc4961f0a3" title="Returns the vehicle with the given id.">getVehicle</a>(<span class="keywordtype">id</span>);
<a name="l00209"></a>00209                 <span class="keywordflow">if</span> (veh == 0) {
<a name="l00210"></a>00210                     server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54a1de506a4c7ca2344bb204cd19af8e">CMD_SET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Could not find vehicle &#39;&quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot;&#39;.&quot;</span>, outputStorage);
<a name="l00211"></a>00211                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00212"></a>00212                 }
<a name="l00213"></a>00213                 <span class="keywordflow">if</span> (!static_cast&lt;GUIVehicle*&gt;(veh)-&gt;hasActiveAddVisualisation(v, <a class="code" href="../../d6/d17/class_g_u_i_vehicle.html#a88f30009a2189c6f2bd6f0c8536df98aab75808081ba96b4691e9f3100995a68b" title="track vehicle">GUIVehicle::VO_TRACKED</a>)) {
<a name="l00214"></a>00214                     v-&gt;<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a091361da263bfef1aaf8a5b1b2a5c9d2">startTrack</a>(static_cast&lt;GUIVehicle*&gt;(veh)-&gt;getGlID());
<a name="l00215"></a>00215                     <span class="keyword">static_cast&lt;</span><a class="code" href="../../d6/d17/class_g_u_i_vehicle.html" title="A MSVehicle extended by some values for usage within the gui.">GUIVehicle</a>*<span class="keyword">&gt;</span>(veh)-&gt;addActiveAddVisualisation(v, <a class="code" href="../../d6/d17/class_g_u_i_vehicle.html#a88f30009a2189c6f2bd6f0c8536df98aab75808081ba96b4691e9f3100995a68b" title="track vehicle">GUIVehicle::VO_TRACKED</a>);
<a name="l00216"></a>00216                 }
<a name="l00217"></a>00217             }
<a name="l00218"></a>00218         }
<a name="l00219"></a>00219         <span class="keywordflow">default</span>:
<a name="l00220"></a>00220             <span class="keywordflow">break</span>;
<a name="l00221"></a>00221     }
<a name="l00222"></a>00222     server.writeStatusCmd(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54a1de506a4c7ca2344bb204cd19af8e">CMD_SET_GUI_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a541fc8755958a227fe412e2df7fa31fa">RTYPE_OK</a>, warning, outputStorage);
<a name="l00223"></a>00223     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00224"></a>00224 }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 <a class="code" href="../../db/dba/class_g_u_i_main_window.html">GUIMainWindow</a>*
<a name="l00228"></a><a class="code" href="../../d1/d4a/class_tra_c_i_server_a_p_i___g_u_i.html#a27ff1f04d37b0aacfa400a98c4977bf6">00228</a> <a class="code" href="../../d1/d4a/class_tra_c_i_server_a_p_i___g_u_i.html#a27ff1f04d37b0aacfa400a98c4977bf6" title="Returns the main window.">TraCIServerAPI_GUI::getMainWindow</a>() {
<a name="l00229"></a>00229     FXWindow* w = FXApp::instance()-&gt;getRootWindow()-&gt;getFirst();
<a name="l00230"></a>00230     <span class="keywordflow">while</span> (w != 0 &amp;&amp; dynamic_cast&lt;GUIMainWindow*&gt;(w) == 0) {
<a name="l00231"></a>00231         w = w-&gt;getNext();
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233     <span class="keywordflow">if</span> (w == 0) {
<a name="l00234"></a>00234         <span class="comment">// main window not found</span>
<a name="l00235"></a>00235         <span class="keywordflow">return</span> 0;
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237     <span class="keywordflow">return</span> <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dba/class_g_u_i_main_window.html">GUIMainWindow</a>*<span class="keyword">&gt;</span>(w);
<a name="l00238"></a>00238 }
<a name="l00239"></a>00239 
<a name="l00240"></a>00240 
<a name="l00241"></a>00241 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html">GUISUMOAbstractView</a>* <span class="keyword">const</span>
<a name="l00242"></a><a class="code" href="../../d1/d4a/class_tra_c_i_server_a_p_i___g_u_i.html#a11a3f17f99367c90ca83f3966ca34f9b">00242</a> <a class="code" href="../../d1/d4a/class_tra_c_i_server_a_p_i___g_u_i.html#a11a3f17f99367c90ca83f3966ca34f9b" title="Returns the named view.">TraCIServerAPI_GUI::getNamedView</a>(<span class="keyword">const</span> std::string&amp; <span class="keywordtype">id</span>) {
<a name="l00243"></a>00243     <a class="code" href="../../db/dba/class_g_u_i_main_window.html">GUIMainWindow</a>* mw = <span class="keyword">static_cast&lt;</span><a class="code" href="../../db/dba/class_g_u_i_main_window.html">GUIMainWindow</a>*<span class="keyword">&gt;</span>(<a class="code" href="../../d1/d4a/class_tra_c_i_server_a_p_i___g_u_i.html#a27ff1f04d37b0aacfa400a98c4977bf6" title="Returns the main window.">getMainWindow</a>());
<a name="l00244"></a>00244     <span class="keywordflow">if</span> (mw == 0) {
<a name="l00245"></a>00245         <span class="keywordflow">return</span> 0;
<a name="l00246"></a>00246     }
<a name="l00247"></a>00247     <a class="code" href="../../d3/d1b/class_g_u_i_gl_child_window.html">GUIGlChildWindow</a>* c = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d3/d1b/class_g_u_i_gl_child_window.html">GUIGlChildWindow</a>*<span class="keyword">&gt;</span>(mw-&gt;<a class="code" href="../../db/dba/class_g_u_i_main_window.html#a893891f63bbbb3d11e1aef537ec379b4">getViewByID</a>(<span class="keywordtype">id</span>));
<a name="l00248"></a>00248     <span class="keywordflow">if</span> (c == 0) {
<a name="l00249"></a>00249         <span class="keywordflow">return</span> 0;
<a name="l00250"></a>00250     }
<a name="l00251"></a>00251     <span class="keywordflow">return</span> c-&gt;<a class="code" href="../../d3/d1b/class_g_u_i_gl_child_window.html#a5a8649d48f170295cd7da4acecca3465">getView</a>();
<a name="l00252"></a>00252 }
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 <span class="preprocessor">#endif</span>
<a name="l00256"></a>00256 <span class="preprocessor"></span>
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 <span class="comment">/****************************************************************************/</span>
<a name="l00259"></a>00259 
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Jul 17 12:16:13 2012 for SUMO - Simulation of Urban MObility by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
