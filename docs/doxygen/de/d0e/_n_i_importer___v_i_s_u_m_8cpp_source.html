<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SUMO - Simulation of Urban MObility: NIImporter_VISUM.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="../../dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_46b8f36974b309f038ffc35aa047a32b.html">boni</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_52e5be8ca53cec2b5437a8ba83e8e4f0.html">Desktop</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_7de3ce0f65e0314f747915173f89e60e.html">DanielTouched</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_a0096e276045b3ff0719c75e0b3c59bf.html">sumo-0.14.0</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_e9b8d709919855cd07b0394009af2578.html">src</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_941ad1c9f6979a737b8a94dcef837464.html">netimport</a>
  </div>
</div>
<div class="contents">
<h1>NIImporter_VISUM.cpp</h1><a href="../../de/d0e/_n_i_importer___v_i_s_u_m_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************/</span>
<a name="l00010"></a>00010 <span class="comment">// A VISUM network importer</span>
<a name="l00011"></a>00011 <span class="comment">/****************************************************************************/</span>
<a name="l00012"></a>00012 <span class="comment">// SUMO, Simulation of Urban MObility; see http://sumo.sourceforge.net/</span>
<a name="l00013"></a>00013 <span class="comment">// Copyright (C) 2001-2012 DLR (http://www.dlr.de/) and contributors</span>
<a name="l00014"></a>00014 <span class="comment">/****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">//   This file is part of SUMO.</span>
<a name="l00017"></a>00017 <span class="comment">//   SUMO is free software: you can redistribute it and/or modify</span>
<a name="l00018"></a>00018 <span class="comment">//   it under the terms of the GNU General Public License as published by</span>
<a name="l00019"></a>00019 <span class="comment">//   the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00020"></a>00020 <span class="comment">//   (at your option) any later version.</span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 <span class="comment">/****************************************************************************/</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="comment">// ===========================================================================</span>
<a name="l00026"></a>00026 <span class="comment">// included modules</span>
<a name="l00027"></a>00027 <span class="comment">// ===========================================================================</span>
<a name="l00028"></a>00028 <span class="preprocessor">#ifdef _MSC_VER</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d3/d99/windows__config_8h.html">windows_config.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#else</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../db/d16/config_8h.html">config.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#endif</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="../../d4/df7/_msg_handler_8h.html">utils/common/MsgHandler.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="../../de/d4a/_tpl_convert_8h.html">utils/common/TplConvert.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="../../d8/d08/_to_string_8h.html">utils/common/ToString.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/d5c/_options_cont_8h.html">utils/options/OptionsCont.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/d6d/_geo_conv_helper_8h.html">utils/geom/GeoConvHelper.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="../../df/d03/_n_b_district_8h.html">netbuild/NBDistrict.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="../../d8/d6c/_tpl_convert_sec_8h.html">utils/common/TplConvertSec.h</a>&gt;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="../../dd/df1/_n_b_net_builder_8h.html">netbuild/NBNetBuilder.h</a>&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d16/_n_i_loader_8h.html">NILoader.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/d6b/_n_i_importer___v_i_s_u_m_8h.html">NIImporter_VISUM.h</a>&quot;</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#ifdef CHECK_MEMORY_LEAKS</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d7/d8d/debug__new_8h.html">foreign/nvwa/debug_new.h</a>&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#endif // CHECK_MEMORY_LEAKS</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="comment">// ===========================================================================</span>
<a name="l00053"></a>00053 <span class="comment">// method definitions</span>
<a name="l00054"></a>00054 <span class="comment">// ===========================================================================</span>
<a name="l00055"></a>00055 <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00056"></a>00056 <span class="comment">// static methods (interface in this case)</span>
<a name="l00057"></a>00057 <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00058"></a>00058 <span class="keywordtype">void</span>
<a name="l00059"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7cc03abad7bd307b627cc99ecb6a0240">00059</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7cc03abad7bd307b627cc99ecb6a0240" title="Loads network definition from the assigned option and stores it in the given network...">NIImporter_VISUM::loadNetwork</a>(<span class="keyword">const</span> <a class="code" href="../../db/d31/class_options_cont.html" title="A storage for options typed value containers).">OptionsCont</a>&amp; oc, <a class="code" href="../../d3/df6/class_n_b_net_builder.html" title="Instance responsible for building networks.">NBNetBuilder</a>&amp; nb) {
<a name="l00060"></a>00060     <span class="comment">// check whether the option is set (properly)</span>
<a name="l00061"></a>00061     <span class="keywordflow">if</span> (!oc.<a class="code" href="../../db/d31/class_options_cont.html#a08a62e1f4fcf9acaefc97efce45609fc" title="Returns the information whether the named option is set.">isSet</a>(<span class="stringliteral">&quot;visum-file&quot;</span>)) {
<a name="l00062"></a>00062         <span class="keywordflow">return</span>;
<a name="l00063"></a>00063     }
<a name="l00064"></a>00064     <span class="comment">// build the handler</span>
<a name="l00065"></a>00065     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html" title="A VISUM network importer.">NIImporter_VISUM</a> loader(nb, oc.<a class="code" href="../../db/d31/class_options_cont.html#a52d3421a5d26c2f95b99485de9daa50a" title="Returns the string-value of the named option (only for Option_String).">getString</a>(<span class="stringliteral">&quot;visum-file&quot;</span>),
<a name="l00066"></a>00066                             <a class="code" href="../../d3/d4c/class_n_b_capacity2_lanes.html" title="A helper class which computes the lane number from given capacity.">NBCapacity2Lanes</a>(oc.<a class="code" href="../../db/d31/class_options_cont.html#ad94844bde0bafb87b800b8f147b7ed16" title="Returns the SUMOReal-value of the named option (only for Option_Float).">getFloat</a>(<span class="stringliteral">&quot;lanes-from-capacity.norm&quot;</span>)),
<a name="l00067"></a>00067                             oc.<a class="code" href="../../db/d31/class_options_cont.html#a69874e7145a196b169c3c56eb58d3d57" title="Returns the boolean-value of the named option (only for Option_Bool).">getBool</a>(<span class="stringliteral">&quot;visum.use-type-priority&quot;</span>));
<a name="l00068"></a>00068     loader.load();
<a name="l00069"></a>00069 }
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00074"></a>00074 <span class="comment">// loader methods</span>
<a name="l00075"></a>00075 <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00076"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ae67edb403d8723cdb781de23b82b9811">00076</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ae67edb403d8723cdb781de23b82b9811" title="constructor">NIImporter_VISUM::NIImporter_VISUM</a>(<a class="code" href="../../d3/df6/class_n_b_net_builder.html" title="Instance responsible for building networks.">NBNetBuilder</a>&amp; nb,
<a name="l00077"></a>00077                                    <span class="keyword">const</span> std::string&amp; file,
<a name="l00078"></a>00078                                    <a class="code" href="../../d3/d4c/class_n_b_capacity2_lanes.html" title="A helper class which computes the lane number from given capacity.">NBCapacity2Lanes</a> capacity2Lanes,
<a name="l00079"></a>00079                                    <span class="keywordtype">bool</span> useVisumPrio)
<a name="l00080"></a>00080     : myNetBuilder(nb), myFileName(file),
<a name="l00081"></a>00081       myCapacity2Lanes(capacity2Lanes), myUseVisumPrio(useVisumPrio) {
<a name="l00082"></a>00082     <span class="comment">// the order of process is important!</span>
<a name="l00083"></a>00083     <span class="comment">// set1</span>
<a name="l00084"></a>00084     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;VSYS&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a3b1134290856c22810ace5263b47fe11" title="Parses VSYS.">NIImporter_VISUM::parse_VSysTypes</a>);
<a name="l00085"></a>00085     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;STRECKENTYP&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#adb8264416cb203a04996ce5bc014ae38" title="Parses STRECKENTYP.">NIImporter_VISUM::parse_Types</a>);
<a name="l00086"></a>00086     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;KNOTEN&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#acde18ff2a5bce28d12937e13410cea67" title="Parses KNOTEN.">NIImporter_VISUM::parse_Nodes</a>);
<a name="l00087"></a>00087     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;BEZIRK&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a56bc7cfdf8ee96078c70ad83c8e1b890" title="Parses BEZIRK.">NIImporter_VISUM::parse_Districts</a>);
<a name="l00088"></a>00088     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;PUNKT&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a56772fd9b0b6a9eb2b8b2c669620825f" title="Parses PUNKT.">NIImporter_VISUM::parse_Point</a>);
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 
<a name="l00091"></a>00091     <span class="comment">// set2</span>
<a name="l00092"></a>00092     <span class="comment">// two types of &quot;strecke&quot;</span>
<a name="l00093"></a>00093     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;STRECKE&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a1525061bb8bb9a257fd1c5b8bb2367fd" title="Parses STRECKE/STRECKEN.">NIImporter_VISUM::parse_Edges</a>);
<a name="l00094"></a>00094     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;STRECKEN&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a1525061bb8bb9a257fd1c5b8bb2367fd" title="Parses STRECKE/STRECKEN.">NIImporter_VISUM::parse_Edges</a>);
<a name="l00095"></a>00095     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;KANTE&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa1edaf001c35cb280f6645dbd3dbd503" title="Parses FLAECHENELEMENT.">NIImporter_VISUM::parse_Kante</a>);
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 
<a name="l00098"></a>00098     <span class="comment">// set3</span>
<a name="l00099"></a>00099     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;ANBINDUNG&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ae52c0f4eb385285017714cb27272e071" title="Parses ANBINDUNG.">NIImporter_VISUM::parse_Connectors</a>);
<a name="l00100"></a>00100     <span class="comment">// two types of &quot;abbieger&quot;</span>
<a name="l00101"></a>00101     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;ABBIEGEBEZIEHUNG&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ac0b993a26a663cc5b0b427c87bff6545" title="Parses ABBIEGEBEZIEHUNG/ABBIEGER.">NIImporter_VISUM::parse_Turns</a>);
<a name="l00102"></a>00102     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;ABBIEGER&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ac0b993a26a663cc5b0b427c87bff6545" title="Parses ABBIEGEBEZIEHUNG/ABBIEGER.">NIImporter_VISUM::parse_Turns</a>);
<a name="l00103"></a>00103 
<a name="l00104"></a>00104     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;STRECKENPOLY&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a89a196733aadbceebf667b7a6d666a76" title="Parses STRECKENPOLY.">NIImporter_VISUM::parse_EdgePolys</a>);
<a name="l00105"></a>00105     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;FAHRSTREIFEN&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab210d37a3e2e7b0f17d3559deedbe7b3" title="Parses FAHRSTREIFEN.">NIImporter_VISUM::parse_Lanes</a>);
<a name="l00106"></a>00106     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;FLAECHENELEMENT&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a4967d4c95ae401607d39244be495c476" title="Parses FLAECHENELEMENT.">NIImporter_VISUM::parse_PartOfArea</a>);
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 
<a name="l00109"></a>00109     <span class="comment">// set4</span>
<a name="l00110"></a>00110     <span class="comment">// two types of lsa</span>
<a name="l00111"></a>00111     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;LSA&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a4ea68aa7b098be9ebde8327be2946643" title="Parses LSA/SIGNALANLAGE.">NIImporter_VISUM::parse_TrafficLights</a>);
<a name="l00112"></a>00112     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;SIGNALANLAGE&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a4ea68aa7b098be9ebde8327be2946643" title="Parses LSA/SIGNALANLAGE.">NIImporter_VISUM::parse_TrafficLights</a>);
<a name="l00113"></a>00113     <span class="comment">// two types of knotenzulsa</span>
<a name="l00114"></a>00114     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;KNOTENZULSA&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a408a99bf0a4c0059e8bd91970cc6d276" title="Parses KNOTENZULSA/SIGNALANLAGEZUKNOTEN.">NIImporter_VISUM::parse_NodesToTrafficLights</a>);
<a name="l00115"></a>00115     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;LSAZUKNOTEN&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a408a99bf0a4c0059e8bd91970cc6d276" title="Parses KNOTENZULSA/SIGNALANLAGEZUKNOTEN.">NIImporter_VISUM::parse_NodesToTrafficLights</a>);
<a name="l00116"></a>00116     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;SIGNALANLAGEZUKNOTEN&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a408a99bf0a4c0059e8bd91970cc6d276" title="Parses KNOTENZULSA/SIGNALANLAGEZUKNOTEN.">NIImporter_VISUM::parse_NodesToTrafficLights</a>);
<a name="l00117"></a>00117     <span class="comment">// two types of signalgruppe</span>
<a name="l00118"></a>00118     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;LSASIGNALGRUPPE&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa26c705e979fa69dce449e989f6fe274" title="Parses LSASIGNALGRUPPE/SIGNALGRUPPE.">NIImporter_VISUM::parse_SignalGroups</a>);
<a name="l00119"></a>00119     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;SIGNALGRUPPE&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa26c705e979fa69dce449e989f6fe274" title="Parses LSASIGNALGRUPPE/SIGNALGRUPPE.">NIImporter_VISUM::parse_SignalGroups</a>);
<a name="l00120"></a>00120     <span class="comment">// two types of ABBZULSASIGNALGRUPPE</span>
<a name="l00121"></a>00121     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;ABBZULSASIGNALGRUPPE&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#acfc43257ac2818a63678ab50d763f669" title="Parses ABBZULSASIGNALGRUPPE/SIGNALGRUPPEZUABBIEGER.">NIImporter_VISUM::parse_TurnsToSignalGroups</a>);
<a name="l00122"></a>00122     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;SIGNALGRUPPEZUABBIEGER&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#acfc43257ac2818a63678ab50d763f669" title="Parses ABBZULSASIGNALGRUPPE/SIGNALGRUPPEZUABBIEGER.">NIImporter_VISUM::parse_TurnsToSignalGroups</a>);
<a name="l00123"></a>00123     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;SIGNALGRUPPEZUFSABBIEGER&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#acfc43257ac2818a63678ab50d763f669" title="Parses ABBZULSASIGNALGRUPPE/SIGNALGRUPPEZUABBIEGER.">NIImporter_VISUM::parse_TurnsToSignalGroups</a>);
<a name="l00124"></a>00124 
<a name="l00125"></a>00125     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;TEILFLAECHENELEMENT&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ae6ffc370161ff2882fda0441a69ad7a8" title="Parses ABBZULSASIGNALGRUPPE/SIGNALGRUPPEZUABBIEGER.">NIImporter_VISUM::parse_AreaSubPartElement</a>);
<a name="l00126"></a>00126 
<a name="l00127"></a>00127     <span class="comment">// two types of LSAPHASE</span>
<a name="l00128"></a>00128     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;LSAPHASE&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0858bdde842277c43e0df4717f1b93ea" title="Parses LSAPHASE/PHASE.">NIImporter_VISUM::parse_Phases</a>);
<a name="l00129"></a>00129     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;PHASE&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0858bdde842277c43e0df4717f1b93ea" title="Parses LSAPHASE/PHASE.">NIImporter_VISUM::parse_Phases</a>);
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;LSASIGNALGRUPPEZULSAPHASE&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9a5c72b7a44781a9915655cf3e2699bb" title="Parses LSASIGNALGRUPPEZULSAPHASE.">NIImporter_VISUM::parse_SignalGroupsToPhases</a>);
<a name="l00132"></a>00132     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">addParser</a>(<span class="stringliteral">&quot;FAHRSTREIFENABBIEGER&quot;</span>, &amp;<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad672e4cf8d9234d1b584c20a7c06bda3" title="Parses FAHRSTREIFENABBIEGER.">NIImporter_VISUM::parse_LanesConnections</a>);
<a name="l00133"></a>00133 }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135 
<a name="l00136"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2642bc1fb5e0e3aaa5c4df2c7eff0f09">00136</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2642bc1fb5e0e3aaa5c4df2c7eff0f09" title="destructor">NIImporter_VISUM::~NIImporter_VISUM</a>() {
<a name="l00137"></a>00137     <span class="keywordflow">for</span> (NIVisumTL_Map::iterator j = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a87292643d2dedb50ce8f5576228be62b">myNIVisumTLs</a>.begin(); j != <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a87292643d2dedb50ce8f5576228be62b">myNIVisumTLs</a>.end(); j++) {
<a name="l00138"></a>00138         <span class="keyword">delete</span> j-&gt;second;
<a name="l00139"></a>00139     }
<a name="l00140"></a>00140 }
<a name="l00141"></a>00141 
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 <span class="keywordtype">void</span>
<a name="l00144"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5">00144</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7c25e93b42be3ae5109de78e48afd0d5" title="Adds a parser into the sorted list of parsers to use.">NIImporter_VISUM::addParser</a>(<span class="keyword">const</span> std::string&amp; name, ParsingFunction function) {
<a name="l00145"></a>00145     <a class="code" href="../../dd/daa/struct_n_i_importer___v_i_s_u_m_1_1_type_parser.html" title="A complete call description for parsing a single db.">TypeParser</a> p;
<a name="l00146"></a>00146     p.<a class="code" href="../../dd/daa/struct_n_i_importer___v_i_s_u_m_1_1_type_parser.html#ab580a088bf9dd177a20b59603bff046b" title="The name of the db.">name</a> = name;
<a name="l00147"></a>00147     p.<a class="code" href="../../dd/daa/struct_n_i_importer___v_i_s_u_m_1_1_type_parser.html#a8ccc475ee93360f05c604b502911399e" title="Pointer to the function used for parsing.">function</a> = function;
<a name="l00148"></a>00148     p.<a class="code" href="../../dd/daa/struct_n_i_importer___v_i_s_u_m_1_1_type_parser.html#ab7eae77a385b0405327546df4e8793c7" title="Position of the according db within the file.">position</a> = -1;
<a name="l00149"></a>00149     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a958fc856a154c6f14f2128d381fae131" title="list of known parsers">mySingleDataParsers</a>.push_back(p);
<a name="l00150"></a>00150 }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="keywordtype">void</span>
<a name="l00154"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a03dbb3481b18e29ee4e46f072bd0f2b7">00154</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a03dbb3481b18e29ee4e46f072bd0f2b7" title="Parses the VISUM-network file storing the parsed structures within myNetBuilder.">NIImporter_VISUM::load</a>() {
<a name="l00155"></a>00155     <span class="comment">// open the file</span>
<a name="l00156"></a>00156     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a89bc03bac9b9a0bc26272e8ea7812738" title="the line reader to use to read from the file">myLineReader</a>.<a class="code" href="../../d4/db7/class_line_reader.html#ab1a67ae4b435ede2f16d7ab39b66f3a6" title="Reinitialises the reader for reading from the given file.">setFile</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7733a13e7485ece976c8251f3e709bfd" title="The name of the parsed file, for error reporting.">myFileName</a>)) {
<a name="l00157"></a>00157         <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Can not open visum-file &#39;&quot;</span> + <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a7733a13e7485ece976c8251f3e709bfd" title="The name of the parsed file, for error reporting.">myFileName</a> + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00158"></a>00158     }
<a name="l00159"></a>00159     <span class="comment">// scan the file for data positions</span>
<a name="l00160"></a>00160     <span class="keywordflow">while</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a89bc03bac9b9a0bc26272e8ea7812738" title="the line reader to use to read from the file">myLineReader</a>.<a class="code" href="../../d4/db7/class_line_reader.html#af59fa0b055fef2c2125fd84c235a0e22" title="Returns whether another line may be read (the file was not read completely).">hasMore</a>()) {
<a name="l00161"></a>00161         std::string line = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a89bc03bac9b9a0bc26272e8ea7812738" title="the line reader to use to read from the file">myLineReader</a>.<a class="code" href="../../d4/db7/class_line_reader.html#a613dc7fff089bb13910559367ff75719" title="Reads a single (the next) line from the file and reports it to the given LineHandler...">readLine</a>();
<a name="l00162"></a>00162         <span class="keywordflow">if</span> (line.length() &gt; 0 &amp;&amp; line[0] == <span class="charliteral">&#39;$&#39;</span>) {
<a name="l00163"></a>00163             ParserVector::iterator i;
<a name="l00164"></a>00164             <span class="keywordflow">for</span> (i = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a958fc856a154c6f14f2128d381fae131" title="list of known parsers">mySingleDataParsers</a>.begin(); i != <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a958fc856a154c6f14f2128d381fae131" title="list of known parsers">mySingleDataParsers</a>.end(); i++) {
<a name="l00165"></a>00165                 std::string dataName = <span class="stringliteral">&quot;$&quot;</span> + (*i).name + <span class="stringliteral">&quot;:&quot;</span>;
<a name="l00166"></a>00166                 <span class="keywordflow">if</span> (line.substr(0, dataName.length()) == dataName) {
<a name="l00167"></a>00167                     (*i).position = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a89bc03bac9b9a0bc26272e8ea7812738" title="the line reader to use to read from the file">myLineReader</a>.<a class="code" href="../../d4/db7/class_line_reader.html#a26526a8c94c31ed3bde2d029640d1204" title="Returns the current position within the file.">getPosition</a>();
<a name="l00168"></a>00168                     (*i).pattern = line.substr(dataName.length());
<a name="l00169"></a>00169                     <a class="code" href="../../d4/df7/_msg_handler_8h.html#a4ff0c29263eba441db6e23204912ff7f">WRITE_MESSAGE</a>(<span class="stringliteral">&quot;Found: &quot;</span> + dataName + <span class="stringliteral">&quot; at &quot;</span> + toString&lt;int&gt;(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a89bc03bac9b9a0bc26272e8ea7812738" title="the line reader to use to read from the file">myLineReader</a>.<a class="code" href="../../d4/db7/class_line_reader.html#a26526a8c94c31ed3bde2d029640d1204" title="Returns the current position within the file.">getPosition</a>()));
<a name="l00170"></a>00170                 }
<a name="l00171"></a>00171             }
<a name="l00172"></a>00172         }
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174     <span class="comment">// go through the parsers and process all entries</span>
<a name="l00175"></a>00175     <span class="keywordflow">for</span> (ParserVector::iterator i = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a958fc856a154c6f14f2128d381fae131" title="list of known parsers">mySingleDataParsers</a>.begin(); i != <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a958fc856a154c6f14f2128d381fae131" title="list of known parsers">mySingleDataParsers</a>.end(); i++) {
<a name="l00176"></a>00176         <span class="keywordflow">if</span> ((*i).position &lt; 0) {
<a name="l00177"></a>00177             <span class="comment">// do not process using parsers for which no information was found</span>
<a name="l00178"></a>00178             <span class="keywordflow">continue</span>;
<a name="l00179"></a>00179         }
<a name="l00180"></a>00180         <span class="comment">// ok, the according information is stored in the file</span>
<a name="l00181"></a>00181         <a class="code" href="../../d4/df7/_msg_handler_8h.html#afa3f7d0673e0a81062288662416bca15">PROGRESS_BEGIN_MESSAGE</a>(<span class="stringliteral">&quot;Parsing &quot;</span> + (*i).name);
<a name="l00182"></a>00182         <span class="comment">// reset the line reader and let it point to the begin of the according data field</span>
<a name="l00183"></a>00183         <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a89bc03bac9b9a0bc26272e8ea7812738" title="the line reader to use to read from the file">myLineReader</a>.<a class="code" href="../../d4/db7/class_line_reader.html#ab82aef5c4345f5b74f5b45aa97ccfd52" title="Reinitialises the reading (of the previous file).">reinit</a>();
<a name="l00184"></a>00184         <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a89bc03bac9b9a0bc26272e8ea7812738" title="the line reader to use to read from the file">myLineReader</a>.<a class="code" href="../../d4/db7/class_line_reader.html#a0307ff3cdf435f23db2c0f8952aa1e57" title="Sets the current position within the file to the given value.">setPos</a>((*i).position);
<a name="l00185"></a>00185         <span class="comment">// prepare the line parser</span>
<a name="l00186"></a>00186         <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a57044bdf910449246fb51eda3927c99b" title="Reinitialises the parser.">reinit</a>((*i).pattern);
<a name="l00187"></a>00187         <span class="comment">// read</span>
<a name="l00188"></a>00188         <span class="keywordtype">bool</span> singleDataEndFound = <span class="keyword">false</span>;
<a name="l00189"></a>00189         <span class="keywordflow">while</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a89bc03bac9b9a0bc26272e8ea7812738" title="the line reader to use to read from the file">myLineReader</a>.<a class="code" href="../../d4/db7/class_line_reader.html#af59fa0b055fef2c2125fd84c235a0e22" title="Returns whether another line may be read (the file was not read completely).">hasMore</a>() &amp;&amp; !singleDataEndFound) {
<a name="l00190"></a>00190             std::string line = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a89bc03bac9b9a0bc26272e8ea7812738" title="the line reader to use to read from the file">myLineReader</a>.<a class="code" href="../../d4/db7/class_line_reader.html#a613dc7fff089bb13910559367ff75719" title="Reads a single (the next) line from the file and reports it to the given LineHandler...">readLine</a>();
<a name="l00191"></a>00191             <span class="keywordflow">if</span> (line.length() == 0 || line[0] == <span class="charliteral">&#39;*&#39;</span> || line[0] == <span class="charliteral">&#39;$&#39;</span>) {
<a name="l00192"></a>00192                 singleDataEndFound = <span class="keyword">true</span>;
<a name="l00193"></a>00193             } <span class="keywordflow">else</span> {
<a name="l00194"></a>00194                 <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a8c02bfe0f9c634e4c130437408c1bf78" title="Parses the contents of the line.">parseLine</a>(line);
<a name="l00195"></a>00195                 <span class="keywordflow">try</span> {
<a name="l00196"></a>00196                     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> = <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>;
<a name="l00197"></a>00197                     (this-&gt;*(*i).function)();
<a name="l00198"></a>00198                 } <span class="keywordflow">catch</span> (<a class="code" href="../../d5/d35/class_out_of_bounds_exception.html">OutOfBoundsException</a>&amp;) {
<a name="l00199"></a>00199                     <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Too short value line in &quot;</span> + (*i).name + <span class="stringliteral">&quot; occured.&quot;</span>);
<a name="l00200"></a>00200                 } <span class="keywordflow">catch</span> (<a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>&amp;) {
<a name="l00201"></a>00201                     <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A value in &quot;</span> + (*i).name + <span class="stringliteral">&quot; should be numeric but is not (id=&#39;&quot;</span> + <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> + <span class="stringliteral">&quot;&#39;).&quot;</span>);
<a name="l00202"></a>00202                 } <span class="keywordflow">catch</span> (<a class="code" href="../../d6/dd4/class_unknown_element.html">UnknownElement</a>&amp; e) {
<a name="l00203"></a>00203                     <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;One of the needed values (&#39;&quot;</span> + std::string(e.what()) + <span class="stringliteral">&quot;&#39;) is missing in &quot;</span> + (*i).name + <span class="stringliteral">&quot;.&quot;</span>);
<a name="l00204"></a>00204                 }
<a name="l00205"></a>00205             }
<a name="l00206"></a>00206         }
<a name="l00207"></a>00207         <span class="comment">// close single reader processing</span>
<a name="l00208"></a>00208         <a class="code" href="../../d4/df7/_msg_handler_8h.html#ab1885dedc6abc417e920e02f58531924">PROGRESS_DONE_MESSAGE</a>();
<a name="l00209"></a>00209     }
<a name="l00210"></a>00210     <span class="comment">// build traffic lights</span>
<a name="l00211"></a>00211     <span class="keywordflow">for</span> (NIVisumTL_Map::iterator j = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a87292643d2dedb50ce8f5576228be62b">myNIVisumTLs</a>.begin(); j != <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a87292643d2dedb50ce8f5576228be62b">myNIVisumTLs</a>.end(); j++) {
<a name="l00212"></a>00212         j-&gt;second-&gt;build(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#aebffc1a8477a6c722b7edfa4a865e0da" title="Returns the traffic light logics container.">getTLLogicCont</a>());
<a name="l00213"></a>00213     }
<a name="l00214"></a>00214     <span class="comment">// build district shapes</span>
<a name="l00215"></a>00215     <span class="keywordflow">for</span> (std::map&lt;NBDistrict*, PositionVector&gt;::const_iterator k = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6dad564b50e8302138c1c76fab250b49" title="A temporary storage for district shapes as they are filled incrementally.">myDistrictShapes</a>.begin(); k != <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6dad564b50e8302138c1c76fab250b49" title="A temporary storage for district shapes as they are filled incrementally.">myDistrictShapes</a>.end(); ++k) {
<a name="l00216"></a>00216         (*k).first-&gt;addShape((*k).second);
<a name="l00217"></a>00217     }
<a name="l00218"></a>00218 }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 <span class="keywordtype">void</span>
<a name="l00225"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a3b1134290856c22810ace5263b47fe11">00225</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a3b1134290856c22810ace5263b47fe11" title="Parses VSYS.">NIImporter_VISUM::parse_VSysTypes</a>() {
<a name="l00226"></a>00226     std::string name = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;VSysCode&quot;</span>) ? <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;VSysCode&quot;</span>).c_str() : <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;CODE&quot;</span>).c_str();
<a name="l00227"></a>00227     std::string type = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;VSysMode&quot;</span>) ? <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;VSysMode&quot;</span>).c_str() : <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Typ&quot;</span>).c_str();
<a name="l00228"></a>00228     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a585cbf2bc29da3809e5c9535f2d80a7c" title="the used vsystypes">myVSysTypes</a>[name] = type;
<a name="l00229"></a>00229 }
<a name="l00230"></a>00230 
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="keywordtype">void</span>
<a name="l00233"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#adb8264416cb203a04996ce5bc014ae38">00233</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#adb8264416cb203a04996ce5bc014ae38" title="Parses STRECKENTYP.">NIImporter_VISUM::parse_Types</a>() {
<a name="l00234"></a>00234     <span class="comment">// get the id</span>
<a name="l00235"></a>00235     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Nr&quot;</span>));
<a name="l00236"></a>00236     <span class="comment">// get the maximum speed</span>
<a name="l00237"></a>00237     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> speed = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;v0-IV&quot;</span>, <span class="stringliteral">&quot;V0IV&quot;</span>);
<a name="l00238"></a>00238     <span class="comment">// get the priority</span>
<a name="l00239"></a>00239     <span class="keywordtype">int</span> priority = 1000 - <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2int</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Rang&quot;</span>).c_str());
<a name="l00240"></a>00240     <span class="comment">// try to retrieve the number of lanes</span>
<a name="l00241"></a>00241     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> cap = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;Kap-IV&quot;</span>, <span class="stringliteral">&quot;KAPIV&quot;</span>);
<a name="l00242"></a>00242     <span class="keywordtype">int</span> nolanes = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0af6ef895cf564d85b2c3cf40ac9ec12" title="the converter to compute the lane number of edges from their capacity">myCapacity2Lanes</a>.<a class="code" href="../../d3/d4c/class_n_b_capacity2_lanes.html#a1985ff81ccfacb2fa5bc86f4953f5c8c" title="Returns the number of lanes computed from the given capacity.">get</a>(cap);
<a name="l00243"></a>00243     <span class="comment">// insert the type</span>
<a name="l00244"></a>00244     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#a5c4fed8889dde5383bed0d68137cfede" title="Returns the type container.">getTypeCont</a>().<a class="code" href="../../db/d57/class_n_b_type_cont.html#a0bc5b858adb81f9d09d873e0e4c8c321" title="Adds a type into the list. This is a simplified convenience form of insert, if only...">insert</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>, nolanes, speed / (<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>) 3.6, priority, -1);
<a name="l00245"></a>00245 }
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 <span class="keywordtype">void</span>
<a name="l00249"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#acde18ff2a5bce28d12937e13410cea67">00249</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#acde18ff2a5bce28d12937e13410cea67" title="Parses KNOTEN.">NIImporter_VISUM::parse_Nodes</a>() {
<a name="l00250"></a>00250     <span class="comment">// get the id</span>
<a name="l00251"></a>00251     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Nr&quot;</span>));
<a name="l00252"></a>00252     <span class="comment">// get the position</span>
<a name="l00253"></a>00253     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> x = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;XKoord&quot;</span>);
<a name="l00254"></a>00254     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> y = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;YKoord&quot;</span>);
<a name="l00255"></a>00255     <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a> pos(x, y);
<a name="l00256"></a>00256     <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d26/class_n_i_loader.html#aff54c5ec457af6836a76d6745276f477" title="transforms loaded coordinates handles projections, offsets (using GeoConvHelper)...">NILoader::transformCoordinates</a>(pos)) {
<a name="l00257"></a>00257         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Unable to project coordinates for node &quot;</span> + <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> + <span class="stringliteral">&quot;.&quot;</span>);
<a name="l00258"></a>00258         <span class="keywordflow">return</span>;
<a name="l00259"></a>00259     }
<a name="l00260"></a>00260     <span class="comment">// add to the list</span>
<a name="l00261"></a>00261     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>().<a class="code" href="../../db/d8c/class_n_b_node_cont.html#ab70c3a2678e411a0b1e3edd41d2dd177" title="Inserts a node into the map.">insert</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>, pos)) {
<a name="l00262"></a>00262         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Duplicate node occured (&#39;&quot;</span> + <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> + <span class="stringliteral">&quot;&#39;).&quot;</span>);
<a name="l00263"></a>00263     }
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="keywordtype">void</span>
<a name="l00268"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a56bc7cfdf8ee96078c70ad83c8e1b890">00268</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a56bc7cfdf8ee96078c70ad83c8e1b890" title="Parses BEZIRK.">NIImporter_VISUM::parse_Districts</a>() {
<a name="l00269"></a>00269     <span class="comment">// get the id</span>
<a name="l00270"></a>00270     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Nr&quot;</span>));
<a name="l00271"></a>00271     <span class="comment">// get the information whether the source and the destination</span>
<a name="l00272"></a>00272     <span class="comment">//  connections are weighted</span>
<a name="l00273"></a>00273     <span class="comment">//bool sourcesWeighted = getWeightedBool(&quot;Proz_Q&quot;);</span>
<a name="l00274"></a>00274     <span class="comment">//bool destWeighted = getWeightedBool(&quot;Proz_Z&quot;);</span>
<a name="l00275"></a>00275     <span class="comment">// get the node information</span>
<a name="l00276"></a>00276     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> x = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;XKoord&quot;</span>);
<a name="l00277"></a>00277     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> y = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;YKoord&quot;</span>);
<a name="l00278"></a>00278     <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a> pos(x, y);
<a name="l00279"></a>00279     <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d26/class_n_i_loader.html#aff54c5ec457af6836a76d6745276f477" title="transforms loaded coordinates handles projections, offsets (using GeoConvHelper)...">NILoader::transformCoordinates</a>(pos, <span class="keyword">false</span>)) {
<a name="l00280"></a>00280         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Unable to project coordinates for district &quot;</span> + <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> + <span class="stringliteral">&quot;.&quot;</span>);
<a name="l00281"></a>00281         <span class="keywordflow">return</span>;
<a name="l00282"></a>00282     }
<a name="l00283"></a>00283     <span class="comment">// build the district</span>
<a name="l00284"></a>00284     <a class="code" href="../../d7/d91/class_n_b_district.html" title="A class representing a single district.">NBDistrict</a>* district = <span class="keyword">new</span> <a class="code" href="../../d7/d91/class_n_b_district.html" title="A class representing a single district.">NBDistrict</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>, pos);
<a name="l00285"></a>00285     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#a2edf6eadc99eaa3ec8c191a31b916693" title="Returns the districts container.">getDistrictCont</a>().<a class="code" href="../../d3/d1f/class_n_b_district_cont.html#a9ac5f69a2314d08b451685d9f0555423" title="Adds a district to the dictionary.">insert</a>(district)) {
<a name="l00286"></a>00286         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Duplicate district occured (&#39;&quot;</span> + <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> + <span class="stringliteral">&quot;&#39;).&quot;</span>);
<a name="l00287"></a>00287         <span class="keyword">delete</span> district;
<a name="l00288"></a>00288         <span class="keywordflow">return</span>;
<a name="l00289"></a>00289     }
<a name="l00290"></a>00290     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;FLAECHEID&quot;</span>)) {
<a name="l00291"></a>00291         <span class="keywordtype">long</span> flaecheID = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2long</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;FLAECHEID&quot;</span>).c_str());
<a name="l00292"></a>00292         <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#acb917ef66fb37c36cb5e32bbb1db4225" title="A map from district shape definition name to the district.">myShapeDistrictMap</a>[flaecheID] = district;
<a name="l00293"></a>00293     }
<a name="l00294"></a>00294 }
<a name="l00295"></a>00295 
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 <span class="keywordtype">void</span>
<a name="l00298"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a56772fd9b0b6a9eb2b8b2c669620825f">00298</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a56772fd9b0b6a9eb2b8b2c669620825f" title="Parses PUNKT.">NIImporter_VISUM::parse_Point</a>() {
<a name="l00299"></a>00299     <span class="keywordtype">long</span> <span class="keywordtype">id</span> = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2long</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;ID&quot;</span>).c_str());
<a name="l00300"></a>00300     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> x = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2SUMOReal</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;XKOORD&quot;</span>).c_str());
<a name="l00301"></a>00301     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> y = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2SUMOReal</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;YKOORD&quot;</span>).c_str());
<a name="l00302"></a>00302     <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a> pos(x, y);
<a name="l00303"></a>00303     <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d26/class_n_i_loader.html#aff54c5ec457af6836a76d6745276f477" title="transforms loaded coordinates handles projections, offsets (using GeoConvHelper)...">NILoader::transformCoordinates</a>(pos, <span class="keyword">false</span>)) {
<a name="l00304"></a>00304         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Unable to project coordinates for point &quot;</span> + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(<span class="keywordtype">id</span>) + <span class="stringliteral">&quot;.&quot;</span>);
<a name="l00305"></a>00305         <span class="keywordflow">return</span>;
<a name="l00306"></a>00306     }
<a name="l00307"></a>00307     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6ebaeb02ded377728c70e2b3f45e356f" title="A map of point ids to positions.">myPoints</a>[id] = pos;
<a name="l00308"></a>00308 }
<a name="l00309"></a>00309 
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="keywordtype">void</span>
<a name="l00312"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a1525061bb8bb9a257fd1c5b8bb2367fd">00312</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a1525061bb8bb9a257fd1c5b8bb2367fd" title="Parses STRECKE/STRECKEN.">NIImporter_VISUM::parse_Edges</a>() {
<a name="l00313"></a>00313     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;VSYSSET&quot;</span>) &amp;&amp; <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;VSYSSET&quot;</span>) == <span class="stringliteral">&quot;&quot;</span>) {
<a name="l00314"></a>00314         <span class="comment">// no vehicle allowed; don&#39;t add</span>
<a name="l00315"></a>00315         <span class="keywordflow">return</span>;
<a name="l00316"></a>00316     }
<a name="l00317"></a>00317     <span class="comment">// get the id</span>
<a name="l00318"></a>00318     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Nr&quot;</span>));
<a name="l00319"></a>00319     <span class="comment">// get the from- &amp; to-node and validate them</span>
<a name="l00320"></a>00320     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* from = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;VonKnot&quot;</span>, <span class="stringliteral">&quot;VonKnotNr&quot;</span>);
<a name="l00321"></a>00321     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* to = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;NachKnot&quot;</span>, <span class="stringliteral">&quot;NachKnotNr&quot;</span>);
<a name="l00322"></a>00322     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a91ca97f18f3627f93ec8bd458536b571" title="Returns whether both nodes are a valid combination of from/to-nodes.">checkNodes</a>(from, to)) {
<a name="l00323"></a>00323         <span class="keywordflow">return</span>;
<a name="l00324"></a>00324     }
<a name="l00325"></a>00325     <span class="comment">// get the type</span>
<a name="l00326"></a>00326     std::string type = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;Typ&quot;</span>) ? <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Typ&quot;</span>) : <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;TypNr&quot;</span>);
<a name="l00327"></a>00327     <span class="comment">// get the speed</span>
<a name="l00328"></a>00328     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> speed = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#a5c4fed8889dde5383bed0d68137cfede" title="Returns the type container.">getTypeCont</a>().<a class="code" href="../../db/d57/class_n_b_type_cont.html#ac5e013789fea67b88b8ba113980a7555" title="Returns the maximal velocity for the given type [m/s].">getSpeed</a>(type);
<a name="l00329"></a>00329     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().getBool(<span class="stringliteral">&quot;visum.use-type-speed&quot;</span>)) {
<a name="l00330"></a>00330         <span class="keywordflow">try</span> {
<a name="l00331"></a>00331             speed = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;v0-IV&quot;</span>)
<a name="l00332"></a>00332                     ? <a class="code" href="../../db/d13/class_tpl_convert_sec.html">TplConvertSec&lt;char&gt;::_2SUMORealSec</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;v0-IV&quot;</span>).c_str(), -1)
<a name="l00333"></a>00333                     : <a class="code" href="../../db/d13/class_tpl_convert_sec.html">TplConvertSec&lt;char&gt;::_2SUMORealSec</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;V0IV&quot;</span>).c_str(), -1);
<a name="l00334"></a>00334             speed = speed / (<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>) 3.6;
<a name="l00335"></a>00335         } <span class="keywordflow">catch</span> (<a class="code" href="../../d5/d35/class_out_of_bounds_exception.html">OutOfBoundsException</a>) {}
<a name="l00336"></a>00336     }
<a name="l00337"></a>00337     <span class="keywordflow">if</span> (speed &lt;= 0) {
<a name="l00338"></a>00338         speed = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#a5c4fed8889dde5383bed0d68137cfede" title="Returns the type container.">getTypeCont</a>().<a class="code" href="../../db/d57/class_n_b_type_cont.html#ac5e013789fea67b88b8ba113980a7555" title="Returns the maximal velocity for the given type [m/s].">getSpeed</a>(type);
<a name="l00339"></a>00339     }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341     <span class="comment">// get the information whether the edge is a one-way</span>
<a name="l00342"></a>00342     <span class="keywordtype">bool</span> oneway = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;Einbahn&quot;</span>)
<a name="l00343"></a>00343                   ? <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2bool</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Einbahn&quot;</span>).c_str())
<a name="l00344"></a>00344                   : <span class="keyword">true</span>;
<a name="l00345"></a>00345     <span class="comment">// get the number of lanes</span>
<a name="l00346"></a>00346     <span class="keywordtype">int</span> nolanes = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#a5c4fed8889dde5383bed0d68137cfede" title="Returns the type container.">getTypeCont</a>().<a class="code" href="../../db/d57/class_n_b_type_cont.html#a4be40be0868bd5e626ccfe99e52601a1" title="Returns the number of lanes for the given type.">getNumLanes</a>(type);
<a name="l00347"></a>00347     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().getBool(<span class="stringliteral">&quot;visum.recompute-lane-number&quot;</span>)) {
<a name="l00348"></a>00348         <span class="keywordflow">try</span> {
<a name="l00349"></a>00349             <span class="keywordflow">if</span> (!<a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().getBool(<span class="stringliteral">&quot;visum.use-type-laneno&quot;</span>)) {
<a name="l00350"></a>00350                 nolanes = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;Fahrstreifen&quot;</span>)
<a name="l00351"></a>00351                           ? <a class="code" href="../../db/d13/class_tpl_convert_sec.html">TplConvertSec&lt;char&gt;::_2intSec</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Fahrstreifen&quot;</span>).c_str(), 0)
<a name="l00352"></a>00352                           : <a class="code" href="../../db/d13/class_tpl_convert_sec.html">TplConvertSec&lt;char&gt;::_2intSec</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;ANZFAHRSTREIFEN&quot;</span>).c_str(), 0);
<a name="l00353"></a>00353             }
<a name="l00354"></a>00354         } <span class="keywordflow">catch</span> (<a class="code" href="../../d6/dd4/class_unknown_element.html">UnknownElement</a>) {
<a name="l00355"></a>00355         }
<a name="l00356"></a>00356     } <span class="keywordflow">else</span> {
<a name="l00357"></a>00357         <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> cap = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;KAPIV&quot;</span>)
<a name="l00358"></a>00358                        ? <a class="code" href="../../db/d13/class_tpl_convert_sec.html">TplConvertSec&lt;char&gt;::_2SUMORealSec</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;KAPIV&quot;</span>).c_str(), -1)
<a name="l00359"></a>00359                        : <a class="code" href="../../db/d13/class_tpl_convert_sec.html">TplConvertSec&lt;char&gt;::_2SUMORealSec</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;KAP-IV&quot;</span>).c_str(), -1);
<a name="l00360"></a>00360         nolanes = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0af6ef895cf564d85b2c3cf40ac9ec12" title="the converter to compute the lane number of edges from their capacity">myCapacity2Lanes</a>.<a class="code" href="../../d3/d4c/class_n_b_capacity2_lanes.html#a1985ff81ccfacb2fa5bc86f4953f5c8c" title="Returns the number of lanes computed from the given capacity.">get</a>(cap);
<a name="l00361"></a>00361     }
<a name="l00362"></a>00362     <span class="comment">// check whether the id is already used</span>
<a name="l00363"></a>00363     <span class="comment">//  (should be the opposite direction)</span>
<a name="l00364"></a>00364     <span class="keywordtype">bool</span> oneway_checked = oneway;
<a name="l00365"></a>00365     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* previous = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>);
<a name="l00366"></a>00366     <span class="keywordflow">if</span> (previous != 0) {
<a name="l00367"></a>00367         <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> = <span class="charliteral">&#39;-&#39;</span> + <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>;
<a name="l00368"></a>00368         previous-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a6d3c0bddf8b3ba45be65456e5e5dd651" title="(Re)sets how the lanes lateral offset shall be computed">setLaneSpreadFunction</a>(<a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511ae7e3b88514c3c8ec96b3be33ff58944b">LANESPREAD_RIGHT</a>);
<a name="l00369"></a>00369         oneway_checked = <span class="keyword">false</span>;
<a name="l00370"></a>00370     }
<a name="l00371"></a>00371     <span class="keywordflow">if</span> (find(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2878faadbd1a1f6555055426ff97a0ca" title="Already read edges.">myTouchedEdges</a>.begin(), <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2878faadbd1a1f6555055426ff97a0ca" title="Already read edges.">myTouchedEdges</a>.end(), <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>) != <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2878faadbd1a1f6555055426ff97a0ca" title="Already read edges.">myTouchedEdges</a>.end()) {
<a name="l00372"></a>00372         oneway_checked = <span class="keyword">false</span>;
<a name="l00373"></a>00373     }
<a name="l00374"></a>00374     std::string tmpid = <span class="charliteral">&#39;-&#39;</span> + <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>;
<a name="l00375"></a>00375     <span class="keywordflow">if</span> (find(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2878faadbd1a1f6555055426ff97a0ca" title="Already read edges.">myTouchedEdges</a>.begin(), <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2878faadbd1a1f6555055426ff97a0ca" title="Already read edges.">myTouchedEdges</a>.end(), tmpid) != <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2878faadbd1a1f6555055426ff97a0ca" title="Already read edges.">myTouchedEdges</a>.end()) {
<a name="l00376"></a>00376         previous = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(tmpid);
<a name="l00377"></a>00377         <span class="keywordflow">if</span> (previous != 0) {
<a name="l00378"></a>00378             previous-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a6d3c0bddf8b3ba45be65456e5e5dd651" title="(Re)sets how the lanes lateral offset shall be computed">setLaneSpreadFunction</a>(<a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511ae7e3b88514c3c8ec96b3be33ff58944b">LANESPREAD_RIGHT</a>);
<a name="l00379"></a>00379         }
<a name="l00380"></a>00380         oneway_checked = <span class="keyword">false</span>;
<a name="l00381"></a>00381     }
<a name="l00382"></a>00382     <span class="comment">// add the edge</span>
<a name="l00383"></a>00383     <span class="keywordtype">int</span> prio = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a8ba5683fc3fec591fd236d32cd9570b8" title="Information whether VISUM priority information shall be used.">myUseVisumPrio</a> ? <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#a5c4fed8889dde5383bed0d68137cfede" title="Returns the type container.">getTypeCont</a>().<a class="code" href="../../db/d57/class_n_b_type_cont.html#a4827ea02d078ac4cea43cd52ff551cc8" title="Returns the priority for the given type.">getPriority</a>(type) : -1;
<a name="l00384"></a>00384     <span class="keywordflow">if</span> (nolanes != 0 &amp;&amp; speed != 0) {
<a name="l00385"></a>00385         <a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511" title="Numbers representing special SUMO-XML-attribute values Information how the edge&amp;#39;s...">LaneSpreadFunction</a> lsf = oneway_checked ? <a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511a55d244ddc2721841db383d43bb60c01d">LANESPREAD_CENTER</a> : <a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511ae7e3b88514c3c8ec96b3be33ff58944b">LANESPREAD_RIGHT</a>;
<a name="l00386"></a>00386         <span class="comment">// @todo parse name from visum files</span>
<a name="l00387"></a>00387         <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* e = <span class="keyword">new</span> <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>, from, to, type, speed, nolanes, prio,
<a name="l00388"></a>00388                                <a class="code" href="../../d7/d41/class_n_b_edge.html#a0dd9544e9aac1c56a9c6b80d74ce2808" title="unspecified lane width">NBEdge::UNSPECIFIED_WIDTH</a>, <a class="code" href="../../d7/d41/class_n_b_edge.html#ab8dff601b260c1aafec075e08efa6d84" title="unspecified lane offset">NBEdge::UNSPECIFIED_OFFSET</a>, <span class="stringliteral">&quot;&quot;</span>, lsf);
<a name="l00389"></a>00389         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#addde5ff7cfc01b1ca492fe9120646a73" title="Adds an edge to the dictionary.">insert</a>(e)) {
<a name="l00390"></a>00390             <span class="keyword">delete</span> e;
<a name="l00391"></a>00391             <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Duplicate edge occured (&#39;&quot;</span> + <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> + <span class="stringliteral">&quot;&#39;).&quot;</span>);
<a name="l00392"></a>00392         }
<a name="l00393"></a>00393     }
<a name="l00394"></a>00394     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2878faadbd1a1f6555055426ff97a0ca" title="Already read edges.">myTouchedEdges</a>.push_back(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>);
<a name="l00395"></a>00395     <span class="comment">// nothing more to do, when the edge is a one-way street</span>
<a name="l00396"></a>00396     <span class="keywordflow">if</span> (oneway) {
<a name="l00397"></a>00397         <span class="keywordflow">return</span>;
<a name="l00398"></a>00398     }
<a name="l00399"></a>00399     <span class="comment">// add the opposite edge</span>
<a name="l00400"></a>00400     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> = <span class="charliteral">&#39;-&#39;</span> + <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>;
<a name="l00401"></a>00401     <span class="keywordflow">if</span> (nolanes != 0 &amp;&amp; speed != 0) {
<a name="l00402"></a>00402         <a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511" title="Numbers representing special SUMO-XML-attribute values Information how the edge&amp;#39;s...">LaneSpreadFunction</a> lsf = oneway_checked ? <a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511a55d244ddc2721841db383d43bb60c01d">LANESPREAD_CENTER</a> : <a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511ae7e3b88514c3c8ec96b3be33ff58944b">LANESPREAD_RIGHT</a>;
<a name="l00403"></a>00403         <span class="comment">// @todo parse name from visum files</span>
<a name="l00404"></a>00404         <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* e = <span class="keyword">new</span> <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>, from, to, type, speed, nolanes, prio,
<a name="l00405"></a>00405                                <a class="code" href="../../d7/d41/class_n_b_edge.html#a0dd9544e9aac1c56a9c6b80d74ce2808" title="unspecified lane width">NBEdge::UNSPECIFIED_WIDTH</a>, <a class="code" href="../../d7/d41/class_n_b_edge.html#ab8dff601b260c1aafec075e08efa6d84" title="unspecified lane offset">NBEdge::UNSPECIFIED_OFFSET</a>, <span class="stringliteral">&quot;&quot;</span>, lsf);
<a name="l00406"></a>00406         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#addde5ff7cfc01b1ca492fe9120646a73" title="Adds an edge to the dictionary.">insert</a>(e)) {
<a name="l00407"></a>00407             <span class="keyword">delete</span> e;
<a name="l00408"></a>00408             <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Duplicate edge occured (&#39;&quot;</span> + <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> + <span class="stringliteral">&quot;&#39;).&quot;</span>);
<a name="l00409"></a>00409         }
<a name="l00410"></a>00410     }
<a name="l00411"></a>00411     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2878faadbd1a1f6555055426ff97a0ca" title="Already read edges.">myTouchedEdges</a>.push_back(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>);
<a name="l00412"></a>00412 }
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 <span class="keywordtype">void</span>
<a name="l00416"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa1edaf001c35cb280f6645dbd3dbd503">00416</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa1edaf001c35cb280f6645dbd3dbd503" title="Parses FLAECHENELEMENT.">NIImporter_VISUM::parse_Kante</a>() {
<a name="l00417"></a>00417     <span class="keywordtype">long</span> <span class="keywordtype">id</span> = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2long</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;ID&quot;</span>).c_str());
<a name="l00418"></a>00418     <span class="keywordtype">long</span> from = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2long</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;VONPUNKTID&quot;</span>).c_str());
<a name="l00419"></a>00419     <span class="keywordtype">long</span> to = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2long</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;NACHPUNKTID&quot;</span>).c_str());
<a name="l00420"></a>00420     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9c1e1e2ce7d3aef2aa25ed531abd22fe" title="A map of edge (not road, but &amp;quot;edge&amp;quot; in this case) ids to from/to-points...">myEdges</a>[id] = std::make_pair(from, to);
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 <span class="keywordtype">void</span>
<a name="l00425"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a4967d4c95ae401607d39244be495c476">00425</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a4967d4c95ae401607d39244be495c476" title="Parses FLAECHENELEMENT.">NIImporter_VISUM::parse_PartOfArea</a>() {
<a name="l00426"></a>00426     <span class="keywordtype">long</span> flaecheID = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2long</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;FLAECHEID&quot;</span>).c_str());
<a name="l00427"></a>00427     <span class="keywordtype">long</span> flaechePartID = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2long</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;TFLAECHEID&quot;</span>).c_str());
<a name="l00428"></a>00428     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aca27f3e10b7896cd1dd48ea8a226fd0a" title="A map from area parts to area ids.">mySubPartsAreas</a>.find(flaechePartID) == <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aca27f3e10b7896cd1dd48ea8a226fd0a" title="A map from area parts to area ids.">mySubPartsAreas</a>.end()) {
<a name="l00429"></a>00429         <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aca27f3e10b7896cd1dd48ea8a226fd0a" title="A map from area parts to area ids.">mySubPartsAreas</a>[flaechePartID] = std::vector&lt;long&gt;();
<a name="l00430"></a>00430     }
<a name="l00431"></a>00431     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aca27f3e10b7896cd1dd48ea8a226fd0a" title="A map from area parts to area ids.">mySubPartsAreas</a>[flaechePartID].push_back(flaecheID);
<a name="l00432"></a>00432 }
<a name="l00433"></a>00433 
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 <span class="keywordtype">void</span>
<a name="l00436"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ae52c0f4eb385285017714cb27272e071">00436</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ae52c0f4eb385285017714cb27272e071" title="Parses ANBINDUNG.">NIImporter_VISUM::parse_Connectors</a>() {
<a name="l00437"></a>00437     <span class="keywordflow">if</span> (<a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().getBool(<span class="stringliteral">&quot;visum.no-connectors&quot;</span>)) {
<a name="l00438"></a>00438         <span class="comment">// do nothing, if connectors shall not be imported</span>
<a name="l00439"></a>00439         <span class="keywordflow">return</span>;
<a name="l00440"></a>00440     }
<a name="l00441"></a>00441     <span class="comment">// get the source district</span>
<a name="l00442"></a>00442     std::string bez = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;BezNr&quot;</span>));
<a name="l00443"></a>00443     <span class="comment">// get the destination node</span>
<a name="l00444"></a>00444     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* dest = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;KnotNr&quot;</span>);
<a name="l00445"></a>00445     <span class="keywordflow">if</span> (dest == 0) {
<a name="l00446"></a>00446         <span class="keywordflow">return</span>;
<a name="l00447"></a>00447     }
<a name="l00448"></a>00448     <span class="comment">// get the weight of the connection</span>
<a name="l00449"></a>00449     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> proz = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#adb9a483db77597dbd0ae18c356788c40" title="tries to get a SUMOReal which is possibly assigned to a certain modality">getWeightedFloat</a>(<span class="stringliteral">&quot;Proz&quot;</span>);
<a name="l00450"></a>00450     <span class="keywordflow">if</span> (proz &gt; 0) {
<a name="l00451"></a>00451         proz /= 100.;
<a name="l00452"></a>00452     } <span class="keywordflow">else</span> {
<a name="l00453"></a>00453         proz = 1;
<a name="l00454"></a>00454     }
<a name="l00455"></a>00455     <span class="comment">// get the duration to wait</span>
<a name="l00456"></a>00456     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> retard = -1;
<a name="l00457"></a>00457     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;t0-IV&quot;</span>)) {
<a name="l00458"></a>00458         retard = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;t0-IV&quot;</span>, -1);
<a name="l00459"></a>00459     }
<a name="l00460"></a>00460     <span class="comment">// get the type;</span>
<a name="l00461"></a>00461     <span class="comment">//  use a standard type with a large speed when a type is not given</span>
<a name="l00462"></a>00462     std::string type = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;Typ&quot;</span>)
<a name="l00463"></a>00463                        ? <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Typ&quot;</span>))
<a name="l00464"></a>00464                        : <span class="stringliteral">&quot;&quot;</span>;
<a name="l00465"></a>00465     <span class="comment">// add the connectors as an edge</span>
<a name="l00466"></a>00466     std::string <span class="keywordtype">id</span> = bez + <span class="stringliteral">&quot;-&quot;</span> + dest-&gt;getID();
<a name="l00467"></a>00467     <span class="comment">// get the information whether this is a sink or a source</span>
<a name="l00468"></a>00468     std::string dir = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Richtung&quot;</span>);
<a name="l00469"></a>00469     <span class="keywordflow">if</span> (dir.length() == 0) {
<a name="l00470"></a>00470         dir = <span class="stringliteral">&quot;QZ&quot;</span>;
<a name="l00471"></a>00471     }
<a name="l00472"></a>00472     <span class="comment">// build the source when needed</span>
<a name="l00473"></a>00473     <span class="keywordflow">if</span> (dir.find(<span class="charliteral">&#39;Q&#39;</span>) != std::string::npos) {
<a name="l00474"></a>00474         <span class="keyword">const</span> <a class="code" href="../../db/dde/_n_b_cont_8h.html#a7bbd80497f8b27f18697210825ec974a">EdgeVector</a>&amp; edges = dest-&gt;getOutgoingEdges();
<a name="l00475"></a>00475         <span class="keywordtype">bool</span> hasContinuation = <span class="keyword">false</span>;
<a name="l00476"></a>00476         <span class="keywordflow">for</span> (EdgeVector::const_iterator i = edges.begin(); i != edges.end(); ++i) {
<a name="l00477"></a>00477             <span class="keywordflow">if</span> (!(*i)-&gt;isMacroscopicConnector()) {
<a name="l00478"></a>00478                 hasContinuation = <span class="keyword">true</span>;
<a name="l00479"></a>00479             }
<a name="l00480"></a>00480         }
<a name="l00481"></a>00481         <span class="keywordflow">if</span> (!hasContinuation) {
<a name="l00482"></a>00482             <span class="comment">// obviously, there is no continuation on the net</span>
<a name="l00483"></a>00483             <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(<span class="stringliteral">&quot;Incoming connector &#39;&quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot;&#39; will not be build - would be not connected to network.&quot;</span>);
<a name="l00484"></a>00484         } <span class="keywordflow">else</span> {
<a name="l00485"></a>00485             <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* src = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aadfe33ba415589bf78c65c24d1a923b0" title="Builds a node for the given district and returns it.">buildDistrictNode</a>(bez, dest, <span class="keyword">true</span>);
<a name="l00486"></a>00486             <span class="keywordflow">if</span> (src == 0) {
<a name="l00487"></a>00487                 <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;The district &#39;&quot;</span> + bez + <span class="stringliteral">&quot;&#39; could not be built.&quot;</span>);
<a name="l00488"></a>00488                 <span class="keywordflow">return</span>;
<a name="l00489"></a>00489             }
<a name="l00490"></a>00490             <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* edge = <span class="keyword">new</span> <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>(<span class="keywordtype">id</span>, src, dest, <span class="stringliteral">&quot;VisumConnector&quot;</span>,
<a name="l00491"></a>00491                                       <a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().getFloat(<span class="stringliteral">&quot;visum.connector-speeds&quot;</span>),
<a name="l00492"></a>00492                                       <a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().getInt(<span class="stringliteral">&quot;visum.connectors-lane-number&quot;</span>),
<a name="l00493"></a>00493                                       -1, <a class="code" href="../../d7/d41/class_n_b_edge.html#a0dd9544e9aac1c56a9c6b80d74ce2808" title="unspecified lane width">NBEdge::UNSPECIFIED_WIDTH</a>, <a class="code" href="../../d7/d41/class_n_b_edge.html#ab8dff601b260c1aafec075e08efa6d84" title="unspecified lane offset">NBEdge::UNSPECIFIED_OFFSET</a>,
<a name="l00494"></a>00494                                       <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511ae7e3b88514c3c8ec96b3be33ff58944b">LANESPREAD_RIGHT</a>);
<a name="l00495"></a>00495             edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aee8ce7ef0a6540d59a6c69a735118d6c" title="Marks this edge as a macroscopic connector.">setAsMacroscopicConnector</a>();
<a name="l00496"></a>00496             <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#addde5ff7cfc01b1ca492fe9120646a73" title="Adds an edge to the dictionary.">insert</a>(edge)) {
<a name="l00497"></a>00497                 <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A duplicate edge id occured (ID=&#39;&quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot;&#39;).&quot;</span>);
<a name="l00498"></a>00498                 <span class="keywordflow">return</span>;
<a name="l00499"></a>00499             }
<a name="l00500"></a>00500             edge = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="keywordtype">id</span>);
<a name="l00501"></a>00501             <span class="keywordflow">if</span> (edge != 0) {
<a name="l00502"></a>00502                 <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#a2edf6eadc99eaa3ec8c191a31b916693" title="Returns the districts container.">getDistrictCont</a>().<a class="code" href="../../d3/d1f/class_n_b_district_cont.html#add961cd3ab6bd70eb55810ae2d02b85a" title="Adds a source to the named district.">addSource</a>(bez, edge, proz);
<a name="l00503"></a>00503             }
<a name="l00504"></a>00504         }
<a name="l00505"></a>00505     }
<a name="l00506"></a>00506     <span class="comment">// build the sink when needed</span>
<a name="l00507"></a>00507     <span class="keywordflow">if</span> (dir.find(<span class="charliteral">&#39;Z&#39;</span>) != std::string::npos) {
<a name="l00508"></a>00508         <span class="keyword">const</span> <a class="code" href="../../db/dde/_n_b_cont_8h.html#a7bbd80497f8b27f18697210825ec974a">EdgeVector</a>&amp; edges = dest-&gt;getIncomingEdges();
<a name="l00509"></a>00509         <span class="keywordtype">bool</span> hasPredeccessor = <span class="keyword">false</span>;
<a name="l00510"></a>00510         <span class="keywordflow">for</span> (EdgeVector::const_iterator i = edges.begin(); i != edges.end(); ++i) {
<a name="l00511"></a>00511             <span class="keywordflow">if</span> (!(*i)-&gt;isMacroscopicConnector()) {
<a name="l00512"></a>00512                 hasPredeccessor = <span class="keyword">true</span>;
<a name="l00513"></a>00513             }
<a name="l00514"></a>00514         }
<a name="l00515"></a>00515         <span class="keywordflow">if</span> (!hasPredeccessor) {
<a name="l00516"></a>00516             <span class="comment">// obviously, the network is not connected to this node</span>
<a name="l00517"></a>00517             <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(<span class="stringliteral">&quot;Outgoing connector &#39;&quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot;&#39; will not be build - would be not connected to network.&quot;</span>);
<a name="l00518"></a>00518         } <span class="keywordflow">else</span> {
<a name="l00519"></a>00519             <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* src = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aadfe33ba415589bf78c65c24d1a923b0" title="Builds a node for the given district and returns it.">buildDistrictNode</a>(bez, dest, <span class="keyword">false</span>);
<a name="l00520"></a>00520             <span class="keywordflow">if</span> (src == 0) {
<a name="l00521"></a>00521                 <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;The district &#39;&quot;</span> + bez + <span class="stringliteral">&quot;&#39; could not be built.&quot;</span>);
<a name="l00522"></a>00522                 <span class="keywordflow">return</span>;
<a name="l00523"></a>00523             }
<a name="l00524"></a>00524             <span class="keywordtype">id</span> = <span class="stringliteral">&quot;-&quot;</span> + id;
<a name="l00525"></a>00525             <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* edge = <span class="keyword">new</span> <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>(<span class="keywordtype">id</span>, dest, src, <span class="stringliteral">&quot;VisumConnector&quot;</span>,
<a name="l00526"></a>00526                                       <a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().getFloat(<span class="stringliteral">&quot;visum.connector-speeds&quot;</span>),
<a name="l00527"></a>00527                                       <a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().getInt(<span class="stringliteral">&quot;visum.connectors-lane-number&quot;</span>),
<a name="l00528"></a>00528                                       -1, <a class="code" href="../../d7/d41/class_n_b_edge.html#a0dd9544e9aac1c56a9c6b80d74ce2808" title="unspecified lane width">NBEdge::UNSPECIFIED_WIDTH</a>, <a class="code" href="../../d7/d41/class_n_b_edge.html#ab8dff601b260c1aafec075e08efa6d84" title="unspecified lane offset">NBEdge::UNSPECIFIED_OFFSET</a>,
<a name="l00529"></a>00529                                       <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511ae7e3b88514c3c8ec96b3be33ff58944b">LANESPREAD_RIGHT</a>);
<a name="l00530"></a>00530             edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aee8ce7ef0a6540d59a6c69a735118d6c" title="Marks this edge as a macroscopic connector.">setAsMacroscopicConnector</a>();
<a name="l00531"></a>00531             <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#addde5ff7cfc01b1ca492fe9120646a73" title="Adds an edge to the dictionary.">insert</a>(edge)) {
<a name="l00532"></a>00532                 <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A duplicate edge id occured (ID=&#39;&quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot;&#39;).&quot;</span>);
<a name="l00533"></a>00533                 <span class="keywordflow">return</span>;
<a name="l00534"></a>00534             }
<a name="l00535"></a>00535             edge = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="keywordtype">id</span>);
<a name="l00536"></a>00536             <span class="keywordflow">if</span> (edge != 0) {
<a name="l00537"></a>00537                 <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#a2edf6eadc99eaa3ec8c191a31b916693" title="Returns the districts container.">getDistrictCont</a>().<a class="code" href="../../d3/d1f/class_n_b_district_cont.html#a06f31a2873e0e4d775ae1b1328adc252" title="Adds a sink to the named district.">addSink</a>(bez, edge, proz);
<a name="l00538"></a>00538             }
<a name="l00539"></a>00539         }
<a name="l00540"></a>00540     }
<a name="l00541"></a>00541 }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 
<a name="l00544"></a>00544 <span class="keywordtype">void</span>
<a name="l00545"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ac0b993a26a663cc5b0b427c87bff6545">00545</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ac0b993a26a663cc5b0b427c87bff6545" title="Parses ABBIEGEBEZIEHUNG/ABBIEGER.">NIImporter_VISUM::parse_Turns</a>() {
<a name="l00546"></a>00546     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;VSYSSET&quot;</span>) &amp;&amp; <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;VSYSSET&quot;</span>) == <span class="stringliteral">&quot;&quot;</span>) {
<a name="l00547"></a>00547         <span class="comment">// no vehicle allowed; don&#39;t add</span>
<a name="l00548"></a>00548         <span class="keywordflow">return</span>;
<a name="l00549"></a>00549     }
<a name="l00550"></a>00550     <span class="comment">// retrieve the nodes</span>
<a name="l00551"></a>00551     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* from = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;VonKnot&quot;</span>, <span class="stringliteral">&quot;VonKnotNr&quot;</span>);
<a name="l00552"></a>00552     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* via = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;UeberKnot&quot;</span>, <span class="stringliteral">&quot;UeberKnotNr&quot;</span>);
<a name="l00553"></a>00553     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* to = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;NachKnot&quot;</span>, <span class="stringliteral">&quot;NachKnotNr&quot;</span>);
<a name="l00554"></a>00554     <span class="keywordflow">if</span> (from == 0 || via == 0 || to == 0) {
<a name="l00555"></a>00555         <span class="keywordflow">return</span>;
<a name="l00556"></a>00556     }
<a name="l00557"></a>00557     <span class="comment">// all nodes are known</span>
<a name="l00558"></a>00558     std::string type = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;VSysCode&quot;</span>)
<a name="l00559"></a>00559                        ? <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;VSysCode&quot;</span>)
<a name="l00560"></a>00560                        : <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;VSYSSET&quot;</span>);
<a name="l00561"></a>00561     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a585cbf2bc29da3809e5c9535f2d80a7c" title="the used vsystypes">myVSysTypes</a>.find(type) != <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a585cbf2bc29da3809e5c9535f2d80a7c" title="the used vsystypes">myVSysTypes</a>.end() &amp;&amp; <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a585cbf2bc29da3809e5c9535f2d80a7c" title="the used vsystypes">myVSysTypes</a>.find(type)-&gt;second == <span class="stringliteral">&quot;IV&quot;</span>) {
<a name="l00562"></a>00562         <span class="comment">// try to set the turning definition</span>
<a name="l00563"></a>00563         <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* src = from-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a8dbe9de053a4e9097a4afb7c719b2387">getConnectionTo</a>(via);
<a name="l00564"></a>00564         <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* dest = via-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a8dbe9de053a4e9097a4afb7c719b2387">getConnectionTo</a>(to);
<a name="l00565"></a>00565         <span class="comment">// check both</span>
<a name="l00566"></a>00566         <span class="keywordflow">if</span> (src == 0) {
<a name="l00567"></a>00567             <span class="comment">// maybe it was removed due to something</span>
<a name="l00568"></a>00568             <span class="keywordflow">if</span> (<a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().isSet(<span class="stringliteral">&quot;keep-edges.min-speed&quot;</span>)
<a name="l00569"></a>00569                     ||
<a name="l00570"></a>00570                     <a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().isSet(<span class="stringliteral">&quot;keep-edges.explicit&quot;</span>)) {
<a name="l00571"></a>00571                 <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(<span class="stringliteral">&quot;Could not set connection from node &#39;&quot;</span> + from-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; to node &#39;&quot;</span> + via-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00572"></a>00572             } <span class="keywordflow">else</span> {
<a name="l00573"></a>00573                 <span class="keywordflow">if</span> (<a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().<a class="code" href="../../db/d31/class_options_cont.html#a69874e7145a196b169c3c56eb58d3d57" title="Returns the boolean-value of the named option (only for Option_Bool).">getBool</a>(<span class="stringliteral">&quot;visum.verbose-warnings&quot;</span>)) {
<a name="l00574"></a>00574                     <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(<span class="stringliteral">&quot;There is no edge from node &#39;&quot;</span> + from-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; to node &#39;&quot;</span> + via-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00575"></a>00575                 }
<a name="l00576"></a>00576             }
<a name="l00577"></a>00577             <span class="keywordflow">return</span>;
<a name="l00578"></a>00578         }
<a name="l00579"></a>00579         <span class="keywordflow">if</span> (dest == 0) {
<a name="l00580"></a>00580             <span class="keywordflow">if</span> (<a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().<a class="code" href="../../db/d31/class_options_cont.html#a08a62e1f4fcf9acaefc97efce45609fc" title="Returns the information whether the named option is set.">isSet</a>(<span class="stringliteral">&quot;keep-edges.min-speed&quot;</span>)
<a name="l00581"></a>00581                     ||
<a name="l00582"></a>00582                     <a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().<a class="code" href="../../db/d31/class_options_cont.html#a08a62e1f4fcf9acaefc97efce45609fc" title="Returns the information whether the named option is set.">isSet</a>(<span class="stringliteral">&quot;keep-edges.explicit&quot;</span>)) {
<a name="l00583"></a>00583                 <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(<span class="stringliteral">&quot;Could not set connection from node &#39;&quot;</span> + via-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; to node &#39;&quot;</span> + to-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00584"></a>00584             } <span class="keywordflow">else</span> {
<a name="l00585"></a>00585                 <span class="keywordflow">if</span> (<a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().<a class="code" href="../../db/d31/class_options_cont.html#a69874e7145a196b169c3c56eb58d3d57" title="Returns the boolean-value of the named option (only for Option_Bool).">getBool</a>(<span class="stringliteral">&quot;visum.verbose-warnings&quot;</span>)) {
<a name="l00586"></a>00586                     <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(<span class="stringliteral">&quot;There is no edge from node &#39;&quot;</span> + via-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; to node &#39;&quot;</span> + to-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00587"></a>00587                 }
<a name="l00588"></a>00588             }
<a name="l00589"></a>00589             <span class="keywordflow">return</span>;
<a name="l00590"></a>00590         }
<a name="l00591"></a>00591         <span class="comment">// both edges found</span>
<a name="l00592"></a>00592         <span class="comment">//  set them into the edge</span>
<a name="l00593"></a>00593         src-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a4fe9756ad6fc8f4c493e5e2986c1f188">setTurningDestination</a>(dest);
<a name="l00594"></a>00594     }
<a name="l00595"></a>00595 }
<a name="l00596"></a>00596 
<a name="l00597"></a>00597 
<a name="l00598"></a>00598 <span class="keywordtype">void</span>
<a name="l00599"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a89a196733aadbceebf667b7a6d666a76">00599</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a89a196733aadbceebf667b7a6d666a76" title="Parses STRECKENPOLY.">NIImporter_VISUM::parse_EdgePolys</a>() {
<a name="l00600"></a>00600     <span class="comment">// get the from- &amp; to-node and validate them</span>
<a name="l00601"></a>00601     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* from = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;VonKnot&quot;</span>, <span class="stringliteral">&quot;VonKnotNr&quot;</span>);
<a name="l00602"></a>00602     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* to = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;NachKnot&quot;</span>, <span class="stringliteral">&quot;NachKnotNr&quot;</span>);
<a name="l00603"></a>00603     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a91ca97f18f3627f93ec8bd458536b571" title="Returns whether both nodes are a valid combination of from/to-nodes.">checkNodes</a>(from, to)) {
<a name="l00604"></a>00604         <span class="keywordflow">return</span>;
<a name="l00605"></a>00605     }
<a name="l00606"></a>00606     <span class="keywordtype">bool</span> failed = <span class="keyword">false</span>;
<a name="l00607"></a>00607     <span class="keywordtype">int</span> index;
<a name="l00608"></a>00608     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> x, y;
<a name="l00609"></a>00609     <span class="keywordflow">try</span> {
<a name="l00610"></a>00610         index = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2int</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;INDEX&quot;</span>).c_str());
<a name="l00611"></a>00611         x = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;XKoord&quot;</span>);
<a name="l00612"></a>00612         y = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;YKoord&quot;</span>);
<a name="l00613"></a>00613     } <span class="keywordflow">catch</span> (<a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>&amp;) {
<a name="l00614"></a>00614         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Error in geometry description from node &#39;&quot;</span> + from-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; to node &#39;&quot;</span> + to-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00615"></a>00615         <span class="keywordflow">return</span>;
<a name="l00616"></a>00616     }
<a name="l00617"></a>00617     <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a> pos(x, y);
<a name="l00618"></a>00618     <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d26/class_n_i_loader.html#aff54c5ec457af6836a76d6745276f477" title="transforms loaded coordinates handles projections, offsets (using GeoConvHelper)...">NILoader::transformCoordinates</a>(pos)) {
<a name="l00619"></a>00619         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Unable to project coordinates for node &#39;&quot;</span> + from-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00620"></a>00620         <span class="keywordflow">return</span>;
<a name="l00621"></a>00621     }
<a name="l00622"></a>00622     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* e = from-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a8dbe9de053a4e9097a4afb7c719b2387">getConnectionTo</a>(to);
<a name="l00623"></a>00623     <span class="keywordflow">if</span> (e != 0) {
<a name="l00624"></a>00624         e-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a06f2bd49ae01c300416d0ce5d345c421" title="Adds a further geometry point.">addGeometryPoint</a>(index, pos);
<a name="l00625"></a>00625     } <span class="keywordflow">else</span> {
<a name="l00626"></a>00626         failed = <span class="keyword">true</span>;
<a name="l00627"></a>00627     }
<a name="l00628"></a>00628     e = to-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a8dbe9de053a4e9097a4afb7c719b2387">getConnectionTo</a>(from);
<a name="l00629"></a>00629     <span class="keywordflow">if</span> (e != 0) {
<a name="l00630"></a>00630         e-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a06f2bd49ae01c300416d0ce5d345c421" title="Adds a further geometry point.">addGeometryPoint</a>(-index, pos);
<a name="l00631"></a>00631         failed = <span class="keyword">false</span>;
<a name="l00632"></a>00632     }
<a name="l00633"></a>00633     <span class="comment">// check whether the operation has failed</span>
<a name="l00634"></a>00634     <span class="keywordflow">if</span> (failed) {
<a name="l00635"></a>00635         <span class="comment">// we should report this to the warning instance only if we have removed</span>
<a name="l00636"></a>00636         <span class="comment">//  some nodes or edges...</span>
<a name="l00637"></a>00637         <span class="keywordflow">if</span> (<a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().isSet(<span class="stringliteral">&quot;keep-edges.min-speed&quot;</span>) || <a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().isSet(<span class="stringliteral">&quot;keep-edges.explicit&quot;</span>)) {
<a name="l00638"></a>00638             <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(<span class="stringliteral">&quot;Could not set geometry between node &#39;&quot;</span> + from-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; and node &#39;&quot;</span> + to-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00639"></a>00639         } <span class="keywordflow">else</span> {
<a name="l00640"></a>00640             <span class="comment">// ... in the other case we report this to the error instance</span>
<a name="l00641"></a>00641             <span class="keywordflow">if</span> (<a class="code" href="../../db/d31/class_options_cont.html#aeb57cb173789bce33943574837e6221c" title="Retrieves the options.">OptionsCont::getOptions</a>().<a class="code" href="../../db/d31/class_options_cont.html#a69874e7145a196b169c3c56eb58d3d57" title="Returns the boolean-value of the named option (only for Option_Bool).">getBool</a>(<span class="stringliteral">&quot;visum.verbose-warnings&quot;</span>)) {
<a name="l00642"></a>00642                 <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(<span class="stringliteral">&quot;There is no edge from node &#39;&quot;</span> + from-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; to node &#39;&quot;</span> + to-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00643"></a>00643             }
<a name="l00644"></a>00644         }
<a name="l00645"></a>00645     }
<a name="l00646"></a>00646 }
<a name="l00647"></a>00647 
<a name="l00648"></a>00648 
<a name="l00649"></a>00649 <span class="keywordtype">void</span>
<a name="l00650"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab210d37a3e2e7b0f17d3559deedbe7b3">00650</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab210d37a3e2e7b0f17d3559deedbe7b3" title="Parses FAHRSTREIFEN.">NIImporter_VISUM::parse_Lanes</a>() {
<a name="l00651"></a>00651     <span class="comment">// get the node</span>
<a name="l00652"></a>00652     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* node = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;KNOTNR&quot;</span>);
<a name="l00653"></a>00653     <span class="comment">// get the edge</span>
<a name="l00654"></a>00654     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* baseEdge = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2a4cdbc621a819ac5fe854f3826a3300" title="Tries to get the edge which name is stored in the given field.">getNamedEdge</a>(<span class="stringliteral">&quot;STRNR&quot;</span>);
<a name="l00655"></a>00655     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* edge = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad19640977681b410a0b7fdec6d0c176d" title="Tries to get the edge which name is stored in the given field continuating the search...">getNamedEdgeContinuating</a>(<span class="stringliteral">&quot;STRNR&quot;</span>, node);
<a name="l00656"></a>00656     <span class="comment">// check</span>
<a name="l00657"></a>00657     <span class="keywordflow">if</span> (node == 0 || edge == 0) {
<a name="l00658"></a>00658         <span class="keywordflow">return</span>;
<a name="l00659"></a>00659     }
<a name="l00660"></a>00660     <span class="comment">// get the lane</span>
<a name="l00661"></a>00661     std::string laneS = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;FSNR&quot;</span>)
<a name="l00662"></a>00662                         ? <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;FSNR&quot;</span>))
<a name="l00663"></a>00663                         : <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;NR&quot;</span>));
<a name="l00664"></a>00664     <span class="keywordtype">int</span> lane = -1;
<a name="l00665"></a>00665     <span class="keywordflow">try</span> {
<a name="l00666"></a>00666         lane = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2int</a>(laneS.c_str());
<a name="l00667"></a>00667     } <span class="keywordflow">catch</span> (<a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>&amp;) {
<a name="l00668"></a>00668         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A lane number for edge &#39;&quot;</span> + edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; is not numeric (&quot;</span> + laneS + <span class="stringliteral">&quot;).&quot;</span>);
<a name="l00669"></a>00669         <span class="keywordflow">return</span>;
<a name="l00670"></a>00670     }
<a name="l00671"></a>00671     lane -= 1;
<a name="l00672"></a>00672     <span class="keywordflow">if</span> (lane &lt; 0) {
<a name="l00673"></a>00673         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A lane number for edge &#39;&quot;</span> + edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; is not positive (&quot;</span> + laneS + <span class="stringliteral">&quot;).&quot;</span>);
<a name="l00674"></a>00674         <span class="keywordflow">return</span>;
<a name="l00675"></a>00675     }
<a name="l00676"></a>00676     <span class="comment">// get the direction</span>
<a name="l00677"></a>00677     std::string dirS = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;RICHTTYP&quot;</span>));
<a name="l00678"></a>00678     <span class="keywordtype">int</span> prevLaneNo = baseEdge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>();
<a name="l00679"></a>00679     <span class="keywordflow">if</span> ((dirS == <span class="stringliteral">&quot;1&quot;</span> &amp;&amp; !(node-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a386dcd34fa654a46a77992b1291fe66f" title="Returns whether the given edge ends at this node.">hasIncoming</a>(edge))) || (dirS == <span class="stringliteral">&quot;0&quot;</span> &amp;&amp; !(node-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a082d27c0dcdc09d2de15a04ccc0489d5" title="Returns whether the given edge starts at this node.">hasOutgoing</a>(edge)))) {
<a name="l00680"></a>00680         <span class="comment">// get the last part of the turnaround direction</span>
<a name="l00681"></a>00681         edge = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a93559a4af58ba846fbc84947c3acfe8d" title="Returns the opposite direction of the given edge.">getReversedContinuating</a>(edge, node);
<a name="l00682"></a>00682     }
<a name="l00683"></a>00683     <span class="comment">// get the length</span>
<a name="l00684"></a>00684     std::string lengthS = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;LAENGE&quot;</span>));
<a name="l00685"></a>00685     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> length = -1;
<a name="l00686"></a>00686     <span class="keywordflow">try</span> {
<a name="l00687"></a>00687         length = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2SUMOReal</a>(lengthS.c_str());
<a name="l00688"></a>00688     } <span class="keywordflow">catch</span> (<a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>&amp;) {
<a name="l00689"></a>00689         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A lane length for edge &#39;&quot;</span> + edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; is not numeric (&quot;</span> + lengthS + <span class="stringliteral">&quot;).&quot;</span>);
<a name="l00690"></a>00690         <span class="keywordflow">return</span>;
<a name="l00691"></a>00691     }
<a name="l00692"></a>00692     <span class="keywordflow">if</span> (length &lt; 0) {
<a name="l00693"></a>00693         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A lane length for edge &#39;&quot;</span> + edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; is not positive (&quot;</span> + lengthS + <span class="stringliteral">&quot;).&quot;</span>);
<a name="l00694"></a>00694         <span class="keywordflow">return</span>;
<a name="l00695"></a>00695     }
<a name="l00696"></a>00696     <span class="comment">//</span>
<a name="l00697"></a>00697     <span class="keywordflow">if</span> (dirS == <span class="stringliteral">&quot;1&quot;</span>) {
<a name="l00698"></a>00698         lane -= prevLaneNo;
<a name="l00699"></a>00699     }
<a name="l00700"></a>00700     <span class="comment">//</span>
<a name="l00701"></a>00701     <span class="keywordflow">if</span> (length == 0) {
<a name="l00702"></a>00702         <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>) edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>() &gt; lane) {
<a name="l00703"></a>00703             <span class="comment">// ok, we know this already...</span>
<a name="l00704"></a>00704             <span class="keywordflow">return</span>;
<a name="l00705"></a>00705         }
<a name="l00706"></a>00706         <span class="comment">// increment by one</span>
<a name="l00707"></a>00707         edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a7c22fd4ddb2569ae2a3d09c8e6d06d4d">incLaneNo</a>(1);
<a name="l00708"></a>00708     } <span class="keywordflow">else</span> {
<a name="l00709"></a>00709         <span class="comment">// check whether this edge already has been created</span>
<a name="l00710"></a>00710         <span class="keywordflow">if</span> (edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().length() - node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().length() - 1) == <span class="stringliteral">&quot;_&quot;</span> + node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()) {
<a name="l00711"></a>00711             <span class="keywordflow">if</span> (edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().find(<span class="charliteral">&#39;_&#39;</span>)) == <span class="stringliteral">&quot;_&quot;</span> + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(length) + <span class="stringliteral">&quot;_&quot;</span> + node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()) {
<a name="l00712"></a>00712                 <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>) edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>() &gt; lane) {
<a name="l00713"></a>00713                     <span class="comment">// ok, we know this already...</span>
<a name="l00714"></a>00714                     <span class="keywordflow">return</span>;
<a name="l00715"></a>00715                 }
<a name="l00716"></a>00716                 <span class="comment">// increment by one</span>
<a name="l00717"></a>00717                 edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a7c22fd4ddb2569ae2a3d09c8e6d06d4d">incLaneNo</a>(1);
<a name="l00718"></a>00718                 <span class="keywordflow">return</span>;
<a name="l00719"></a>00719             }
<a name="l00720"></a>00720         }
<a name="l00721"></a>00721         <span class="comment">// nope, we have to split the edge...</span>
<a name="l00722"></a>00722         <span class="comment">//  maybe it is not the proper edge to split - VISUM seems not to sort the splits...</span>
<a name="l00723"></a>00723         <span class="keywordtype">bool</span> mustRecheck = <span class="keyword">true</span>;
<a name="l00724"></a>00724         <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* nextNode = node;
<a name="l00725"></a>00725         <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> seenLength = 0;
<a name="l00726"></a>00726         <span class="keywordflow">while</span> (mustRecheck) {
<a name="l00727"></a>00727             <span class="keywordflow">if</span> (edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().length() - node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().length() - 1) == <span class="stringliteral">&quot;_&quot;</span> + node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()) {
<a name="l00728"></a>00728                 <span class="comment">// ok, we have a previously created edge here</span>
<a name="l00729"></a>00729                 std::string sub = edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>();
<a name="l00730"></a>00730                 sub = sub.substr(sub.rfind(<span class="charliteral">&#39;_&#39;</span>, sub.rfind(<span class="charliteral">&#39;_&#39;</span>) - 1));
<a name="l00731"></a>00731                 sub = sub.substr(1, sub.find(<span class="charliteral">&#39;_&#39;</span>, 1) - 1);
<a name="l00732"></a>00732                 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> dist = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2SUMOReal</a>(sub.c_str());
<a name="l00733"></a>00733                 <span class="keywordflow">if</span> (dist &lt; length) {
<a name="l00734"></a>00734                     seenLength += edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a9b24b03885ce7c221058f13b0b69ec24" title="Returns the computed length of the edge.">getLength</a>();
<a name="l00735"></a>00735                     <span class="keywordflow">if</span> (dirS == <span class="stringliteral">&quot;1&quot;</span>) {
<a name="l00736"></a>00736                         <span class="comment">// incoming -&gt; move back</span>
<a name="l00737"></a>00737                         edge = edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#ab279b96c38a10b1aafba2b8f736b0410" title="Returns the origin node of the edge.">getFromNode</a>()-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a8528083710540004a765fc56643c9562" title="Returns this node&amp;#39;s incoming edges.">getIncomingEdges</a>()[0];
<a name="l00738"></a>00738                         nextNode = edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a47de8fb27ded13ba7886218da6b9a60f" title="Returns the destination node of the edge.">getToNode</a>();
<a name="l00739"></a>00739                         nextNode = edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#ab279b96c38a10b1aafba2b8f736b0410" title="Returns the origin node of the edge.">getFromNode</a>();
<a name="l00740"></a>00740                     } <span class="keywordflow">else</span> {
<a name="l00741"></a>00741                         <span class="comment">// outgoing -&gt; move forward</span>
<a name="l00742"></a>00742                         edge = edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a47de8fb27ded13ba7886218da6b9a60f" title="Returns the destination node of the edge.">getToNode</a>()-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a7e586b529f4d8c758716a8c72220ca38" title="Returns this node&amp;#39;s outgoing edges.">getOutgoingEdges</a>()[0];
<a name="l00743"></a>00743                         nextNode = edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#ab279b96c38a10b1aafba2b8f736b0410" title="Returns the origin node of the edge.">getFromNode</a>();
<a name="l00744"></a>00744                         nextNode = edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a47de8fb27ded13ba7886218da6b9a60f" title="Returns the destination node of the edge.">getToNode</a>();
<a name="l00745"></a>00745                     }
<a name="l00746"></a>00746                 } <span class="keywordflow">else</span> {
<a name="l00747"></a>00747                     mustRecheck = <span class="keyword">false</span>;
<a name="l00748"></a>00748                 }
<a name="l00749"></a>00749             } <span class="keywordflow">else</span> {
<a name="l00750"></a>00750                 <span class="comment">// we have the center edge - do not continue...</span>
<a name="l00751"></a>00751                 mustRecheck = <span class="keyword">false</span>;
<a name="l00752"></a>00752             }
<a name="l00753"></a>00753         }
<a name="l00754"></a>00754         <span class="comment">// compute position</span>
<a name="l00755"></a>00755         <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a> p;
<a name="l00756"></a>00756         <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> useLength = length - seenLength;
<a name="l00757"></a>00757         useLength = edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a9b24b03885ce7c221058f13b0b69ec24" title="Returns the computed length of the edge.">getLength</a>() - useLength;
<a name="l00758"></a>00758         std::string edgeID = edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>();
<a name="l00759"></a>00759         p = edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a7ef2d0f629e4daa3310bc6bf1abe6ce9" title="Returns the geometry of the edge.">getGeometry</a>().<a class="code" href="../../da/d56/class_position_vector.html#a716318d3b0fe4298f5384d8d38688b6c" title="Returns the position at the given length.">positionAtLengthPosition</a>(useLength);
<a name="l00760"></a>00760         <span class="keywordflow">if</span> (edgeID.substr(edgeID.length() - node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().length() - 1) == <span class="stringliteral">&quot;_&quot;</span> + node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()) {
<a name="l00761"></a>00761             edgeID = edgeID.substr(0, edgeID.find(<span class="charliteral">&#39;_&#39;</span>));
<a name="l00762"></a>00762         }
<a name="l00763"></a>00763         <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* rn = <span class="keyword">new</span> <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>(edgeID + <span class="stringliteral">&quot;_&quot;</span> +  <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>((<span class="keywordtype">size_t</span>) length) + <span class="stringliteral">&quot;_&quot;</span> + node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>(), p);
<a name="l00764"></a>00764         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>().<a class="code" href="../../db/d8c/class_n_b_node_cont.html#ab70c3a2678e411a0b1e3edd41d2dd177" title="Inserts a node into the map.">insert</a>(rn)) {
<a name="l00765"></a>00765             <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Ups - could not insert node!&quot;</span>);
<a name="l00766"></a>00766         }
<a name="l00767"></a>00767         std::string nid = edgeID + <span class="stringliteral">&quot;_&quot;</span> +  <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>((<span class="keywordtype">size_t</span>) length) + <span class="stringliteral">&quot;_&quot;</span> + node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>();
<a name="l00768"></a>00768         <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#af0ee0a24afadface83a044b1d521c503" title="Splits the edge at the position nearest to the given node.">splitAt</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#a2edf6eadc99eaa3ec8c191a31b916693" title="Returns the districts container.">getDistrictCont</a>(), edge, useLength, rn,
<a name="l00769"></a>00769                                            edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>(), nid, edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>() + 0, edge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>() + 1);
<a name="l00770"></a>00770         <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* nedge = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(nid);
<a name="l00771"></a>00771         nedge = nedge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a47de8fb27ded13ba7886218da6b9a60f" title="Returns the destination node of the edge.">getToNode</a>()-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a7e586b529f4d8c758716a8c72220ca38" title="Returns this node&amp;#39;s outgoing edges.">getOutgoingEdges</a>()[0];
<a name="l00772"></a>00772         <span class="keywordflow">while</span> (nedge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(nedge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().length() - node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().length() - 1) == <span class="stringliteral">&quot;_&quot;</span> + node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()) {
<a name="l00773"></a>00773             assert(nedge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a47de8fb27ded13ba7886218da6b9a60f" title="Returns the destination node of the edge.">getToNode</a>()-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a7e586b529f4d8c758716a8c72220ca38" title="Returns this node&amp;#39;s outgoing edges.">getOutgoingEdges</a>().size() &gt; 0);
<a name="l00774"></a>00774             nedge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a7c22fd4ddb2569ae2a3d09c8e6d06d4d">incLaneNo</a>(1);
<a name="l00775"></a>00775             nedge = nedge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a47de8fb27ded13ba7886218da6b9a60f" title="Returns the destination node of the edge.">getToNode</a>()-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a7e586b529f4d8c758716a8c72220ca38" title="Returns this node&amp;#39;s outgoing edges.">getOutgoingEdges</a>()[0];
<a name="l00776"></a>00776         }
<a name="l00777"></a>00777     }
<a name="l00778"></a>00778 }
<a name="l00779"></a>00779 
<a name="l00780"></a>00780 
<a name="l00781"></a>00781 <span class="keywordtype">void</span>
<a name="l00782"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a4ea68aa7b098be9ebde8327be2946643">00782</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a4ea68aa7b098be9ebde8327be2946643" title="Parses LSA/SIGNALANLAGE.">NIImporter_VISUM::parse_TrafficLights</a>() {
<a name="l00783"></a>00783     <span class="comment">// get the id</span>
<a name="l00784"></a>00784     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Nr&quot;</span>));
<a name="l00785"></a>00785     <span class="comment">// cycle time</span>
<a name="l00786"></a>00786     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> CycleTime = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;Umlaufzeit&quot;</span>, <span class="stringliteral">&quot;UMLZEIT&quot;</span>);
<a name="l00787"></a>00787     <span class="comment">// IntermediateTime</span>
<a name="l00788"></a>00788     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> IntermediateTime = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;StdZwischenzeit&quot;</span>, <span class="stringliteral">&quot;STDZWZEIT&quot;</span>);
<a name="l00789"></a>00789     <span class="comment">// PhaseBased</span>
<a name="l00790"></a>00790     <span class="keywordtype">bool</span> PhaseBased = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;PhasenBasiert&quot;</span>)
<a name="l00791"></a>00791                       ? <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2bool</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;PhasenBasiert&quot;</span>).c_str())
<a name="l00792"></a>00792                       : <span class="keyword">false</span>;
<a name="l00793"></a>00793     <span class="comment">// add to the list</span>
<a name="l00794"></a>00794     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a87292643d2dedb50ce8f5576228be62b">myNIVisumTLs</a>[<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>] = <span class="keyword">new</span> <a class="code" href="../../d6/d18/class_n_i_visum_t_l.html" title="Intermediate class for storing visum traffic lights during their import.">NIVisumTL</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>, (<a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a>) CycleTime, (<a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a>) IntermediateTime, PhaseBased);
<a name="l00795"></a>00795 }
<a name="l00796"></a>00796 
<a name="l00797"></a>00797 
<a name="l00798"></a>00798 <span class="keywordtype">void</span>
<a name="l00799"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a408a99bf0a4c0059e8bd91970cc6d276">00799</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a408a99bf0a4c0059e8bd91970cc6d276" title="Parses KNOTENZULSA/SIGNALANLAGEZUKNOTEN.">NIImporter_VISUM::parse_NodesToTrafficLights</a>() {
<a name="l00800"></a>00800     std::string Node = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;KnotNr&quot;</span>).c_str();
<a name="l00801"></a>00801     std::string TrafficLight = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;LsaNr&quot;</span>).c_str();
<a name="l00802"></a>00802     <span class="comment">// add to the list</span>
<a name="l00803"></a>00803     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a87292643d2dedb50ce8f5576228be62b">myNIVisumTLs</a>[TrafficLight]-&gt;GetNodes()-&gt;push_back(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>().<a class="code" href="../../db/d8c/class_n_b_node_cont.html#a0e2ce1b9413a0c11728ac63344c62039" title="Returns the node with the given name.">retrieve</a>(Node));
<a name="l00804"></a>00804 }
<a name="l00805"></a>00805 
<a name="l00806"></a>00806 
<a name="l00807"></a>00807 <span class="keywordtype">void</span>
<a name="l00808"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa26c705e979fa69dce449e989f6fe274">00808</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa26c705e979fa69dce449e989f6fe274" title="Parses LSASIGNALGRUPPE/SIGNALGRUPPE.">NIImporter_VISUM::parse_SignalGroups</a>() {
<a name="l00809"></a>00809     <span class="comment">// get the id</span>
<a name="l00810"></a>00810     <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Nr&quot;</span>));
<a name="l00811"></a>00811     std::string LSAid = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;LsaNr&quot;</span>));
<a name="l00812"></a>00812     <span class="comment">// StartTime</span>
<a name="l00813"></a>00813     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> StartTime = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;GzStart&quot;</span>, <span class="stringliteral">&quot;GRUENANF&quot;</span>);
<a name="l00814"></a>00814     <span class="comment">// EndTime</span>
<a name="l00815"></a>00815     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> EndTime = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;GzEnd&quot;</span>, <span class="stringliteral">&quot;GRUENENDE&quot;</span>);
<a name="l00816"></a>00816     <span class="comment">// add to the list</span>
<a name="l00817"></a>00817     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a87292643d2dedb50ce8f5576228be62b">myNIVisumTLs</a>.find(LSAid) == <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a87292643d2dedb50ce8f5576228be62b">myNIVisumTLs</a>.end()) {
<a name="l00818"></a>00818         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Could not find TLS &#39;&quot;</span> + LSAid + <span class="stringliteral">&quot;&#39; for setting the signal group.&quot;</span>);
<a name="l00819"></a>00819         <span class="keywordflow">return</span>;
<a name="l00820"></a>00820     }
<a name="l00821"></a>00821     (*<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a87292643d2dedb50ce8f5576228be62b">myNIVisumTLs</a>.find(LSAid)).second-&gt;AddSignalGroup(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a>, (<a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a>) StartTime, (<a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a>) EndTime);
<a name="l00822"></a>00822 }
<a name="l00823"></a>00823 
<a name="l00824"></a>00824 
<a name="l00825"></a>00825 <span class="keywordtype">void</span>
<a name="l00826"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#acfc43257ac2818a63678ab50d763f669">00826</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#acfc43257ac2818a63678ab50d763f669" title="Parses ABBZULSASIGNALGRUPPE/SIGNALGRUPPEZUABBIEGER.">NIImporter_VISUM::parse_TurnsToSignalGroups</a>() {
<a name="l00827"></a>00827     <span class="comment">// get the id</span>
<a name="l00828"></a>00828     std::string SGid = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad62f01581f1a2eb16160c719044ecacf" title="Returns the value from the named column as a normalised string.">getNamedString</a>(<span class="stringliteral">&quot;SGNR&quot;</span>, <span class="stringliteral">&quot;SIGNALGRUPPENNR&quot;</span>);
<a name="l00829"></a>00829     std::string LSAid = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad62f01581f1a2eb16160c719044ecacf" title="Returns the value from the named column as a normalised string.">getNamedString</a>(<span class="stringliteral">&quot;LsaNr&quot;</span>);
<a name="l00830"></a>00830     <span class="comment">// nodes</span>
<a name="l00831"></a>00831     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* from = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;VonKnot&quot;</span>) ? <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;VonKnot&quot;</span>) : 0;
<a name="l00832"></a>00832     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* via = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;KNOTNR&quot;</span>)
<a name="l00833"></a>00833                   ? <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;KNOTNR&quot;</span>)
<a name="l00834"></a>00834                   : <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;UeberKnot&quot;</span>, <span class="stringliteral">&quot;UeberKnotNr&quot;</span>);
<a name="l00835"></a>00835     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* to = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(<span class="stringliteral">&quot;NachKnot&quot;</span>) ? <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;NachKnot&quot;</span>) : 0;
<a name="l00836"></a>00836     <span class="comment">// edges</span>
<a name="l00837"></a>00837     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* edg1 = 0;
<a name="l00838"></a>00838     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* edg2 = 0;
<a name="l00839"></a>00839     <span class="keywordflow">if</span> (from == 0 &amp;&amp; to == 0) {
<a name="l00840"></a>00840         edg1 = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad19640977681b410a0b7fdec6d0c176d" title="Tries to get the edge which name is stored in the given field continuating the search...">getNamedEdgeContinuating</a>(<span class="stringliteral">&quot;VONSTRNR&quot;</span>, via);
<a name="l00841"></a>00841         edg2 = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad19640977681b410a0b7fdec6d0c176d" title="Tries to get the edge which name is stored in the given field continuating the search...">getNamedEdgeContinuating</a>(<span class="stringliteral">&quot;NACHSTRNR&quot;</span>, via);
<a name="l00842"></a>00842     } <span class="keywordflow">else</span> {
<a name="l00843"></a>00843         edg1 = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab28559118d25490d8c719e4f9d939123" title="Returns the edge that connects both nodes.">getEdge</a>(from, via);
<a name="l00844"></a>00844         edg2 = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab28559118d25490d8c719e4f9d939123" title="Returns the edge that connects both nodes.">getEdge</a>(via, to);
<a name="l00845"></a>00845     }
<a name="l00846"></a>00846     <span class="comment">// add to the list</span>
<a name="l00847"></a>00847     <a class="code" href="../../dd/dde/class_n_i_visum_t_l_1_1_signal_group.html">NIVisumTL::SignalGroup</a>* SG;
<a name="l00848"></a>00848     SG = (*<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a87292643d2dedb50ce8f5576228be62b">myNIVisumTLs</a>.find(LSAid)).second-&gt;GetSignalGroup(SGid);
<a name="l00849"></a>00849     <span class="keywordflow">if</span> (edg1 != 0 &amp;&amp; edg2 != 0) {
<a name="l00850"></a>00850         <span class="keywordflow">if</span> (!via-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a386dcd34fa654a46a77992b1291fe66f" title="Returns whether the given edge ends at this node.">hasIncoming</a>(edg1)) {
<a name="l00851"></a>00851             std::string sid;
<a name="l00852"></a>00852             <span class="keywordflow">if</span> (edg1-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] == <span class="charliteral">&#39;-&#39;</span>) {
<a name="l00853"></a>00853                 sid = edg1-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(1);
<a name="l00854"></a>00854             } <span class="keywordflow">else</span> {
<a name="l00855"></a>00855                 sid = <span class="stringliteral">&quot;-&quot;</span> + edg1-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>();
<a name="l00856"></a>00856             }
<a name="l00857"></a>00857             <span class="keywordflow">if</span> (sid.find(<span class="charliteral">&#39;_&#39;</span>) != std::string::npos) {
<a name="l00858"></a>00858                 sid = sid.substr(0, sid.find(<span class="charliteral">&#39;_&#39;</span>));
<a name="l00859"></a>00859             }
<a name="l00860"></a>00860             edg1 = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad19640977681b410a0b7fdec6d0c176d" title="Tries to get the edge which name is stored in the given field continuating the search...">getNamedEdgeContinuating</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(sid),  via);
<a name="l00861"></a>00861         }
<a name="l00862"></a>00862         <span class="keywordflow">if</span> (!via-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a082d27c0dcdc09d2de15a04ccc0489d5" title="Returns whether the given edge starts at this node.">hasOutgoing</a>(edg2)) {
<a name="l00863"></a>00863             std::string sid;
<a name="l00864"></a>00864             <span class="keywordflow">if</span> (edg2-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] == <span class="charliteral">&#39;-&#39;</span>) {
<a name="l00865"></a>00865                 sid = edg2-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(1);
<a name="l00866"></a>00866             } <span class="keywordflow">else</span> {
<a name="l00867"></a>00867                 sid = <span class="stringliteral">&quot;-&quot;</span> + edg2-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>();
<a name="l00868"></a>00868             }
<a name="l00869"></a>00869             <span class="keywordflow">if</span> (sid.find(<span class="charliteral">&#39;_&#39;</span>) != std::string::npos) {
<a name="l00870"></a>00870                 sid = sid.substr(0, sid.find(<span class="charliteral">&#39;_&#39;</span>));
<a name="l00871"></a>00871             }
<a name="l00872"></a>00872             edg2 = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad19640977681b410a0b7fdec6d0c176d" title="Tries to get the edge which name is stored in the given field continuating the search...">getNamedEdgeContinuating</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(sid),  via);
<a name="l00873"></a>00873         }
<a name="l00874"></a>00874         SG-&gt;<a class="code" href="../../dd/dde/class_n_i_visum_t_l_1_1_signal_group.html#a9ebc87313403749fd1ea0f708ed23f0a">GetConnections</a>()-&gt;push_back(<a class="code" href="../../dc/d41/class_n_b_connection.html">NBConnection</a>(edg1, edg2));
<a name="l00875"></a>00875     }
<a name="l00876"></a>00876 }
<a name="l00877"></a>00877 
<a name="l00878"></a>00878 
<a name="l00879"></a>00879 <span class="keywordtype">void</span>
<a name="l00880"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ae6ffc370161ff2882fda0441a69ad7a8">00880</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ae6ffc370161ff2882fda0441a69ad7a8" title="Parses ABBZULSASIGNALGRUPPE/SIGNALGRUPPEZUABBIEGER.">NIImporter_VISUM::parse_AreaSubPartElement</a>() {
<a name="l00881"></a>00881     <span class="keywordtype">long</span> <span class="keywordtype">id</span> = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2long</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;TFLAECHEID&quot;</span>).c_str());
<a name="l00882"></a>00882     <span class="keywordtype">long</span> edgeid = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2long</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;KANTEID&quot;</span>).c_str());
<a name="l00883"></a>00883     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9c1e1e2ce7d3aef2aa25ed531abd22fe" title="A map of edge (not road, but &amp;quot;edge&amp;quot; in this case) ids to from/to-points...">myEdges</a>.find(edgeid) == <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9c1e1e2ce7d3aef2aa25ed531abd22fe" title="A map of edge (not road, but &amp;quot;edge&amp;quot; in this case) ids to from/to-points...">myEdges</a>.end()) {
<a name="l00884"></a>00884         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Unknown edge in TEILFLAECHENELEMENT&quot;</span>);
<a name="l00885"></a>00885         <span class="keywordflow">return</span>;
<a name="l00886"></a>00886     }
<a name="l00887"></a>00887     std::string dir = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;RICHTUNG&quot;</span>);
<a name="l00888"></a>00888     std::string indexS = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;INDEX&quot;</span>));
<a name="l00889"></a>00889     <span class="keywordtype">int</span> index = -1;
<a name="l00890"></a>00890     <span class="keywordflow">try</span> {
<a name="l00891"></a>00891         index = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2int</a>(indexS.c_str()) - 1;
<a name="l00892"></a>00892     } <span class="keywordflow">catch</span> (<a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>&amp;) {
<a name="l00893"></a>00893         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;An index for a TEILFLAECHENELEMENT is not numeric (id=&#39;&quot;</span> + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(<span class="keywordtype">id</span>) + <span class="stringliteral">&quot;&#39;).&quot;</span>);
<a name="l00894"></a>00894         <span class="keywordflow">return</span>;
<a name="l00895"></a>00895     }
<a name="l00896"></a>00896     <a class="code" href="../../da/d56/class_position_vector.html" title="A list of 2D-positions.">PositionVector</a> shape;
<a name="l00897"></a>00897     shape.<a class="code" href="../../da/d56/class_position_vector.html#a99a6f657973c8a916ffa8ebca2b33d80" title="Appends the given position to the list.">push_back</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6ebaeb02ded377728c70e2b3f45e356f" title="A map of point ids to positions.">myPoints</a>[<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9c1e1e2ce7d3aef2aa25ed531abd22fe" title="A map of edge (not road, but &amp;quot;edge&amp;quot; in this case) ids to from/to-points...">myEdges</a>[edgeid].first]);
<a name="l00898"></a>00898     shape.<a class="code" href="../../da/d56/class_position_vector.html#a99a6f657973c8a916ffa8ebca2b33d80" title="Appends the given position to the list.">push_back</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6ebaeb02ded377728c70e2b3f45e356f" title="A map of point ids to positions.">myPoints</a>[<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9c1e1e2ce7d3aef2aa25ed531abd22fe" title="A map of edge (not road, but &amp;quot;edge&amp;quot; in this case) ids to from/to-points...">myEdges</a>[edgeid].second]);
<a name="l00899"></a>00899     <span class="keywordflow">if</span> (dir.length() &gt; 0 &amp;&amp; dir[0] == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l00900"></a>00900         shape = shape.<a class="code" href="../../da/d56/class_position_vector.html#a0dec24e1521994cbf1d60195f87dc09d">reverse</a>();
<a name="l00901"></a>00901     }
<a name="l00902"></a>00902     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aca27f3e10b7896cd1dd48ea8a226fd0a" title="A map from area parts to area ids.">mySubPartsAreas</a>.find(<span class="keywordtype">id</span>) == <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aca27f3e10b7896cd1dd48ea8a226fd0a" title="A map from area parts to area ids.">mySubPartsAreas</a>.end()) {
<a name="l00903"></a>00903         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Unkown are for area part &#39;&quot;</span> + <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a62f108070254a6e776458658dd4b0112" title="The name of the currently parsed item used for error reporting.">myCurrentID</a> + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00904"></a>00904         <span class="keywordflow">return</span>;
<a name="l00905"></a>00905     }
<a name="l00906"></a>00906 
<a name="l00907"></a>00907     <span class="keyword">const</span> std::vector&lt;long&gt; &amp;areas = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aca27f3e10b7896cd1dd48ea8a226fd0a" title="A map from area parts to area ids.">mySubPartsAreas</a>.find(<span class="keywordtype">id</span>)-&gt;second;
<a name="l00908"></a>00908     <span class="keywordflow">for</span> (std::vector&lt;long&gt;::const_iterator i = areas.begin(); i != areas.end(); ++i) {
<a name="l00909"></a>00909         <a class="code" href="../../d7/d91/class_n_b_district.html" title="A class representing a single district.">NBDistrict</a>* d = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#acb917ef66fb37c36cb5e32bbb1db4225" title="A map from district shape definition name to the district.">myShapeDistrictMap</a>[*i];
<a name="l00910"></a>00910         <span class="keywordflow">if</span> (d == 0) {
<a name="l00911"></a>00911             <span class="keywordflow">continue</span>;
<a name="l00912"></a>00912         }
<a name="l00913"></a>00913         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6dad564b50e8302138c1c76fab250b49" title="A temporary storage for district shapes as they are filled incrementally.">myDistrictShapes</a>.find(d) == <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6dad564b50e8302138c1c76fab250b49" title="A temporary storage for district shapes as they are filled incrementally.">myDistrictShapes</a>.end()) {
<a name="l00914"></a>00914             <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6dad564b50e8302138c1c76fab250b49" title="A temporary storage for district shapes as they are filled incrementally.">myDistrictShapes</a>[d] = <a class="code" href="../../da/d56/class_position_vector.html" title="A list of 2D-positions.">PositionVector</a>();
<a name="l00915"></a>00915         }
<a name="l00916"></a>00916         <span class="keywordflow">if</span> (dir.length() &gt; 0 &amp;&amp; dir[0] == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l00917"></a>00917             <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6dad564b50e8302138c1c76fab250b49" title="A temporary storage for district shapes as they are filled incrementally.">myDistrictShapes</a>[d].push_back(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6ebaeb02ded377728c70e2b3f45e356f" title="A map of point ids to positions.">myPoints</a>[<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9c1e1e2ce7d3aef2aa25ed531abd22fe" title="A map of edge (not road, but &amp;quot;edge&amp;quot; in this case) ids to from/to-points...">myEdges</a>[edgeid].second]);
<a name="l00918"></a>00918             <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6dad564b50e8302138c1c76fab250b49" title="A temporary storage for district shapes as they are filled incrementally.">myDistrictShapes</a>[d].push_back(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6ebaeb02ded377728c70e2b3f45e356f" title="A map of point ids to positions.">myPoints</a>[<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9c1e1e2ce7d3aef2aa25ed531abd22fe" title="A map of edge (not road, but &amp;quot;edge&amp;quot; in this case) ids to from/to-points...">myEdges</a>[edgeid].first]);
<a name="l00919"></a>00919         } <span class="keywordflow">else</span> {
<a name="l00920"></a>00920             <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6dad564b50e8302138c1c76fab250b49" title="A temporary storage for district shapes as they are filled incrementally.">myDistrictShapes</a>[d].push_back(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6ebaeb02ded377728c70e2b3f45e356f" title="A map of point ids to positions.">myPoints</a>[<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9c1e1e2ce7d3aef2aa25ed531abd22fe" title="A map of edge (not road, but &amp;quot;edge&amp;quot; in this case) ids to from/to-points...">myEdges</a>[edgeid].first]);
<a name="l00921"></a>00921             <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6dad564b50e8302138c1c76fab250b49" title="A temporary storage for district shapes as they are filled incrementally.">myDistrictShapes</a>[d].push_back(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6ebaeb02ded377728c70e2b3f45e356f" title="A map of point ids to positions.">myPoints</a>[<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9c1e1e2ce7d3aef2aa25ed531abd22fe" title="A map of edge (not road, but &amp;quot;edge&amp;quot; in this case) ids to from/to-points...">myEdges</a>[edgeid].second]);
<a name="l00922"></a>00922         }
<a name="l00923"></a>00923     }
<a name="l00924"></a>00924 }
<a name="l00925"></a>00925 
<a name="l00926"></a>00926 
<a name="l00927"></a>00927 <span class="keywordtype">void</span>
<a name="l00928"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0858bdde842277c43e0df4717f1b93ea">00928</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0858bdde842277c43e0df4717f1b93ea" title="Parses LSAPHASE/PHASE.">NIImporter_VISUM::parse_Phases</a>() {
<a name="l00929"></a>00929     <span class="comment">// get the id</span>
<a name="l00930"></a>00930     std::string Phaseid = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;Nr&quot;</span>));
<a name="l00931"></a>00931     std::string LSAid = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;LsaNr&quot;</span>));
<a name="l00932"></a>00932     <span class="comment">// StartTime</span>
<a name="l00933"></a>00933     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> StartTime = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;GzStart&quot;</span>, <span class="stringliteral">&quot;GRUENANF&quot;</span>);
<a name="l00934"></a>00934     <span class="comment">// EndTime</span>
<a name="l00935"></a>00935     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> EndTime = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(<span class="stringliteral">&quot;GzEnd&quot;</span>, <span class="stringliteral">&quot;GRUENENDE&quot;</span>);
<a name="l00936"></a>00936     <span class="comment">// add to the list</span>
<a name="l00937"></a>00937     (*<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a87292643d2dedb50ce8f5576228be62b">myNIVisumTLs</a>.find(LSAid)).second-&gt;AddPhase(Phaseid, (<a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a>) StartTime, (<a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a>) EndTime);
<a name="l00938"></a>00938 }
<a name="l00939"></a>00939 
<a name="l00940"></a>00940 
<a name="l00941"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9a5c72b7a44781a9915655cf3e2699bb">00941</a> <span class="keywordtype">void</span> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9a5c72b7a44781a9915655cf3e2699bb" title="Parses LSASIGNALGRUPPEZULSAPHASE.">NIImporter_VISUM::parse_SignalGroupsToPhases</a>() {
<a name="l00942"></a>00942     <span class="comment">// get the id</span>
<a name="l00943"></a>00943     std::string Phaseid = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;PsNr&quot;</span>));
<a name="l00944"></a>00944     std::string LSAid = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;LsaNr&quot;</span>));
<a name="l00945"></a>00945     std::string SGid = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;SGNR&quot;</span>));
<a name="l00946"></a>00946     <span class="comment">// insert</span>
<a name="l00947"></a>00947     <a class="code" href="../../d4/d3c/class_n_i_visum_t_l_1_1_phase.html">NIVisumTL::Phase</a>* PH;
<a name="l00948"></a>00948     <a class="code" href="../../dd/dde/class_n_i_visum_t_l_1_1_signal_group.html">NIVisumTL::SignalGroup</a>* SG;
<a name="l00949"></a>00949     <a class="code" href="../../d6/d18/class_n_i_visum_t_l.html" title="Intermediate class for storing visum traffic lights during their import.">NIVisumTL</a>* LSA;
<a name="l00950"></a>00950     LSA = (*<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a87292643d2dedb50ce8f5576228be62b">myNIVisumTLs</a>.find(LSAid)).second;
<a name="l00951"></a>00951     SG = LSA-&gt;<a class="code" href="../../d6/d18/class_n_i_visum_t_l.html#a6394b08f193fb2eadd3213e657f58cd5">GetSignalGroup</a>(SGid);
<a name="l00952"></a>00952     PH = (*LSA-&gt;<a class="code" href="../../d6/d18/class_n_i_visum_t_l.html#a8bcdc80d8c7c5fde99b2c020dd114193">GetPhases</a>()-&gt;find(Phaseid)).second;
<a name="l00953"></a>00953     (*SG-&gt;<a class="code" href="../../dd/dde/class_n_i_visum_t_l_1_1_signal_group.html#abee0c37ac2a62235c0a6b1afc3e941fa">GetPhases</a>())[Phaseid] = PH;
<a name="l00954"></a>00954 }
<a name="l00955"></a>00955 
<a name="l00956"></a>00956 
<a name="l00957"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad672e4cf8d9234d1b584c20a7c06bda3">00957</a> <span class="keywordtype">void</span> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad672e4cf8d9234d1b584c20a7c06bda3" title="Parses FAHRSTREIFENABBIEGER.">NIImporter_VISUM::parse_LanesConnections</a>() {
<a name="l00958"></a>00958     <span class="comment">// get the node</span>
<a name="l00959"></a>00959     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* node = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">getNamedNode</a>(<span class="stringliteral">&quot;KNOTNR&quot;</span>, <span class="stringliteral">&quot;KNOT&quot;</span>);
<a name="l00960"></a>00960     <span class="keywordflow">if</span> (node == 0) {
<a name="l00961"></a>00961         <span class="keywordflow">return</span>;
<a name="l00962"></a>00962     }
<a name="l00963"></a>00963     <span class="comment">// get the from-edge</span>
<a name="l00964"></a>00964     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* fromEdge = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad19640977681b410a0b7fdec6d0c176d" title="Tries to get the edge which name is stored in the given field continuating the search...">getNamedEdgeContinuating</a>(<span class="stringliteral">&quot;VONSTRNR&quot;</span>, <span class="stringliteral">&quot;VONSTR&quot;</span>, node);
<a name="l00965"></a>00965     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* toEdge = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad19640977681b410a0b7fdec6d0c176d" title="Tries to get the edge which name is stored in the given field continuating the search...">getNamedEdgeContinuating</a>(<span class="stringliteral">&quot;NACHSTRNR&quot;</span>, <span class="stringliteral">&quot;NACHSTR&quot;</span>, node);
<a name="l00966"></a>00966     <span class="keywordflow">if</span> (fromEdge == 0 || toEdge == 0) {
<a name="l00967"></a>00967         <span class="keywordflow">return</span>;
<a name="l00968"></a>00968     }
<a name="l00969"></a>00969 
<a name="l00970"></a>00970     <span class="keywordtype">int</span> fromLaneOffset = 0;
<a name="l00971"></a>00971     <span class="keywordflow">if</span> (!node-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a386dcd34fa654a46a77992b1291fe66f" title="Returns whether the given edge ends at this node.">hasIncoming</a>(fromEdge)) {
<a name="l00972"></a>00972         fromLaneOffset = fromEdge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>();
<a name="l00973"></a>00973         fromEdge = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a93559a4af58ba846fbc84947c3acfe8d" title="Returns the opposite direction of the given edge.">getReversedContinuating</a>(fromEdge, node);
<a name="l00974"></a>00974     } <span class="keywordflow">else</span> {
<a name="l00975"></a>00975         fromEdge = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a93559a4af58ba846fbc84947c3acfe8d" title="Returns the opposite direction of the given edge.">getReversedContinuating</a>(fromEdge, node);
<a name="l00976"></a>00976         <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* tmp = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(fromEdge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(0, fromEdge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().find(<span class="charliteral">&#39;_&#39;</span>)));
<a name="l00977"></a>00977         fromLaneOffset = tmp-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>();
<a name="l00978"></a>00978     }
<a name="l00979"></a>00979 
<a name="l00980"></a>00980     <span class="keywordtype">int</span> toLaneOffset = 0;
<a name="l00981"></a>00981     <span class="keywordflow">if</span> (!node-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a082d27c0dcdc09d2de15a04ccc0489d5" title="Returns whether the given edge starts at this node.">hasOutgoing</a>(toEdge)) {
<a name="l00982"></a>00982         toLaneOffset = toEdge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>();
<a name="l00983"></a>00983         toEdge = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a93559a4af58ba846fbc84947c3acfe8d" title="Returns the opposite direction of the given edge.">getReversedContinuating</a>(toEdge, node);
<a name="l00984"></a>00984     } <span class="keywordflow">else</span> {
<a name="l00985"></a>00985         <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* tmp = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(toEdge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(0, toEdge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().find(<span class="charliteral">&#39;_&#39;</span>)));
<a name="l00986"></a>00986         toLaneOffset = tmp-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>();
<a name="l00987"></a>00987     }
<a name="l00988"></a>00988     <span class="comment">// get the from-lane</span>
<a name="l00989"></a>00989     std::string fromLaneS = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;VONFSNR&quot;</span>));
<a name="l00990"></a>00990     <span class="keywordtype">int</span> fromLane = -1;
<a name="l00991"></a>00991     <span class="keywordflow">try</span> {
<a name="l00992"></a>00992         fromLane = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2int</a>(fromLaneS.c_str());
<a name="l00993"></a>00993     } <span class="keywordflow">catch</span> (<a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>&amp;) {
<a name="l00994"></a>00994         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A from-lane number for edge &#39;&quot;</span> + fromEdge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; is not numeric (&quot;</span> + fromLaneS + <span class="stringliteral">&quot;).&quot;</span>);
<a name="l00995"></a>00995         <span class="keywordflow">return</span>;
<a name="l00996"></a>00996     }
<a name="l00997"></a>00997     fromLane -= 1;
<a name="l00998"></a>00998     <span class="keywordflow">if</span> (fromLane &lt; 0) {
<a name="l00999"></a>00999         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A from-lane number for edge &#39;&quot;</span> + fromEdge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; is not positive (&quot;</span> + fromLaneS + <span class="stringliteral">&quot;).&quot;</span>);
<a name="l01000"></a>01000         <span class="keywordflow">return</span>;
<a name="l01001"></a>01001     }
<a name="l01002"></a>01002     <span class="comment">// get the from-lane</span>
<a name="l01003"></a>01003     std::string toLaneS = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(<span class="stringliteral">&quot;NACHFSNR&quot;</span>));
<a name="l01004"></a>01004     <span class="keywordtype">int</span> toLane = -1;
<a name="l01005"></a>01005     <span class="keywordflow">try</span> {
<a name="l01006"></a>01006         toLane = <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2int</a>(toLaneS.c_str());
<a name="l01007"></a>01007     } <span class="keywordflow">catch</span> (<a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>&amp;) {
<a name="l01008"></a>01008         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A to-lane number for edge &#39;&quot;</span> + toEdge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; is not numeric (&quot;</span> + toLaneS + <span class="stringliteral">&quot;).&quot;</span>);
<a name="l01009"></a>01009         <span class="keywordflow">return</span>;
<a name="l01010"></a>01010     }
<a name="l01011"></a>01011     toLane -= 1;
<a name="l01012"></a>01012     <span class="keywordflow">if</span> (toLane &lt; 0) {
<a name="l01013"></a>01013         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A to-lane number for edge &#39;&quot;</span> + toEdge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; is not positive (&quot;</span> + toLaneS + <span class="stringliteral">&quot;).&quot;</span>);
<a name="l01014"></a>01014         <span class="keywordflow">return</span>;
<a name="l01015"></a>01015     }
<a name="l01016"></a>01016     <span class="comment">// !!! the next is probably a hack</span>
<a name="l01017"></a>01017     <span class="keywordflow">if</span> (fromLane - fromLaneOffset &lt; 0) {
<a name="l01018"></a>01018         fromLaneOffset = 0;
<a name="l01019"></a>01019     } <span class="keywordflow">else</span> {
<a name="l01020"></a>01020         fromLane = fromEdge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>() - (fromLane - fromLaneOffset) - 1;
<a name="l01021"></a>01021     }
<a name="l01022"></a>01022     <span class="keywordflow">if</span> (toLane - toLaneOffset &lt; 0) {
<a name="l01023"></a>01023         toLaneOffset = 0;
<a name="l01024"></a>01024     } <span class="keywordflow">else</span> {
<a name="l01025"></a>01025         toLane = toEdge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>() - (toLane - toLaneOffset) - 1;
<a name="l01026"></a>01026     }
<a name="l01027"></a>01027     <span class="comment">//</span>
<a name="l01028"></a>01028     <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>) fromEdge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>() &lt;= fromLane) {
<a name="l01029"></a>01029         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A from-lane number for edge &#39;&quot;</span> + fromEdge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; is larger than the edge&#39;s lane number (&quot;</span> + fromLaneS + <span class="stringliteral">&quot;).&quot;</span>);
<a name="l01030"></a>01030         <span class="keywordflow">return</span>;
<a name="l01031"></a>01031     }
<a name="l01032"></a>01032     <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>) toEdge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#aa6ed274bbffc247a43e91a8ec4b150a1" title="Returns the number of lanes.">getNumLanes</a>() &lt;= toLane) {
<a name="l01033"></a>01033         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;A to-lane number for edge &#39;&quot;</span> + toEdge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() + <span class="stringliteral">&quot;&#39; is larger than the edge&#39;s lane number (&quot;</span> + toLaneS + <span class="stringliteral">&quot;).&quot;</span>);
<a name="l01034"></a>01034         <span class="keywordflow">return</span>;
<a name="l01035"></a>01035     }
<a name="l01036"></a>01036     <span class="comment">//</span>
<a name="l01037"></a>01037     fromEdge-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#af27bdeb8f823e2a36cbe8784d9a514bb" title="Adds a connection between the specified this edge&amp;#39;s lane and an approached one...">addLane2LaneConnection</a>(fromLane, toEdge, toLane, <a class="code" href="../../d7/d41/class_n_b_edge.html#aa1576d07471ecc008d626cdbfb3302f2aba63868f28825735eb91856ff5ae804c" title="The connection was computed and validated.">NBEdge::L2L_VALIDATED</a>);
<a name="l01038"></a>01038 }
<a name="l01039"></a>01039 
<a name="l01040"></a>01040 
<a name="l01041"></a>01041 
<a name="l01042"></a>01042 
<a name="l01043"></a>01043 
<a name="l01044"></a>01044 
<a name="l01045"></a>01045 
<a name="l01046"></a>01046 
<a name="l01047"></a>01047 
<a name="l01048"></a>01048 
<a name="l01049"></a>01049 
<a name="l01050"></a>01050 
<a name="l01051"></a>01051 
<a name="l01052"></a>01052 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>
<a name="l01053"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#adb9a483db77597dbd0ae18c356788c40">01053</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#adb9a483db77597dbd0ae18c356788c40" title="tries to get a SUMOReal which is possibly assigned to a certain modality">NIImporter_VISUM::getWeightedFloat</a>(<span class="keyword">const</span> std::string&amp; name) {
<a name="l01054"></a>01054     <span class="keywordflow">try</span> {
<a name="l01055"></a>01055         <span class="keywordflow">return</span> <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2SUMOReal</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(name).c_str());
<a name="l01056"></a>01056     } <span class="keywordflow">catch</span> (...) {}
<a name="l01057"></a>01057     <span class="keywordflow">try</span> {
<a name="l01058"></a>01058         <span class="keywordflow">return</span> <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2SUMOReal</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>((name + <span class="stringliteral">&quot;(IV)&quot;</span>)).c_str());
<a name="l01059"></a>01059     } <span class="keywordflow">catch</span> (...) {}
<a name="l01060"></a>01060     <span class="keywordflow">return</span> -1;
<a name="l01061"></a>01061 }
<a name="l01062"></a>01062 
<a name="l01063"></a>01063 
<a name="l01064"></a>01064 <span class="keywordtype">bool</span>
<a name="l01065"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6b8d74ff56e8e6fbc4afe300bbccdfe0">01065</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a6b8d74ff56e8e6fbc4afe300bbccdfe0" title="tries to get a bool which is possibly assigned to a certain modality">NIImporter_VISUM::getWeightedBool</a>(<span class="keyword">const</span> std::string&amp; name) {
<a name="l01066"></a>01066     <span class="keywordflow">try</span> {
<a name="l01067"></a>01067         <span class="keywordflow">return</span> <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2bool</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(name).c_str());
<a name="l01068"></a>01068     } <span class="keywordflow">catch</span> (...) {}
<a name="l01069"></a>01069     <span class="keywordflow">try</span> {
<a name="l01070"></a>01070         <span class="keywordflow">return</span> <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2bool</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>((name + <span class="stringliteral">&quot;(IV)&quot;</span>)).c_str());
<a name="l01071"></a>01071     } <span class="keywordflow">catch</span> (...) {}
<a name="l01072"></a>01072     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01073"></a>01073 }
<a name="l01074"></a>01074 
<a name="l01075"></a>01075 
<a name="l01076"></a>01076 <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>*
<a name="l01077"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3">01077</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">NIImporter_VISUM::getNamedNode</a>(<span class="keyword">const</span> std::string&amp; fieldName) <span class="keywordflow">throw</span>(<a class="code" href="../../d5/d35/class_out_of_bounds_exception.html">OutOfBoundsException</a>, <a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>, <a class="code" href="../../d6/dd4/class_unknown_element.html">UnknownElement</a>) {
<a name="l01078"></a>01078     std::string nodeS = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(myLineParser.get(fieldName));
<a name="l01079"></a>01079     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* node = myNetBuilder.getNodeCont().retrieve(nodeS);
<a name="l01080"></a>01080     <span class="keywordflow">if</span> (node == 0) {
<a name="l01081"></a>01081         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;The node &#39;&quot;</span> + nodeS + <span class="stringliteral">&quot;&#39; is not known.&quot;</span>);
<a name="l01082"></a>01082     }
<a name="l01083"></a>01083     <span class="keywordflow">return</span> node;
<a name="l01084"></a>01084 }
<a name="l01085"></a>01085 
<a name="l01086"></a>01086 
<a name="l01087"></a>01087 <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>*
<a name="l01088"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab6ad26785f6d380390ad5e7aca1e49c4">01088</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa0a9acdc5b7b2d4b91b88cc1986227b3" title="Tries to get the node which name is stored in the given field.">NIImporter_VISUM::getNamedNode</a>(<span class="keyword">const</span> std::string&amp; fieldName1, <span class="keyword">const</span> std::string&amp; fieldName2) <span class="keywordflow">throw</span>(<a class="code" href="../../d5/d35/class_out_of_bounds_exception.html">OutOfBoundsException</a>, <a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>, <a class="code" href="../../d6/dd4/class_unknown_element.html">UnknownElement</a>) {
<a name="l01089"></a>01089     <span class="keywordflow">if</span> (myLineParser.know(fieldName1)) {
<a name="l01090"></a>01090         <span class="keywordflow">return</span> getNamedNode(fieldName1);
<a name="l01091"></a>01091     } <span class="keywordflow">else</span> {
<a name="l01092"></a>01092         <span class="keywordflow">return</span> getNamedNode(fieldName2);
<a name="l01093"></a>01093     }
<a name="l01094"></a>01094 }
<a name="l01095"></a>01095 
<a name="l01096"></a>01096 
<a name="l01097"></a>01097 <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>*
<a name="l01098"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2a4cdbc621a819ac5fe854f3826a3300">01098</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2a4cdbc621a819ac5fe854f3826a3300" title="Tries to get the edge which name is stored in the given field.">NIImporter_VISUM::getNamedEdge</a>(<span class="keyword">const</span> std::string&amp; fieldName) <span class="keywordflow">throw</span>(<a class="code" href="../../d5/d35/class_out_of_bounds_exception.html">OutOfBoundsException</a>, <a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>, <a class="code" href="../../d6/dd4/class_unknown_element.html">UnknownElement</a>) {
<a name="l01099"></a>01099     std::string edgeS = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(myLineParser.get(fieldName));
<a name="l01100"></a>01100     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* edge = myNetBuilder.getEdgeCont().retrieve(edgeS);
<a name="l01101"></a>01101     <span class="keywordflow">if</span> (edge == 0) {
<a name="l01102"></a>01102         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;The edge &#39;&quot;</span> + edgeS + <span class="stringliteral">&quot;&#39; is not known.&quot;</span>);
<a name="l01103"></a>01103     }
<a name="l01104"></a>01104     <span class="keywordflow">return</span> edge;
<a name="l01105"></a>01105 }
<a name="l01106"></a>01106 
<a name="l01107"></a>01107 
<a name="l01108"></a>01108 <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>*
<a name="l01109"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aa030e5333fbc12d1815cd00912276db7">01109</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a2a4cdbc621a819ac5fe854f3826a3300" title="Tries to get the edge which name is stored in the given field.">NIImporter_VISUM::getNamedEdge</a>(<span class="keyword">const</span> std::string&amp; fieldName1, <span class="keyword">const</span> std::string&amp; fieldName2) <span class="keywordflow">throw</span>(<a class="code" href="../../d5/d35/class_out_of_bounds_exception.html">OutOfBoundsException</a>, <a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>, <a class="code" href="../../d6/dd4/class_unknown_element.html">UnknownElement</a>) {
<a name="l01110"></a>01110     <span class="keywordflow">if</span> (myLineParser.know(fieldName1)) {
<a name="l01111"></a>01111         <span class="keywordflow">return</span> getNamedEdge(fieldName1);
<a name="l01112"></a>01112     } <span class="keywordflow">else</span> {
<a name="l01113"></a>01113         <span class="keywordflow">return</span> getNamedEdge(fieldName2);
<a name="l01114"></a>01114     }
<a name="l01115"></a>01115 }
<a name="l01116"></a>01116 
<a name="l01117"></a>01117 
<a name="l01118"></a>01118 
<a name="l01119"></a>01119 <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>*
<a name="l01120"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a93559a4af58ba846fbc84947c3acfe8d">01120</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a93559a4af58ba846fbc84947c3acfe8d" title="Returns the opposite direction of the given edge.">NIImporter_VISUM::getReversedContinuating</a>(<a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* edge, <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* node) {
<a name="l01121"></a>01121     std::string sid;
<a name="l01122"></a>01122     <span class="keywordflow">if</span> (edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] == <span class="charliteral">&#39;-&#39;</span>) {
<a name="l01123"></a>01123         sid = edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(1);
<a name="l01124"></a>01124     } <span class="keywordflow">else</span> {
<a name="l01125"></a>01125         sid = <span class="stringliteral">&quot;-&quot;</span> + edge-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>();
<a name="l01126"></a>01126     }
<a name="l01127"></a>01127     <span class="keywordflow">if</span> (sid.find(<span class="charliteral">&#39;_&#39;</span>) != std::string::npos) {
<a name="l01128"></a>01128         sid = sid.substr(0, sid.find(<span class="charliteral">&#39;_&#39;</span>));
<a name="l01129"></a>01129     }
<a name="l01130"></a>01130     <span class="keywordflow">return</span> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad19640977681b410a0b7fdec6d0c176d" title="Tries to get the edge which name is stored in the given field continuating the search...">getNamedEdgeContinuating</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(sid),  node);
<a name="l01131"></a>01131 }
<a name="l01132"></a>01132 
<a name="l01133"></a>01133 
<a name="l01134"></a>01134 <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>*
<a name="l01135"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a8128e98f1adfe190e59c64a240e4fed5">01135</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad19640977681b410a0b7fdec6d0c176d" title="Tries to get the edge which name is stored in the given field continuating the search...">NIImporter_VISUM::getNamedEdgeContinuating</a>(<a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* begin, <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* node) {
<a name="l01136"></a>01136     <span class="keywordflow">if</span> (begin == 0) {
<a name="l01137"></a>01137         <span class="keywordflow">return</span> 0;
<a name="l01138"></a>01138     }
<a name="l01139"></a>01139     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* ret = begin;
<a name="l01140"></a>01140     std::string edgeID = ret-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>();
<a name="l01141"></a>01141     <span class="comment">// hangle forward</span>
<a name="l01142"></a>01142     <span class="keywordflow">while</span> (ret != 0) {
<a name="l01143"></a>01143         <span class="comment">// ok, this is the edge we are looking for</span>
<a name="l01144"></a>01144         <span class="keywordflow">if</span> (ret-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a47de8fb27ded13ba7886218da6b9a60f" title="Returns the destination node of the edge.">getToNode</a>() == node) {
<a name="l01145"></a>01145             <span class="keywordflow">return</span> ret;
<a name="l01146"></a>01146         }
<a name="l01147"></a>01147         <span class="keyword">const</span> <a class="code" href="../../db/dde/_n_b_cont_8h.html#a7bbd80497f8b27f18697210825ec974a">EdgeVector</a>&amp; nedges = ret-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#a47de8fb27ded13ba7886218da6b9a60f" title="Returns the destination node of the edge.">getToNode</a>()-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a7e586b529f4d8c758716a8c72220ca38" title="Returns this node&amp;#39;s outgoing edges.">getOutgoingEdges</a>();
<a name="l01148"></a>01148         <span class="keywordflow">if</span> (nedges.size() != 1) {
<a name="l01149"></a>01149             <span class="comment">// too many edges follow</span>
<a name="l01150"></a>01150             ret = 0;
<a name="l01151"></a>01151             <span class="keywordflow">continue</span>;
<a name="l01152"></a>01152         }
<a name="l01153"></a>01153         <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* next = nedges[0];
<a name="l01154"></a>01154         <span class="keywordflow">if</span> (ret-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(0, edgeID.length()) != next-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(0, edgeID.length())) {
<a name="l01155"></a>01155             <span class="comment">// ok, another edge is next...</span>
<a name="l01156"></a>01156             ret = 0;
<a name="l01157"></a>01157             <span class="keywordflow">continue</span>;
<a name="l01158"></a>01158         }
<a name="l01159"></a>01159         <span class="keywordflow">if</span> (next-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(next-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().length() - node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().length()) != node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()) {
<a name="l01160"></a>01160             ret = 0;
<a name="l01161"></a>01161             <span class="keywordflow">continue</span>;
<a name="l01162"></a>01162         }
<a name="l01163"></a>01163         ret = next;
<a name="l01164"></a>01164     }
<a name="l01165"></a>01165 
<a name="l01166"></a>01166     ret = begin;
<a name="l01167"></a>01167     <span class="comment">// hangle backward</span>
<a name="l01168"></a>01168     <span class="keywordflow">while</span> (ret != 0) {
<a name="l01169"></a>01169         <span class="comment">// ok, this is the edge we are looking for</span>
<a name="l01170"></a>01170         <span class="keywordflow">if</span> (ret-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#ab279b96c38a10b1aafba2b8f736b0410" title="Returns the origin node of the edge.">getFromNode</a>() == node) {
<a name="l01171"></a>01171             <span class="keywordflow">return</span> ret;
<a name="l01172"></a>01172         }
<a name="l01173"></a>01173         <span class="keyword">const</span> <a class="code" href="../../db/dde/_n_b_cont_8h.html#a7bbd80497f8b27f18697210825ec974a">EdgeVector</a>&amp; nedges = ret-&gt;<a class="code" href="../../d7/d41/class_n_b_edge.html#ab279b96c38a10b1aafba2b8f736b0410" title="Returns the origin node of the edge.">getFromNode</a>()-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a8528083710540004a765fc56643c9562" title="Returns this node&amp;#39;s incoming edges.">getIncomingEdges</a>();
<a name="l01174"></a>01174         <span class="keywordflow">if</span> (nedges.size() != 1) {
<a name="l01175"></a>01175             <span class="comment">// too many edges follow</span>
<a name="l01176"></a>01176             ret = 0;
<a name="l01177"></a>01177             <span class="keywordflow">continue</span>;
<a name="l01178"></a>01178         }
<a name="l01179"></a>01179         <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* next = nedges[0];
<a name="l01180"></a>01180         <span class="keywordflow">if</span> (ret-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(0, edgeID.length()) != next-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(0, edgeID.length())) {
<a name="l01181"></a>01181             <span class="comment">// ok, another edge is next...</span>
<a name="l01182"></a>01182             ret = 0;
<a name="l01183"></a>01183             <span class="keywordflow">continue</span>;
<a name="l01184"></a>01184         }
<a name="l01185"></a>01185         <span class="keywordflow">if</span> (next-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(next-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().length() - node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().length()) != node-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()) {
<a name="l01186"></a>01186             ret = 0;
<a name="l01187"></a>01187             <span class="keywordflow">continue</span>;
<a name="l01188"></a>01188         }
<a name="l01189"></a>01189         ret = next;
<a name="l01190"></a>01190     }
<a name="l01191"></a>01191     <span class="keywordflow">return</span> 0;
<a name="l01192"></a>01192 }
<a name="l01193"></a>01193 
<a name="l01194"></a>01194 
<a name="l01195"></a>01195 <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>*
<a name="l01196"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad19640977681b410a0b7fdec6d0c176d">01196</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad19640977681b410a0b7fdec6d0c176d" title="Tries to get the edge which name is stored in the given field continuating the search...">NIImporter_VISUM::getNamedEdgeContinuating</a>(<span class="keyword">const</span> std::string&amp; fieldName, <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* node) <span class="keywordflow">throw</span>(<a class="code" href="../../d5/d35/class_out_of_bounds_exception.html">OutOfBoundsException</a>, <a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>, <a class="code" href="../../d6/dd4/class_unknown_element.html">UnknownElement</a>) {
<a name="l01197"></a>01197     std::string edgeS = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(myLineParser.get(fieldName));
<a name="l01198"></a>01198     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* edge = myNetBuilder.getEdgeCont().retrieve(edgeS);
<a name="l01199"></a>01199     <span class="keywordflow">if</span> (edge == 0) {
<a name="l01200"></a>01200         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;The edge &#39;&quot;</span> + edgeS + <span class="stringliteral">&quot;&#39; is not known.&quot;</span>);
<a name="l01201"></a>01201     }
<a name="l01202"></a>01202     <span class="keywordflow">return</span> getNamedEdgeContinuating(edge, node);
<a name="l01203"></a>01203 }
<a name="l01204"></a>01204 
<a name="l01205"></a>01205 
<a name="l01206"></a>01206 <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>*
<a name="l01207"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a801b8ddb85852e603a6f9d56246a9289">01207</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad19640977681b410a0b7fdec6d0c176d" title="Tries to get the edge which name is stored in the given field continuating the search...">NIImporter_VISUM::getNamedEdgeContinuating</a>(<span class="keyword">const</span> std::string&amp; fieldName1, <span class="keyword">const</span> std::string&amp; fieldName2,
<a name="l01208"></a>01208         <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* node) <span class="keywordflow">throw</span>(<a class="code" href="../../d5/d35/class_out_of_bounds_exception.html">OutOfBoundsException</a>, <a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>, <a class="code" href="../../d6/dd4/class_unknown_element.html">UnknownElement</a>) {
<a name="l01209"></a>01209     <span class="keywordflow">if</span> (myLineParser.know(fieldName1)) {
<a name="l01210"></a>01210         <span class="keywordflow">return</span> getNamedEdgeContinuating(fieldName1, node);
<a name="l01211"></a>01211     } <span class="keywordflow">else</span> {
<a name="l01212"></a>01212         <span class="keywordflow">return</span> getNamedEdgeContinuating(fieldName2, node);
<a name="l01213"></a>01213     }
<a name="l01214"></a>01214 }
<a name="l01215"></a>01215 
<a name="l01216"></a>01216 
<a name="l01217"></a>01217 <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>*
<a name="l01218"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab28559118d25490d8c719e4f9d939123">01218</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab28559118d25490d8c719e4f9d939123" title="Returns the edge that connects both nodes.">NIImporter_VISUM::getEdge</a>(<a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* FromNode, <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* ToNode) {
<a name="l01219"></a>01219     EdgeVector::const_iterator i;
<a name="l01220"></a>01220     <span class="keywordflow">for</span> (i = FromNode-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a7e586b529f4d8c758716a8c72220ca38" title="Returns this node&amp;#39;s outgoing edges.">getOutgoingEdges</a>().begin(); i != FromNode-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a7e586b529f4d8c758716a8c72220ca38" title="Returns this node&amp;#39;s outgoing edges.">getOutgoingEdges</a>().end(); i++) {
<a name="l01221"></a>01221         <span class="keywordflow">if</span> (ToNode == (*i)-&gt;getToNode()) {
<a name="l01222"></a>01222             <span class="keywordflow">return</span>(*i);
<a name="l01223"></a>01223         }
<a name="l01224"></a>01224     }
<a name="l01226"></a>01226     <span class="keywordflow">return</span> 0;
<a name="l01227"></a>01227 }
<a name="l01228"></a>01228 
<a name="l01229"></a>01229 
<a name="l01230"></a>01230 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>
<a name="l01231"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b">01231</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">NIImporter_VISUM::getNamedFloat</a>(<span class="keyword">const</span> std::string&amp; fieldName) <span class="keywordflow">throw</span>(<a class="code" href="../../d5/d35/class_out_of_bounds_exception.html">OutOfBoundsException</a>, <a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>, <a class="code" href="../../d6/dd4/class_unknown_element.html">UnknownElement</a>) {
<a name="l01232"></a>01232     std::string valS = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(myLineParser.get(fieldName));
<a name="l01233"></a>01233     <span class="keywordflow">return</span> <a class="code" href="../../da/d64/class_tpl_convert.html#ac07e067722ca3e9a84b3ef39ece315ee">TplConvert&lt;char&gt;::_2SUMOReal</a>(valS.c_str());
<a name="l01234"></a>01234 }
<a name="l01235"></a>01235 
<a name="l01236"></a>01236 
<a name="l01237"></a>01237 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>
<a name="l01238"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab2dfb0c74a101a979baf28a8cc8d5c76">01238</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">NIImporter_VISUM::getNamedFloat</a>(<span class="keyword">const</span> std::string&amp; fieldName, <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> defaultValue) {
<a name="l01239"></a>01239     <span class="keywordflow">try</span> {
<a name="l01240"></a>01240         std::string valS = <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a218ad41f6ab04da3c23f880145088c90" title="Returns the named information.">get</a>(fieldName));
<a name="l01241"></a>01241         <span class="keywordflow">return</span> <a class="code" href="../../da/d64/class_tpl_convert.html">TplConvert&lt;char&gt;::_2SUMOReal</a>(valS.c_str());
<a name="l01242"></a>01242     } <span class="keywordflow">catch</span> (...) {
<a name="l01243"></a>01243         <span class="keywordflow">return</span> defaultValue;
<a name="l01244"></a>01244     }
<a name="l01245"></a>01245 }
<a name="l01246"></a>01246 
<a name="l01247"></a>01247 
<a name="l01248"></a>01248 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>
<a name="l01249"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aba5cd7a1c345aee1e2e7d20b8b7e8580">01249</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">NIImporter_VISUM::getNamedFloat</a>(<span class="keyword">const</span> std::string&amp; fieldName1, <span class="keyword">const</span> std::string&amp; fieldName2) <span class="keywordflow">throw</span>(<a class="code" href="../../d5/d35/class_out_of_bounds_exception.html">OutOfBoundsException</a>, <a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>, <a class="code" href="../../d6/dd4/class_unknown_element.html">UnknownElement</a>) {
<a name="l01250"></a>01250     <span class="keywordflow">if</span> (myLineParser.know(fieldName1)) {
<a name="l01251"></a>01251         <span class="keywordflow">return</span> getNamedFloat(fieldName1);
<a name="l01252"></a>01252     } <span class="keywordflow">else</span> {
<a name="l01253"></a>01253         <span class="keywordflow">return</span> getNamedFloat(fieldName2);
<a name="l01254"></a>01254     }
<a name="l01255"></a>01255 }
<a name="l01256"></a>01256 
<a name="l01257"></a>01257 
<a name="l01258"></a>01258 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>
<a name="l01259"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a9e6d1e5acfd1074f1a9631c4b8c859e6">01259</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">NIImporter_VISUM::getNamedFloat</a>(<span class="keyword">const</span> std::string&amp; fieldName1, <span class="keyword">const</span> std::string&amp; fieldName2,
<a name="l01260"></a>01260                                 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> defaultValue) {
<a name="l01261"></a>01261     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ab3560f282a2688008ccbd89cdfa4de5b" title="the parser to parse the information from the data lines">myLineParser</a>.<a class="code" href="../../db/dc1/class_named_columns_parser.html#a2834d8698bfd90f3ff11a169b736079b" title="Returns the information whether the named column is known.">know</a>(fieldName1)) {
<a name="l01262"></a>01262         <span class="keywordflow">return</span> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(fieldName1, defaultValue);
<a name="l01263"></a>01263     } <span class="keywordflow">else</span> {
<a name="l01264"></a>01264         <span class="keywordflow">return</span> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a22980a043a8d768101e6ad8187b2937b" title="Returns the value from the named column as a float.">getNamedFloat</a>(fieldName2, defaultValue);
<a name="l01265"></a>01265     }
<a name="l01266"></a>01266 }
<a name="l01267"></a>01267 
<a name="l01268"></a>01268 
<a name="l01269"></a>01269 std::string
<a name="l01270"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad62f01581f1a2eb16160c719044ecacf">01270</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad62f01581f1a2eb16160c719044ecacf" title="Returns the value from the named column as a normalised string.">NIImporter_VISUM::getNamedString</a>(<span class="keyword">const</span> std::string&amp; fieldName) <span class="keywordflow">throw</span>(<a class="code" href="../../d5/d35/class_out_of_bounds_exception.html">OutOfBoundsException</a>, <a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>, <a class="code" href="../../d6/dd4/class_unknown_element.html">UnknownElement</a>) {
<a name="l01271"></a>01271     <span class="keywordflow">return</span> <a class="code" href="../../d5/d33/class_n_b_helpers.html#a7e9fea8c84ebd87cea4c27547853997f">NBHelpers::normalIDRepresentation</a>(myLineParser.get(fieldName));
<a name="l01272"></a>01272 }
<a name="l01273"></a>01273 
<a name="l01274"></a>01274 
<a name="l01275"></a>01275 std::string
<a name="l01276"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a193df64b2d93b5246452ea9a49c7a877">01276</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#ad62f01581f1a2eb16160c719044ecacf" title="Returns the value from the named column as a normalised string.">NIImporter_VISUM::getNamedString</a>(<span class="keyword">const</span> std::string&amp; fieldName1,
<a name="l01277"></a>01277                                  <span class="keyword">const</span> std::string&amp; fieldName2) <span class="keywordflow">throw</span>(<a class="code" href="../../d5/d35/class_out_of_bounds_exception.html">OutOfBoundsException</a>, <a class="code" href="../../d7/ddc/class_number_format_exception.html">NumberFormatException</a>, <a class="code" href="../../d6/dd4/class_unknown_element.html">UnknownElement</a>) {
<a name="l01278"></a>01278     <span class="keywordflow">if</span> (myLineParser.know(fieldName1)) {
<a name="l01279"></a>01279         <span class="keywordflow">return</span> getNamedString(fieldName1);
<a name="l01280"></a>01280     } <span class="keywordflow">else</span> {
<a name="l01281"></a>01281         <span class="keywordflow">return</span> getNamedString(fieldName2);
<a name="l01282"></a>01282     }
<a name="l01283"></a>01283 }
<a name="l01284"></a>01284 
<a name="l01285"></a>01285 
<a name="l01286"></a>01286 
<a name="l01287"></a>01287 
<a name="l01288"></a>01288 
<a name="l01289"></a>01289 
<a name="l01290"></a>01290 <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>*
<a name="l01291"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aadfe33ba415589bf78c65c24d1a923b0">01291</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#aadfe33ba415589bf78c65c24d1a923b0" title="Builds a node for the given district and returns it.">NIImporter_VISUM::buildDistrictNode</a>(<span class="keyword">const</span> std::string&amp; <span class="keywordtype">id</span>, <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* dest,
<a name="l01292"></a>01292                                     <span class="keywordtype">bool</span> isSource) {
<a name="l01293"></a>01293     <span class="comment">// get the district</span>
<a name="l01294"></a>01294     <a class="code" href="../../d7/d91/class_n_b_district.html" title="A class representing a single district.">NBDistrict</a>* dist = <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#a2edf6eadc99eaa3ec8c191a31b916693" title="Returns the districts container.">getDistrictCont</a>().<a class="code" href="../../d3/d1f/class_n_b_district_cont.html#a2a257e26e757114c469d53547d61b5b0" title="Returns the districts with the given id.">retrieve</a>(<span class="keywordtype">id</span>);
<a name="l01295"></a>01295     <span class="keywordflow">if</span> (dist == 0) {
<a name="l01296"></a>01296         <span class="keywordflow">return</span> 0;
<a name="l01297"></a>01297     }
<a name="l01298"></a>01298     <span class="comment">// build the id</span>
<a name="l01299"></a>01299     std::string nid;
<a name="l01300"></a>01300     nid = <span class="keywordtype">id</span> + <span class="stringliteral">&quot;-&quot;</span> + dest-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>();
<a name="l01301"></a>01301     <span class="keywordflow">if</span> (!isSource) {
<a name="l01302"></a>01302         nid = <span class="stringliteral">&quot;-&quot;</span> + nid;
<a name="l01303"></a>01303     }
<a name="l01304"></a>01304     <span class="comment">// insert the node</span>
<a name="l01305"></a>01305     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>().<a class="code" href="../../db/d8c/class_n_b_node_cont.html#ab70c3a2678e411a0b1e3edd41d2dd177" title="Inserts a node into the map.">insert</a>(nid, dist-&gt;<a class="code" href="../../d7/d91/class_n_b_district.html#a83b492866f271c4a14e39ccf5da9af03" title="Returns the position of this district&amp;#39;s center.">getPosition</a>())) {
<a name="l01306"></a>01306         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Could not build connector node &#39;&quot;</span> + nid + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l01307"></a>01307     }
<a name="l01308"></a>01308     <span class="comment">// return the node</span>
<a name="l01309"></a>01309     <span class="keywordflow">return</span> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a0de83ec7413e36a12398824a1102538b" title="the network builder to fill with loaded values">myNetBuilder</a>.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>().<a class="code" href="../../db/d8c/class_n_b_node_cont.html#a0e2ce1b9413a0c11728ac63344c62039" title="Returns the node with the given name.">retrieve</a>(nid);
<a name="l01310"></a>01310 }
<a name="l01311"></a>01311 
<a name="l01312"></a>01312 
<a name="l01313"></a>01313 <span class="keywordtype">bool</span>
<a name="l01314"></a><a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a91ca97f18f3627f93ec8bd458536b571">01314</a> <a class="code" href="../../d6/d9e/class_n_i_importer___v_i_s_u_m.html#a91ca97f18f3627f93ec8bd458536b571" title="Returns whether both nodes are a valid combination of from/to-nodes.">NIImporter_VISUM::checkNodes</a>(<a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* from, <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* to)  {
<a name="l01315"></a>01315     <span class="keywordflow">if</span> (from == 0) {
<a name="l01316"></a>01316         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot; The from-node was not found within the net&quot;</span>);
<a name="l01317"></a>01317     }
<a name="l01318"></a>01318     <span class="keywordflow">if</span> (to == 0) {
<a name="l01319"></a>01319         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot; The to-node was not found within the net&quot;</span>);
<a name="l01320"></a>01320     }
<a name="l01321"></a>01321     <span class="keywordflow">if</span> (from == to) {
<a name="l01322"></a>01322         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot; Both nodes are the same&quot;</span>);
<a name="l01323"></a>01323     }
<a name="l01324"></a>01324     <span class="keywordflow">return</span> from != 0 &amp;&amp; to != 0 &amp;&amp; from != to;
<a name="l01325"></a>01325 }
<a name="l01326"></a>01326 
<a name="l01327"></a>01327 
<a name="l01328"></a>01328 <span class="comment">/****************************************************************************/</span>
<a name="l01329"></a>01329 
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Jul 17 12:16:07 2012 for SUMO - Simulation of Urban MObility by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
