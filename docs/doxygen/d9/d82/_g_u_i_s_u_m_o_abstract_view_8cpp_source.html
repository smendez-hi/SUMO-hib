<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SUMO - Simulation of Urban MObility: GUISUMOAbstractView.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="../../dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_46b8f36974b309f038ffc35aa047a32b.html">boni</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_52e5be8ca53cec2b5437a8ba83e8e4f0.html">Desktop</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_7de3ce0f65e0314f747915173f89e60e.html">DanielTouched</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_a0096e276045b3ff0719c75e0b3c59bf.html">sumo-0.14.0</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_e9b8d709919855cd07b0394009af2578.html">src</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_1483c02c3ac093476d23f4486d5a6601.html">utils</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_f946d161b5205887f2d634ae171d54ba.html">gui</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_3f81ddaba5df985750d0b4003557c6ee.html">windows</a>
  </div>
</div>
<div class="contents">
<h1>GUISUMOAbstractView.cpp</h1><a href="../../d9/d82/_g_u_i_s_u_m_o_abstract_view_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************/</span>
<a name="l00011"></a>00011 <span class="comment">// The base class for a view</span>
<a name="l00012"></a>00012 <span class="comment">/****************************************************************************/</span>
<a name="l00013"></a>00013 <span class="comment">// SUMO, Simulation of Urban MObility; see http://sumo.sourceforge.net/</span>
<a name="l00014"></a>00014 <span class="comment">// Copyright (C) 2001-2012 DLR (http://www.dlr.de/) and contributors</span>
<a name="l00015"></a>00015 <span class="comment">/****************************************************************************/</span>
<a name="l00016"></a>00016 <span class="comment">//</span>
<a name="l00017"></a>00017 <span class="comment">//   This file is part of SUMO.</span>
<a name="l00018"></a>00018 <span class="comment">//   SUMO is free software: you can redistribute it and/or modify</span>
<a name="l00019"></a>00019 <span class="comment">//   it under the terms of the GNU General Public License as published by</span>
<a name="l00020"></a>00020 <span class="comment">//   the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00021"></a>00021 <span class="comment">//   (at your option) any later version.</span>
<a name="l00022"></a>00022 <span class="comment">//</span>
<a name="l00023"></a>00023 <span class="comment">/****************************************************************************/</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="comment">// ===========================================================================</span>
<a name="l00027"></a>00027 <span class="comment">// included modules</span>
<a name="l00028"></a>00028 <span class="comment">// ===========================================================================</span>
<a name="l00029"></a>00029 <span class="preprocessor">#ifdef _MSC_VER</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d3/d99/windows__config_8h.html">windows_config.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#else</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../db/d16/config_8h.html">config.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#endif</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span>
<a name="l00035"></a>00035 <span class="preprocessor">#ifdef _WIN32</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span><span class="preprocessor">#include &lt;windows.h&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#endif</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;utility&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;fxkeys.h&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;GL/gl.h&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;GL/glu.h&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;<a class="code" href="../../d6/dbe/polyfonts_8h.html">foreign/polyfonts/polyfonts.h</a>&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;<a class="code" href="../../df/db7/gl2ps_8h.html">foreign/gl2ps/gl2ps.h</a>&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;<a class="code" href="../../d2/d25/_f_x_single_event_thread_8h.html">utils/foxtools/FXSingleEventThread.h</a>&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;<a class="code" href="../../df/d17/_m_f_x_checkable_button_8h.html">utils/foxtools/MFXCheckableButton.h</a>&gt;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/d94/_m_f_x_image_helper_8h.html">utils/foxtools/MFXImageHelper.h</a>&gt;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;<a class="code" href="../../d8/d99/_r_g_b_color_8h.html">utils/common/RGBColor.h</a>&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;<a class="code" href="../../d8/d08/_to_string_8h.html">utils/common/ToString.h</a>&gt;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &lt;<a class="code" href="../../de/dde/_string_utils_8h.html">utils/common/StringUtils.h</a>&gt;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &lt;<a class="code" href="../../d4/df7/_msg_handler_8h.html">utils/common/MsgHandler.h</a>&gt;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &lt;<a class="code" href="../../d7/d72/_g_u_i_app_enum_8h.html">utils/gui/windows/GUIAppEnum.h</a>&gt;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &lt;<a class="code" href="../../d9/ddc/_g_u_i_g_l_object_popup_menu_8h.html">utils/gui/globjects/GUIGLObjectPopupMenu.h</a>&gt;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &lt;<a class="code" href="../../dd/dd5/_g_u_i_textures_helper_8h.html">utils/gui/images/GUITexturesHelper.h</a>&gt;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &lt;<a class="code" href="../../dc/df0/_g_u_i_global_selection_8h.html">utils/gui/div/GUIGlobalSelection.h</a>&gt;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &lt;<a class="code" href="../../d9/d86/_g_l_helper_8h.html">utils/gui/div/GLHelper.h</a>&gt;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &lt;<a class="code" href="../../d5/df8/_g_u_i_gl_object_storage_8h.html">utils/gui/globjects/GUIGlObjectStorage.h</a>&gt;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &lt;<a class="code" href="../../d2/d0d/_g_u_i_gl_object_8h.html">utils/gui/globjects/GUIGlObject.h</a>&gt;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &lt;<a class="code" href="../../d5/df8/_g_u_i_gl_object_storage_8h.html">utils/gui/globjects/GUIGlObjectStorage.h</a>&gt;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &lt;<a class="code" href="../../de/d0a/_point_of_interest_8h.html">utils/shapes/PointOfInterest.h</a>&gt;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &lt;<a class="code" href="../../d6/d93/_g_u_i_point_of_interest_8h.html">utils/gui/globjects/GUIPointOfInterest.h</a>&gt;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &lt;<a class="code" href="../../d6/dd2/_g_u_i_polygon_8h.html">utils/gui/globjects/GUIPolygon.h</a>&gt;</span>
<a name="l00066"></a>00066 <span class="preprocessor">#include &lt;<a class="code" href="../../d6/d40/_g_u_i_dialog___view_settings_8h.html">utils/gui/windows/GUIDialog_ViewSettings.h</a>&gt;</span>
<a name="l00067"></a>00067 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/d6d/_geo_conv_helper_8h.html">utils/geom/GeoConvHelper.h</a>&gt;</span>
<a name="l00068"></a>00068 <span class="preprocessor">#include &lt;<a class="code" href="../../d5/d93/_g_u_i_complete_scheme_storage_8h.html">utils/gui/settings/GUICompleteSchemeStorage.h</a>&gt;</span>
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="preprocessor">#include &quot;<a class="code" href="../../d8/d3a/_g_u_i_s_u_m_o_abstract_view_8h.html">GUISUMOAbstractView.h</a>&quot;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d7d/_g_u_i_main_window_8h.html">GUIMainWindow.h</a>&quot;</span>
<a name="l00072"></a>00072 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/db3/_g_u_i_gl_child_window_8h.html">GUIGlChildWindow.h</a>&quot;</span>
<a name="l00073"></a>00073 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/de7/_g_u_i_daniel_perspective_changer_8h.html">GUIDanielPerspectiveChanger.h</a>&quot;</span>
<a name="l00074"></a>00074 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d48/_g_u_i_dialog___edit_viewport_8h.html">GUIDialog_EditViewport.h</a>&quot;</span>
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00077"></a>00077 <span class="preprocessor"></span><span class="preprocessor">#include &lt;windows.h&gt;</span>
<a name="l00078"></a>00078 <span class="preprocessor">#endif</span>
<a name="l00079"></a>00079 <span class="preprocessor"></span>
<a name="l00080"></a>00080 <span class="preprocessor">#ifdef CHECK_MEMORY_LEAKS</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d7/d8d/debug__new_8h.html">foreign/nvwa/debug_new.h</a>&gt;</span>
<a name="l00082"></a>00082 <span class="preprocessor">#endif // CHECK_MEMORY_LEAKS</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span>
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="comment">// ===========================================================================</span>
<a name="l00086"></a>00086 <span class="comment">// member method definitions</span>
<a name="l00087"></a>00087 <span class="comment">// ===========================================================================</span>
<a name="l00088"></a>00088 <span class="comment">/* -------------------------------------------------------------------------</span>
<a name="l00089"></a>00089 <span class="comment"> * GUISUMOAbstractView - FOX callback mapping</span>
<a name="l00090"></a>00090 <span class="comment"> * ----------------------------------------------------------------------- */</span>
<a name="l00091"></a>00091 <a class="code" href="../../d7/dd2/_g_u_i_dialog___app_settings_8cpp.html#a95627874b7bd28ce00ff6ef00b8aa25e">FXDEFMAP</a>(<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html">GUISUMOAbstractView</a>) GUISUMOAbstractViewMap[] = {
<a name="l00092"></a>00092     FXMAPFUNC(SEL_CONFIGURE,           0,                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aec8c9e1b56f3d0cc0ee6df12ad207991">GUISUMOAbstractView::onConfigure</a>),
<a name="l00093"></a>00093     FXMAPFUNC(SEL_PAINT,               0,                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ae7c3144b5620bb618ec41675b0157472">GUISUMOAbstractView::onPaint</a>),
<a name="l00094"></a>00094     FXMAPFUNC(SEL_LEFTBUTTONPRESS,     0,                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7445fb45765be747e83b71193e11e8c5">GUISUMOAbstractView::onLeftBtnPress</a>),
<a name="l00095"></a>00095     FXMAPFUNC(SEL_LEFTBUTTONRELEASE,   0,                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a107c47d8a185e87fc332c6b7cb8034c0">GUISUMOAbstractView::onLeftBtnRelease</a>),
<a name="l00096"></a>00096     FXMAPFUNC(SEL_RIGHTBUTTONPRESS,    0,                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aebb70809c06a0188914cc99119bc32bf">GUISUMOAbstractView::onRightBtnPress</a>),
<a name="l00097"></a>00097     FXMAPFUNC(SEL_RIGHTBUTTONRELEASE,  0,                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acd047ff57014d03830d883b9f588ab14">GUISUMOAbstractView::onRightBtnRelease</a>),
<a name="l00098"></a>00098     FXMAPFUNC(SEL_MOUSEWHEEL,          0,                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a67438f707600800b4f32daf99f8c6977">GUISUMOAbstractView::onMouseWheel</a>),
<a name="l00099"></a>00099     FXMAPFUNC(SEL_MOTION,              0,                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a3846430cbdb72e1c2ce70880604995c8">GUISUMOAbstractView::onMouseMove</a>),
<a name="l00100"></a>00100     FXMAPFUNC(SEL_LEAVE,               0,                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acc8592ae26e73e95c8c28cdad5d35812">GUISUMOAbstractView::onMouseLeft</a>),
<a name="l00101"></a>00101     FXMAPFUNC(SEL_KEYPRESS,            0,                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a8f6dadc4f7215448b427ae12f8cae45f">GUISUMOAbstractView::onKeyPress</a>),
<a name="l00102"></a>00102     FXMAPFUNC(SEL_KEYRELEASE,          0,                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa0c19fe2364d2cb0fe98136a3c8fe5c3">GUISUMOAbstractView::onKeyRelease</a>),
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 };
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 FXIMPLEMENT_ABSTRACT(<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html">GUISUMOAbstractView</a>, <a class="code" href="../../da/db9/class_f_x_g_l_canvas.html">FXGLCanvas</a>, GUISUMOAbstractViewMap, ARRAYNUMBER(GUISUMOAbstractViewMap))
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="comment">/* -------------------------------------------------------------------------</span>
<a name="l00111"></a>00111 <span class="comment"> * GUISUMOAbstractView - methods</span>
<a name="l00112"></a>00112 <span class="comment"> * ----------------------------------------------------------------------- */</span>
<a name="l00113"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a0fdbbe047c16eedf93b772ee816230b0">00113</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html">GUISUMOAbstractView</a>::<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html">GUISUMOAbstractView</a>(FXComposite* p,
<a name="l00114"></a>00114         <a class="code" href="../../db/dba/class_g_u_i_main_window.html">GUIMainWindow</a>&amp; app,
<a name="l00115"></a>00115         <a class="code" href="../../d3/d1b/class_g_u_i_gl_child_window.html">GUIGlChildWindow</a>* parent,
<a name="l00116"></a>00116         const <a class="code" href="../../d3/dca/class_s_u_m_o_r_tree.html">SUMORTree</a>&amp; grid,
<a name="l00117"></a>00117         FXGLVisual* glVis, <a class="code" href="../../da/db9/class_f_x_g_l_canvas.html">FXGLCanvas</a>* share)
<a name="l00118"></a>00118     : <a class="code" href="../../da/db9/class_f_x_g_l_canvas.html">FXGLCanvas</a>(p, glVis, share, p, <a class="code" href="../../d7/d72/_g_u_i_app_enum_8h.html#a0944a4353780132eeab7b06e3e42291da8ab2a7ad0d50117a860fcabdb61dc9f2" title="GLCanvas - ID.">MID_GLCANVAS</a>,
<a name="l00119"></a>00119                  LAYOUT_SIDE_TOP | LAYOUT_FILL_X | LAYOUT_FILL_Y, 0, 0, 0, 0),
<a name="l00120"></a>00120     myApp(&amp;app),
<a name="l00121"></a>00121     myParent(parent),
<a name="l00122"></a>00122     myGrid(&amp;((<a class="code" href="../../d3/dca/class_s_u_m_o_r_tree.html">SUMORTree</a>&amp;)grid)),
<a name="l00123"></a>00123     myChanger(0),
<a name="l00124"></a>00124     myMouseHotspotX(app.getDefaultCursor()-&gt;getHotX()),
<a name="l00125"></a>00125     myMouseHotspotY(app.getDefaultCursor()-&gt;getHotY()),
<a name="l00126"></a>00126     myPopup(0),
<a name="l00127"></a>00127     myUseToolTips(false),
<a name="l00128"></a>00128     myAmInitialised(false),
<a name="l00129"></a>00129     myViewportChooser(0),
<a name="l00130"></a>00130     myVisualizationChanger(0) {
<a name="l00131"></a>00131     setTarget(<span class="keyword">this</span>);
<a name="l00132"></a>00132     enable();
<a name="l00133"></a>00133     flags |= FLAG_ENABLED;
<a name="l00134"></a>00134     myInEditMode = <span class="keyword">false</span>;
<a name="l00135"></a>00135     <span class="comment">// show the middle at the beginning</span>
<a name="l00136"></a>00136     myChanger = <span class="keyword">new</span> <a class="code" href="../../db/dc0/class_g_u_i_daniel_perspective_changer.html">GUIDanielPerspectiveChanger</a>(*<span class="keyword">this</span>, *myGrid);
<a name="l00137"></a>00137     myVisualizationSettings = &amp;<a class="code" href="../../d5/d89/_g_u_i_complete_scheme_storage_8cpp.html#aaac1ed09d3a33c0ac241289470fd14b2">gSchemeStorage</a>.<a class="code" href="../../d8/dd3/class_g_u_i_complete_scheme_storage.html#a479b5323f57703a407fd09fbb5d3f3d5" title="Returns the default scheme.">getDefault</a>();
<a name="l00138"></a>00138     myVisualizationSettings-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a590a66fc225bef918d8444e2f5197733" title="whether the application is in gaming mode or not">gaming</a> = myApp-&gt;isGaming();
<a name="l00139"></a>00139     <a class="code" href="../../d5/d89/_g_u_i_complete_scheme_storage_8cpp.html#aaac1ed09d3a33c0ac241289470fd14b2">gSchemeStorage</a>.<a class="code" href="../../d8/dd3/class_g_u_i_complete_scheme_storage.html#aeda73c450e35a1b7e154204c0819e964" title="Sets the default viewport.">setViewport</a>(<span class="keyword">this</span>);
<a name="l00140"></a>00140 }
<a name="l00141"></a>00141 
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aec05c37079470926d554fbd09c48f0cf">00143</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aec05c37079470926d554fbd09c48f0cf" title="destructor">GUISUMOAbstractView::~GUISUMOAbstractView</a>() {
<a name="l00144"></a>00144     <a class="code" href="../../d5/d89/_g_u_i_complete_scheme_storage_8cpp.html#aaac1ed09d3a33c0ac241289470fd14b2">gSchemeStorage</a>.<a class="code" href="../../d8/dd3/class_g_u_i_complete_scheme_storage.html#ab0beda2f3476cfe46fd0e89913ad0741" title="Makes the scheme with the given name the default.">setDefault</a>(<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a2def519a8305211001e86588a29dde83" title="The name of this setting.">name</a>);
<a name="l00145"></a>00145     <a class="code" href="../../d5/d89/_g_u_i_complete_scheme_storage_8cpp.html#aaac1ed09d3a33c0ac241289470fd14b2">gSchemeStorage</a>.<a class="code" href="../../d8/dd3/class_g_u_i_complete_scheme_storage.html#a8e44ff8ef2cfba2559b2652cba2ef97e" title="Makes the given viewport the default.">saveViewport</a>(<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a62baa29ee8d9e12cde85b816ce34f85e" title="Returns the x-offset of the field to show stored in this changer.">getXPos</a>(), <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a6df84b97f6dd25f4ff750ed91c6b1aba" title="Returns the y-offset of the field to show stored in this changer.">getYPos</a>(), <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aae37ebcfff45a2726cf3d65c6a8a33d5" title="Returns the zoom factor computed stored in this changer.">getZoom</a>());
<a name="l00146"></a>00146     <span class="keyword">delete</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ad0751a829130381a7b30d4dee389b963" title="The current popup-menu.">myPopup</a>;
<a name="l00147"></a>00147     <span class="keyword">delete</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>;
<a name="l00148"></a>00148     <span class="keyword">delete</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a39df8523319abe783f14715389b77374">myViewportChooser</a>;
<a name="l00149"></a>00149     <span class="keyword">delete</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a26956c33042b18870af6fa300f5eb4da">myVisualizationChanger</a>;
<a name="l00150"></a>00150 }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="keywordtype">bool</span>
<a name="l00154"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a2ef358e3557bdc85f4fc20f0822792c6">00154</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a2ef358e3557bdc85f4fc20f0822792c6" title="returns true, if the edit button was pressed">GUISUMOAbstractView::isInEditMode</a>() {
<a name="l00155"></a>00155     <span class="keywordflow">return</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a869ede125659c05aae018355bc6adfbc" title="Information whether too-tip informations shall be generated.">myInEditMode</a>;
<a name="l00156"></a>00156 }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 <span class="keywordtype">void</span>
<a name="l00160"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a08eff36c002d3ec0fac054e9335e2167">00160</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a08eff36c002d3ec0fac054e9335e2167" title="A method that updates the tooltip.">GUISUMOAbstractView::updateToolTip</a>() {
<a name="l00161"></a>00161     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7744bfcee37891a3c2be2505388bdfdb">myUseToolTips</a>) {
<a name="l00162"></a>00162         <span class="keywordflow">return</span>;
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164     update();
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a>
<a name="l00169"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa293e9cefde49e0d39f7717f2c76a59d">00169</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa293e9cefde49e0d39f7717f2c76a59d" title="Returns the cursor&amp;#39;s x/y position within the network.">GUISUMOAbstractView::getPositionInformation</a>()<span class="keyword"> const </span>{
<a name="l00170"></a>00170     <a class="code" href="../../d5/dda/class_boundary.html" title="A class that stores a 2D geometrical boundary.">Boundary</a> bound = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aea56ecc20db34c280f8f6fc2f2030bd4">getViewport</a>();
<a name="l00171"></a>00171     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> x = bound.<a class="code" href="../../d5/dda/class_boundary.html#a68c581ea01becd3954fcc808ac476040" title="Returns minimum x-coordinate.">xmin</a>() + bound.<a class="code" href="../../d5/dda/class_boundary.html#a32ae1fd6f35bbd871344abdaef966c7b" title="Returns the width of the boudary.">getWidth</a>()  * <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acd8717d3758abe31fffb6e100c85240f" title="Position of the cursor relative to the window.">myWindowCursorPositionX</a> / getWidth();
<a name="l00172"></a>00172     <span class="comment">// cursor origin is in the top-left corner</span>
<a name="l00173"></a>00173     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> y = bound.<a class="code" href="../../d5/dda/class_boundary.html#a23f3304d1d057aec6a5255f519cc567d" title="Returns minimum y-coordinate.">ymin</a>() + bound.<a class="code" href="../../d5/dda/class_boundary.html#a9ea2d7003c5b45aed089f0870371d5f6" title="Returns the height of the boundary.">getHeight</a>() * (getHeight() - <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a420ee369e65186316af3742e94a23a6a">myWindowCursorPositionY</a>) / getHeight();
<a name="l00174"></a>00174     <span class="keywordflow">return</span> <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a>(x, y);
<a name="l00175"></a>00175 }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 
<a name="l00178"></a>00178 <span class="keywordtype">void</span>
<a name="l00179"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a42cd98a7463c4ec5df846c65df822c36">00179</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a42cd98a7463c4ec5df846c65df822c36">GUISUMOAbstractView::updatePositionInformation</a>()<span class="keyword"> const </span>{
<a name="l00180"></a>00180     <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a> pos = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa293e9cefde49e0d39f7717f2c76a59d" title="Returns the cursor&amp;#39;s x/y position within the network.">getPositionInformation</a>();
<a name="l00181"></a>00181     std::string text = <span class="stringliteral">&quot;x:&quot;</span> + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(pos.<a class="code" href="../../d7/d3b/class_position.html#a51c33a67d08730631a34482850b2203b" title="Returns the x-position.">x</a>()) + <span class="stringliteral">&quot;, y:&quot;</span> + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(pos.<a class="code" href="../../d7/d3b/class_position.html#a4a65556f1de2548b23ce662f81c7ab1a" title="Returns the y-position.">y</a>());
<a name="l00182"></a>00182     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a588bcd9c748b69b7e833c3845773cd72" title="The application.">myApp</a>-&gt;<a class="code" href="../../db/dba/class_g_u_i_main_window.html#a2b1fdadad33324cceb8592633d43afbf">getCartesianLabel</a>().setText(text.c_str());
<a name="l00183"></a>00183     <a class="code" href="../../d7/d6c/class_geo_conv_helper.html#a8f03ae762dfdf862d12d143d5c00ae14" title="the coordinate transformation for writing the location element and for tracking the...">GeoConvHelper::getFinal</a>().<a class="code" href="../../d7/d6c/class_geo_conv_helper.html#af092d1940680cabea56cb17697caea85" title="Converts the given cartesian (shifted) position to its geo (lat/long) representation...">cartesian2geo</a>(pos);
<a name="l00184"></a>00184     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d6c/class_geo_conv_helper.html#a8f03ae762dfdf862d12d143d5c00ae14" title="the coordinate transformation for writing the location element and for tracking the...">GeoConvHelper::getFinal</a>().usingGeoProjection()) {
<a name="l00185"></a>00185         text = <span class="stringliteral">&quot;lat:&quot;</span> + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(pos.<a class="code" href="../../d7/d3b/class_position.html#a4a65556f1de2548b23ce662f81c7ab1a" title="Returns the y-position.">y</a>(), <a class="code" href="../../db/d16/config_8h.html#af0f59594a39d322f77ff737ba2b00503">GEO_OUTPUT_ACCURACY</a>) + <span class="stringliteral">&quot;, lon:&quot;</span> + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(pos.<a class="code" href="../../d7/d3b/class_position.html#a51c33a67d08730631a34482850b2203b" title="Returns the x-position.">x</a>(), <a class="code" href="../../db/d16/config_8h.html#af0f59594a39d322f77ff737ba2b00503">GEO_OUTPUT_ACCURACY</a>);
<a name="l00186"></a>00186     } <span class="keywordflow">else</span> {
<a name="l00187"></a>00187         text = <span class="stringliteral">&quot;x:&quot;</span> + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(pos.<a class="code" href="../../d7/d3b/class_position.html#a51c33a67d08730631a34482850b2203b" title="Returns the x-position.">x</a>()) + <span class="stringliteral">&quot;, y:&quot;</span> + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(pos.<a class="code" href="../../d7/d3b/class_position.html#a4a65556f1de2548b23ce662f81c7ab1a" title="Returns the y-position.">y</a>());
<a name="l00188"></a>00188     }
<a name="l00189"></a>00189     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a588bcd9c748b69b7e833c3845773cd72" title="The application.">myApp</a>-&gt;<a class="code" href="../../db/dba/class_g_u_i_main_window.html#ac657e90dc5f3ea533fcc7805b87f490a">getGeoLabel</a>().setText(text.c_str());
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 <a class="code" href="../../d5/dda/class_boundary.html" title="A class that stores a 2D geometrical boundary.">Boundary</a>
<a name="l00194"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a82f8e51bbe0bae76c9049256e943a187">00194</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a82f8e51bbe0bae76c9049256e943a187">GUISUMOAbstractView::getVisibleBoundary</a>()<span class="keyword"> const </span>{
<a name="l00195"></a>00195     <span class="keywordflow">return</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aea56ecc20db34c280f8f6fc2f2030bd4">getViewport</a>();
<a name="l00196"></a>00196 }
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 <span class="keywordtype">void</span>
<a name="l00199"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a93e39d156d69f4eb0069449afc6334f3">00199</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a93e39d156d69f4eb0069449afc6334f3" title="performs the painting of the simulation">GUISUMOAbstractView::paintGL</a>() {
<a name="l00200"></a>00200     <span class="keywordflow">if</span> (getWidth() == 0 || getHeight() == 0) {
<a name="l00201"></a>00201         <span class="keywordflow">return</span>;
<a name="l00202"></a>00202     }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a0f5d56d0283da9b2e7567e1ca80d8671">getTrackedID</a>() &gt; 0) {
<a name="l00205"></a>00205         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a89f07a97c8886dcaed14eb4863b234d2" title="centers to the chosen artifact">centerTo</a>(<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a0f5d56d0283da9b2e7567e1ca80d8671">getTrackedID</a>(), <span class="keyword">false</span>);
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0;
<a name="l00209"></a>00209     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7744bfcee37891a3c2be2505388bdfdb">myUseToolTips</a>) {
<a name="l00210"></a>00210         <span class="keywordtype">id</span> = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a529d99f53f098e10a7d9b527f34c11f6" title="returns the id of the object under the cursor using GL_SELECT">getObjectUnderCursor</a>();
<a name="l00211"></a>00211     }
<a name="l00212"></a>00212 
<a name="l00213"></a>00213     <span class="comment">// draw</span>
<a name="l00214"></a>00214     glClearColor(
<a name="l00215"></a>00215         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a0a59d560b5b75c48e2b51734c040d3e1" title="The background color to use.">backgroundColor</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#af3739c0c10661723552770c0996ad7c2" title="Returns the red-amount of the color.">red</a>(),
<a name="l00216"></a>00216         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a0a59d560b5b75c48e2b51734c040d3e1" title="The background color to use.">backgroundColor</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#aecf0743143198bec2a7cc68fb4e9ad2e" title="Returns the green-amount of the color.">green</a>(),
<a name="l00217"></a>00217         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a0a59d560b5b75c48e2b51734c040d3e1" title="The background color to use.">backgroundColor</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#a797a5810e1de8c10b313809e4bdb5780" title="Returns the blue-amount of the color.">blue</a>(),
<a name="l00218"></a>00218         1);
<a name="l00219"></a>00219     glClear(GL_DEPTH_BUFFER_BIT | GL_COLOR_BUFFER_BIT);
<a name="l00220"></a>00220     glPolygonMode(GL_FRONT_AND_BACK, GL_FILL);
<a name="l00221"></a>00221 
<a name="l00222"></a>00222     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a20967e7453c09d8028c19545a18d7581" title="Information whether dithering shall be enabled.">dither</a>) {
<a name="l00223"></a>00223         glEnable(GL_DITHER);
<a name="l00224"></a>00224     } <span class="keywordflow">else</span> {
<a name="l00225"></a>00225         glDisable(GL_DITHER);
<a name="l00226"></a>00226     }
<a name="l00227"></a>00227     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a4785f0367ad6b842a8a623ad801c8cb1" title="Information whether antialiase shall be enabled.">antialiase</a>) {
<a name="l00228"></a>00228         glEnable(GL_BLEND);
<a name="l00229"></a>00229         glEnable(GL_POLYGON_SMOOTH);
<a name="l00230"></a>00230         glEnable(GL_LINE_SMOOTH);
<a name="l00231"></a>00231     } <span class="keywordflow">else</span> {
<a name="l00232"></a>00232         glDisable(GL_BLEND);
<a name="l00233"></a>00233         glDisable(GL_POLYGON_SMOOTH);
<a name="l00234"></a>00234         glDisable(GL_LINE_SMOOTH);
<a name="l00235"></a>00235     }
<a name="l00236"></a>00236 
<a name="l00237"></a>00237     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a828f29525f64e0388c850e14f7b360d8">applyGLTransform</a>();
<a name="l00238"></a>00238     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ae7ab139acb8e03f17cbb88b6ec83cacf">doPaintGL</a>(GL_RENDER, <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aea56ecc20db34c280f8f6fc2f2030bd4">getViewport</a>());
<a name="l00239"></a>00239     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#ac42a7eff976a68afded43a7e89ed307b" title="Information whether the size legend shall be drawn.">showSizeLegend</a>) {
<a name="l00240"></a>00240         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a13886c169edc2f1c1fe19749f8d9ea82">displayLegend</a>();
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242     <span class="comment">// check whether the select mode /tooltips)</span>
<a name="l00243"></a>00243     <span class="comment">//  shall be computed, too</span>
<a name="l00244"></a>00244     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7744bfcee37891a3c2be2505388bdfdb">myUseToolTips</a> &amp;&amp; <span class="keywordtype">id</span> != 0) {
<a name="l00245"></a>00245         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a71b9d7aab3c8ed1e0d4f21f63d41ce17" title="invokes the tooltip for the given object">showToolTipFor</a>(<span class="keywordtype">id</span>);
<a name="l00246"></a>00246     }
<a name="l00247"></a>00247     swapBuffers();
<a name="l00248"></a>00248 }
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 
<a name="l00251"></a>00251 <a class="code" href="../../d2/d0d/_g_u_i_gl_object_8h.html#aa15d4f4ec475c9fc58b18070c08978b7">GUIGlID</a>
<a name="l00252"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a529d99f53f098e10a7d9b527f34c11f6">00252</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a529d99f53f098e10a7d9b527f34c11f6" title="returns the id of the object under the cursor using GL_SELECT">GUISUMOAbstractView::getObjectUnderCursor</a>() {
<a name="l00253"></a>00253     <span class="keywordflow">return</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a9b63e17662231439f74a0d360b78f622" title="returns the id of the object at position using GL_SELECT">getObjectAtPosition</a>(<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa293e9cefde49e0d39f7717f2c76a59d" title="Returns the cursor&amp;#39;s x/y position within the network.">getPositionInformation</a>());
<a name="l00254"></a>00254 }
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 <a class="code" href="../../d2/d0d/_g_u_i_gl_object_8h.html#aa15d4f4ec475c9fc58b18070c08978b7">GUIGlID</a>
<a name="l00258"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a9b63e17662231439f74a0d360b78f622">00258</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a9b63e17662231439f74a0d360b78f622" title="returns the id of the object at position using GL_SELECT">GUISUMOAbstractView::getObjectAtPosition</a>(<a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a> pos) {
<a name="l00259"></a>00259     <span class="keyword">const</span> <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> SENSITIVITY = 0.1; <span class="comment">// meters</span>
<a name="l00260"></a>00260     <a class="code" href="../../d5/dda/class_boundary.html" title="A class that stores a 2D geometrical boundary.">Boundary</a> selection;
<a name="l00261"></a>00261     selection.<a class="code" href="../../d5/dda/class_boundary.html#a5645385e483e8b7c9a04762c79ab7ae6" title="Makes the boundary include the given coordinate.">add</a>(pos);
<a name="l00262"></a>00262     selection.<a class="code" href="../../d5/dda/class_boundary.html#ab4977ce85671488934e8a91c392518d3" title="extends the boundary by the given amount">grow</a>(SENSITIVITY);
<a name="l00263"></a>00263     <span class="keyword">const</span> std::vector&lt;GUIGlID&gt; ids = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aceda8f86812527348dcbf01d05284939" title="returns the ids of all objects in the given boundary">getObjectsInBoundary</a>(selection);
<a name="l00264"></a>00264     <span class="comment">// Interpret results</span>
<a name="l00265"></a>00265     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idMax = 0;
<a name="l00266"></a>00266     <span class="keywordtype">int</span> prevLayer = -1000;
<a name="l00267"></a>00267     <span class="keywordflow">for</span> (std::vector&lt;GUIGlID&gt;::const_iterator it = ids.begin(); it != ids.end(); it++) {
<a name="l00268"></a>00268         <a class="code" href="../../d2/d0d/_g_u_i_gl_object_8h.html#aa15d4f4ec475c9fc58b18070c08978b7">GUIGlID</a> <span class="keywordtype">id</span> = *it;
<a name="l00269"></a>00269         <a class="code" href="../../de/d94/class_g_u_i_gl_object.html">GUIGlObject</a>* o = <a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#acff5ff5c1e125024b12d7f73dff98e6f" title="A single static instance of this class.">GUIGlObjectStorage::gIDStorage</a>.<a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#ad828723bc0d92ad5666baa5406b8746b" title="Returns the object from the container locking it.">getObjectBlocking</a>(<span class="keywordtype">id</span>);
<a name="l00270"></a>00270         <span class="keywordflow">if</span> (o == 0) {
<a name="l00271"></a>00271             <span class="keywordflow">continue</span>;
<a name="l00272"></a>00272         }
<a name="l00273"></a>00273         <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../de/d94/class_g_u_i_gl_object.html#ac6cfa69398d352646e3d2228f7772a46" title="Returns the numerical id of the object.">getGlID</a>() == 0) {
<a name="l00274"></a>00274             <span class="keywordflow">continue</span>;
<a name="l00275"></a>00275         }
<a name="l00276"></a>00276         <span class="comment">//std::cout &lt;&lt; &quot;point selection hit &quot; &lt;&lt; o-&gt;getMicrosimID() &lt;&lt; &quot;\n&quot;;</span>
<a name="l00277"></a>00277         <a class="code" href="../../db/dcf/_g_u_i_gl_object_types_8h.html#af2b60d80f2ed12c3f597887aec83db5c">GUIGlObjectType</a> type = o-&gt;<a class="code" href="../../de/d94/class_g_u_i_gl_object.html#a4073d06ef1e61a3ed21ddc50ba5aa78e" title="Returns the type of the object as coded in GUIGlObjectType.">getType</a>();
<a name="l00278"></a>00278         <span class="keywordflow">if</span> (type != 0) {
<a name="l00279"></a>00279             <span class="keywordtype">int</span> clayer = (int) type;
<a name="l00280"></a>00280             <span class="comment">// determine an &quot;abstract&quot; layer for shapes</span>
<a name="l00281"></a>00281             <span class="comment">//  this &quot;layer&quot; resembles the layer of the shape</span>
<a name="l00282"></a>00282             <span class="comment">//  taking into account the stac of other objects</span>
<a name="l00283"></a>00283             <span class="keywordflow">if</span> (type == <a class="code" href="../../db/dcf/_g_u_i_gl_object_types_8h.html#af2b60d80f2ed12c3f597887aec83db5cac8530ee00a7340b761329e2f13421d27" title="a shape">GLO_SHAPE</a>) {
<a name="l00284"></a>00284                 <span class="keywordflow">if</span> (dynamic_cast&lt;GUIPolygon*&gt;(o) != 0) {
<a name="l00285"></a>00285                     <span class="keywordflow">if</span> (dynamic_cast&lt;GUIPolygon*&gt;(o)-&gt;getLayer() &gt; 0) {
<a name="l00286"></a>00286                         clayer = <a class="code" href="../../db/dcf/_g_u_i_gl_object_types_8h.html#af2b60d80f2ed12c3f597887aec83db5ca6543212809249afbaac5dfcce9e55942" title="empty max">GLO_MAX</a> + <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../da/d4d/class_g_u_i_polygon.html">GUIPolygon</a>*<span class="keyword">&gt;</span>(o)-&gt;getLayer();
<a name="l00287"></a>00287                     }
<a name="l00288"></a>00288                     <span class="keywordflow">if</span> (dynamic_cast&lt;GUIPolygon*&gt;(o)-&gt;getLayer() &lt; 0) {
<a name="l00289"></a>00289                         clayer = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../da/d4d/class_g_u_i_polygon.html">GUIPolygon</a>*<span class="keyword">&gt;</span>(o)-&gt;getLayer();
<a name="l00290"></a>00290                     }
<a name="l00291"></a>00291                 }
<a name="l00292"></a>00292                 <span class="keywordflow">if</span> (dynamic_cast&lt;GUIPointOfInterest*&gt;(o) != 0) {
<a name="l00293"></a>00293                     <span class="keywordflow">if</span> (dynamic_cast&lt;GUIPointOfInterest*&gt;(o)-&gt;getLayer() &gt; 0) {
<a name="l00294"></a>00294                         clayer = <a class="code" href="../../db/dcf/_g_u_i_gl_object_types_8h.html#af2b60d80f2ed12c3f597887aec83db5ca6543212809249afbaac5dfcce9e55942" title="empty max">GLO_MAX</a> + <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../dc/d32/class_g_u_i_point_of_interest.html">GUIPointOfInterest</a>*<span class="keyword">&gt;</span>(o)-&gt;getLayer();
<a name="l00295"></a>00295                     }
<a name="l00296"></a>00296                     <span class="keywordflow">if</span> (dynamic_cast&lt;GUIPointOfInterest*&gt;(o)-&gt;getLayer() &lt; 0) {
<a name="l00297"></a>00297                         clayer = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../dc/d32/class_g_u_i_point_of_interest.html">GUIPointOfInterest</a>*<span class="keyword">&gt;</span>(o)-&gt;getLayer();
<a name="l00298"></a>00298                     }
<a name="l00299"></a>00299                 }
<a name="l00300"></a>00300             }
<a name="l00301"></a>00301             <span class="comment">// check whether the current object is above a previous one</span>
<a name="l00302"></a>00302             <span class="keywordflow">if</span> (prevLayer == -1000 || prevLayer &lt; clayer) {
<a name="l00303"></a>00303                 idMax = id;
<a name="l00304"></a>00304                 prevLayer = clayer;
<a name="l00305"></a>00305             }
<a name="l00306"></a>00306         }
<a name="l00307"></a>00307         <a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#acff5ff5c1e125024b12d7f73dff98e6f" title="A single static instance of this class.">GUIGlObjectStorage::gIDStorage</a>.<a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#a6cf14a4d71afc57c126b914be49801a1" title="Marks an object as unblocked.">unblockObject</a>(<span class="keywordtype">id</span>);
<a name="l00308"></a>00308     }
<a name="l00309"></a>00309     <span class="keywordflow">return</span> idMax;
<a name="l00310"></a>00310 }
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 
<a name="l00313"></a>00313 std::vector&lt;GUIGlID&gt;
<a name="l00314"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aceda8f86812527348dcbf01d05284939">00314</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aceda8f86812527348dcbf01d05284939" title="returns the ids of all objects in the given boundary">GUISUMOAbstractView::getObjectsInBoundary</a>(<span class="keyword">const</span> <a class="code" href="../../d5/dda/class_boundary.html" title="A class that stores a 2D geometrical boundary.">Boundary</a>&amp; bound) {
<a name="l00315"></a>00315     <span class="keyword">const</span> <span class="keywordtype">int</span> NB_HITS_MAX = 1024 * 1024;
<a name="l00316"></a>00316     <span class="comment">// Prepare the selection mode</span>
<a name="l00317"></a>00317     <span class="keyword">static</span> <a class="code" href="../../d2/d0d/_g_u_i_gl_object_8h.html#aa15d4f4ec475c9fc58b18070c08978b7">GUIGlID</a> hits[NB_HITS_MAX];
<a name="l00318"></a>00318     <span class="keyword">static</span> GLint nb_hits = 0;
<a name="l00319"></a>00319     glSelectBuffer(NB_HITS_MAX, hits);
<a name="l00320"></a>00320     glInitNames();
<a name="l00321"></a>00321 
<a name="l00322"></a>00322     <a class="code" href="../../d5/dda/class_boundary.html" title="A class that stores a 2D geometrical boundary.">Boundary</a> oldViewPort = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aea56ecc20db34c280f8f6fc2f2030bd4">getViewport</a>(<span class="keyword">false</span>); <span class="comment">// backup the actual viewPort</span>
<a name="l00323"></a>00323     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a87e5b65eaad33258cc5cbe408b6030e0" title="Sets the viewport Used for: Adapting a new viewport.">setViewport</a>(bound);
<a name="l00324"></a>00324     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a828f29525f64e0388c850e14f7b360d8">applyGLTransform</a>(<span class="keyword">false</span>);
<a name="l00325"></a>00325 
<a name="l00326"></a>00326     <span class="comment">// paint in select mode</span>
<a name="l00327"></a>00327     <span class="keywordtype">int</span> hits2 = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ae7ab139acb8e03f17cbb88b6ec83cacf">doPaintGL</a>(GL_SELECT, bound);
<a name="l00328"></a>00328     <span class="comment">// Get the results</span>
<a name="l00329"></a>00329     nb_hits = glRenderMode(GL_RENDER);
<a name="l00330"></a>00330     <span class="keywordflow">if</span> (nb_hits == -1) {
<a name="l00331"></a>00331         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a588bcd9c748b69b7e833c3845773cd72" title="The application.">myApp</a>-&gt;<a class="code" href="../../db/dba/class_g_u_i_main_window.html#a938d2e9b5153daa1cbba27d3a655ee80">setStatusBarText</a>(<span class="stringliteral">&quot;Selection in boundary failed. Try to select fewer than &quot;</span> + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(hits2) + <span class="stringliteral">&quot; items&quot;</span>);
<a name="l00332"></a>00332     }
<a name="l00333"></a>00333     std::vector&lt;GUIGlID&gt; result;
<a name="l00334"></a>00334     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_hits; ++i) {
<a name="l00335"></a>00335         assert(i * 4 + 3 &lt; NB_HITS_MAX);
<a name="l00336"></a>00336         result.push_back(hits[i * 4 + 3]);
<a name="l00337"></a>00337     }
<a name="l00338"></a>00338     <span class="comment">// switch viewport back to normal</span>
<a name="l00339"></a>00339     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a87e5b65eaad33258cc5cbe408b6030e0" title="Sets the viewport Used for: Adapting a new viewport.">setViewport</a>(oldViewPort);
<a name="l00340"></a>00340     <span class="keywordflow">return</span> result;
<a name="l00341"></a>00341 }
<a name="l00342"></a>00342 
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 <span class="keywordtype">void</span>
<a name="l00345"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a71b9d7aab3c8ed1e0d4f21f63d41ce17">00345</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a71b9d7aab3c8ed1e0d4f21f63d41ce17" title="invokes the tooltip for the given object">GUISUMOAbstractView::showToolTipFor</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span>) {
<a name="l00346"></a>00346     <span class="keywordflow">if</span> (<span class="keywordtype">id</span> != 0) {
<a name="l00347"></a>00347         <a class="code" href="../../de/d94/class_g_u_i_gl_object.html">GUIGlObject</a>* <span class="keywordtype">object</span> = <a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#acff5ff5c1e125024b12d7f73dff98e6f" title="A single static instance of this class.">GUIGlObjectStorage::gIDStorage</a>.<a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#ad828723bc0d92ad5666baa5406b8746b" title="Returns the object from the container locking it.">getObjectBlocking</a>(<span class="keywordtype">id</span>);
<a name="l00348"></a>00348         <span class="keywordflow">if</span> (<span class="keywordtype">object</span> != 0) {
<a name="l00349"></a>00349             <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a> pos = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa293e9cefde49e0d39f7717f2c76a59d" title="Returns the cursor&amp;#39;s x/y position within the network.">getPositionInformation</a>();
<a name="l00350"></a>00350             pos.<a class="code" href="../../d7/d3b/class_position.html#aa7f28af16b3c5e4396560db99d746389" title="Adds the given position to this one.">add</a>(0, <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a21e738d9bfee910dd77b1799e71d6789" title="pixels-to-meters conversion method">p2m</a>(15));
<a name="l00351"></a>00351             <a class="code" href="../../d3/d96/class_g_l_helper.html#a2c758685b5c431878eb93f90b0faff52" title="draw Text box with given parameters">GLHelper::drawTextBox</a>(object-&gt;<a class="code" href="../../de/d94/class_g_u_i_gl_object.html#ae75896959c2e11a0afec2b9dcb092f21" title="Returns the full name appearing in the tool tip.">getFullName</a>(), pos, <a class="code" href="../../db/dcf/_g_u_i_gl_object_types_8h.html#af2b60d80f2ed12c3f597887aec83db5ca6543212809249afbaac5dfcce9e55942" title="empty max">GLO_MAX</a> - 1, <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a21e738d9bfee910dd77b1799e71d6789" title="pixels-to-meters conversion method">p2m</a>(20), <a class="code" href="../../da/da9/class_r_g_b_color.html">RGBColor</a>(0, 0, 0), <a class="code" href="../../da/da9/class_r_g_b_color.html">RGBColor</a>(1, 0.7, 0));
<a name="l00352"></a>00352             <a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#acff5ff5c1e125024b12d7f73dff98e6f" title="A single static instance of this class.">GUIGlObjectStorage::gIDStorage</a>.<a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#a6cf14a4d71afc57c126b914be49801a1" title="Marks an object as unblocked.">unblockObject</a>(<span class="keywordtype">id</span>);
<a name="l00353"></a>00353         }
<a name="l00354"></a>00354     }
<a name="l00355"></a>00355 }
<a name="l00356"></a>00356 
<a name="l00357"></a>00357 
<a name="l00358"></a>00358 <span class="keywordtype">void</span>
<a name="l00359"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a039c738d88d3e307c1095a965513cfd9">00359</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a039c738d88d3e307c1095a965513cfd9" title="paints a grid">GUISUMOAbstractView::paintGLGrid</a>() {
<a name="l00360"></a>00360     glEnable(GL_DEPTH_TEST);
<a name="l00361"></a>00361     glLineWidth(1);
<a name="l00362"></a>00362 
<a name="l00363"></a>00363     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> xmin = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a67bf9f4bdc680c11dd1827a3852f6bea" title="The visualization speed-up.">myGrid</a>-&gt;<a class="code" href="../../d5/dda/class_boundary.html#a68c581ea01becd3954fcc808ac476040" title="Returns minimum x-coordinate.">xmin</a>();
<a name="l00364"></a>00364     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> ymin = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a67bf9f4bdc680c11dd1827a3852f6bea" title="The visualization speed-up.">myGrid</a>-&gt;<a class="code" href="../../d5/dda/class_boundary.html#a23f3304d1d057aec6a5255f519cc567d" title="Returns minimum y-coordinate.">ymin</a>();
<a name="l00365"></a>00365     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> ypos = ymin;
<a name="l00366"></a>00366     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> xpos = xmin;
<a name="l00367"></a>00367     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> xend = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a67bf9f4bdc680c11dd1827a3852f6bea" title="The visualization speed-up.">myGrid</a>-&gt;<a class="code" href="../../d5/dda/class_boundary.html#ace0f25069b6d972da95a747136261fcd" title="Returns maximum x-coordinate.">xmax</a>();
<a name="l00368"></a>00368     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> yend = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a67bf9f4bdc680c11dd1827a3852f6bea" title="The visualization speed-up.">myGrid</a>-&gt;<a class="code" href="../../d5/dda/class_boundary.html#ab908d8e6c0fc8abdee797e789176a43e" title="Returns maximum y-coordinate.">ymax</a>();
<a name="l00369"></a>00369 
<a name="l00370"></a>00370     glTranslated(0, 0, .55);
<a name="l00371"></a>00371     glColor3d(0.5, 0.5, 0.5);
<a name="l00372"></a>00372     <span class="comment">// draw horizontal lines</span>
<a name="l00373"></a>00373     glBegin(GL_LINES);
<a name="l00374"></a>00374     <span class="keywordflow">for</span> (; ypos &lt; yend;) {
<a name="l00375"></a>00375         glVertex2d(xmin, ypos);
<a name="l00376"></a>00376         glVertex2d(xend, ypos);
<a name="l00377"></a>00377         ypos += <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a6b024919b4fc1e5c649f8a2a7f123477">gridYSize</a>;
<a name="l00378"></a>00378     }
<a name="l00379"></a>00379     <span class="comment">// draw vertical lines</span>
<a name="l00380"></a>00380     <span class="keywordflow">for</span> (; xpos &lt; xend;) {
<a name="l00381"></a>00381         glVertex2d(xpos, ymin);
<a name="l00382"></a>00382         glVertex2d(xpos, yend);
<a name="l00383"></a>00383         xpos += <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a527fe7f101bb7b3d827c3a3a4e85f240" title="Information about the grid spacings.">gridXSize</a>;
<a name="l00384"></a>00384     }
<a name="l00385"></a>00385     glEnd();
<a name="l00386"></a>00386     glTranslated(0, 0, -.55);
<a name="l00387"></a>00387 }
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 
<a name="l00390"></a>00390 <span class="keywordtype">void</span>
<a name="l00391"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a13886c169edc2f1c1fe19749f8d9ea82">00391</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a13886c169edc2f1c1fe19749f8d9ea82">GUISUMOAbstractView::displayLegend</a>() {
<a name="l00392"></a>00392     <span class="comment">// compute the scale bar length</span>
<a name="l00393"></a>00393     <span class="keywordtype">size_t</span> length = 1;
<a name="l00394"></a>00394     <span class="keyword">const</span> std::string text(<span class="stringliteral">&quot;10000000000&quot;</span>);
<a name="l00395"></a>00395     <span class="keywordtype">size_t</span> noDigits = 1;
<a name="l00396"></a>00396     <span class="keywordtype">size_t</span> pixelSize = 0;
<a name="l00397"></a>00397     <span class="keywordflow">while</span> (<span class="keyword">true</span>) {
<a name="l00398"></a>00398         pixelSize = (size_t) <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a71c204d7b282a54cf7bad2ce0b77f7d2" title="meter-to-pixels conversion method">m2p</a>((<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>) length);
<a name="l00399"></a>00399         <span class="keywordflow">if</span> (pixelSize &gt; 20) {
<a name="l00400"></a>00400             <span class="keywordflow">break</span>;
<a name="l00401"></a>00401         }
<a name="l00402"></a>00402         length *= 10;
<a name="l00403"></a>00403         noDigits++;
<a name="l00404"></a>00404         <span class="keywordflow">if</span> (noDigits &gt; text.length()) {
<a name="l00405"></a>00405             <span class="keywordflow">return</span>;
<a name="l00406"></a>00406         }
<a name="l00407"></a>00407     }
<a name="l00408"></a>00408     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> lineWidth = 1.0;
<a name="l00409"></a>00409     glLineWidth((<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>) lineWidth);
<a name="l00410"></a>00410 
<a name="l00411"></a>00411     glMatrixMode(GL_PROJECTION);
<a name="l00412"></a>00412     glPushMatrix();
<a name="l00413"></a>00413     glLoadIdentity();
<a name="l00414"></a>00414     glMatrixMode(GL_MODELVIEW);
<a name="l00415"></a>00415     glPushMatrix();
<a name="l00416"></a>00416     glLoadIdentity();
<a name="l00417"></a>00417 
<a name="l00418"></a>00418     <span class="comment">// draw the scale bar</span>
<a name="l00419"></a>00419     glDisable(GL_TEXTURE_2D);
<a name="l00420"></a>00420     glDisable(GL_ALPHA_TEST);
<a name="l00421"></a>00421     glDisable(GL_BLEND);
<a name="l00422"></a>00422     glEnable(GL_DEPTH_TEST);
<a name="l00423"></a>00423 
<a name="l00424"></a>00424     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> len = (<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>) pixelSize / (<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>)(getWidth() - 1) * (<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>) 2.0;
<a name="l00425"></a>00425     glColor3d(0, 0, 0);
<a name="l00426"></a>00426     <span class="keywordtype">double</span> o = double(15) / double(getHeight());
<a name="l00427"></a>00427     <span class="keywordtype">double</span> o2 = o + o;
<a name="l00428"></a>00428     <span class="keywordtype">double</span> oo = double(5) / double(getHeight());
<a name="l00429"></a>00429     glBegin(GL_LINES);
<a name="l00430"></a>00430     <span class="comment">// vertical</span>
<a name="l00431"></a>00431     glVertex2d(-.98, -1. + o);
<a name="l00432"></a>00432     glVertex2d(-.98 + len, -1. + o);
<a name="l00433"></a>00433     <span class="comment">// tick at begin</span>
<a name="l00434"></a>00434     glVertex2d(-.98, -1. + o);
<a name="l00435"></a>00435     glVertex2d(-.98, -1. + o2);
<a name="l00436"></a>00436     <span class="comment">// tick at end</span>
<a name="l00437"></a>00437     glVertex2d(-.98 + len, -1. + o);
<a name="l00438"></a>00438     glVertex2d(-.98 + len, -1. + o2);
<a name="l00439"></a>00439     glEnd();
<a name="l00440"></a>00440 
<a name="l00441"></a>00441     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> w = <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>(35) / <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>(getWidth());
<a name="l00442"></a>00442     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> h = <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>(35) / <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>(getHeight());
<a name="l00443"></a>00443     <a class="code" href="../../d1/dc9/polyfonts_8c.html#a0f7ffd06399088492fc70d2b2fb91380">pfSetPosition</a>(<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>(-0.99), <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>(1. - o2 - oo));
<a name="l00444"></a>00444     <a class="code" href="../../d1/dc9/polyfonts_8c.html#a1a1008f17d6ee730dde943acf2095d59">pfSetScaleXY</a>(w, h);
<a name="l00445"></a>00445     glRotated(180, 1, 0, 0);
<a name="l00446"></a>00446     <a class="code" href="../../d1/dc9/polyfonts_8c.html#a38a52d85cf35f2c496ab71fac8cd8631">pfDrawString</a>(<span class="stringliteral">&quot;0m&quot;</span>);
<a name="l00447"></a>00447     glRotated(-180, 1, 0, 0);
<a name="l00448"></a>00448 
<a name="l00449"></a>00449     <a class="code" href="../../d1/dc9/polyfonts_8c.html#a0f7ffd06399088492fc70d2b2fb91380">pfSetPosition</a>(<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>(-.99 + len), <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>(1. - o2 - oo));
<a name="l00450"></a>00450     glRotated(180, 1, 0, 0);
<a name="l00451"></a>00451     <a class="code" href="../../d1/dc9/polyfonts_8c.html#a38a52d85cf35f2c496ab71fac8cd8631">pfDrawString</a>((text.substr(0, noDigits) + <span class="stringliteral">&quot;m&quot;</span>).c_str());
<a name="l00452"></a>00452     glRotated(-180, 1, 0, 0);
<a name="l00453"></a>00453 
<a name="l00454"></a>00454     <span class="comment">// restore matrices</span>
<a name="l00455"></a>00455     glMatrixMode(GL_PROJECTION);
<a name="l00456"></a>00456     glPopMatrix();
<a name="l00457"></a>00457     glMatrixMode(GL_MODELVIEW);
<a name="l00458"></a>00458     glPopMatrix();
<a name="l00459"></a>00459 }
<a name="l00460"></a>00460 
<a name="l00461"></a>00461 
<a name="l00462"></a>00462 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>
<a name="l00463"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a71c204d7b282a54cf7bad2ce0b77f7d2">00463</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a71c204d7b282a54cf7bad2ce0b77f7d2" title="meter-to-pixels conversion method">GUISUMOAbstractView::m2p</a>(<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> meter)<span class="keyword"> const </span>{
<a name="l00464"></a>00464     <span class="keywordflow">return</span>  meter * getWidth() / <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aea56ecc20db34c280f8f6fc2f2030bd4">getViewport</a>().<a class="code" href="../../d5/dda/class_boundary.html#a32ae1fd6f35bbd871344abdaef966c7b" title="Returns the width of the boudary.">getWidth</a>();
<a name="l00465"></a>00465 }
<a name="l00466"></a>00466 
<a name="l00467"></a>00467 
<a name="l00468"></a>00468 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>
<a name="l00469"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a21e738d9bfee910dd77b1799e71d6789">00469</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a21e738d9bfee910dd77b1799e71d6789" title="pixels-to-meters conversion method">GUISUMOAbstractView::p2m</a>(<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> pixel)<span class="keyword"> const </span>{
<a name="l00470"></a>00470     <span class="keywordflow">return</span> pixel * <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aea56ecc20db34c280f8f6fc2f2030bd4">getViewport</a>().<a class="code" href="../../d5/dda/class_boundary.html#a32ae1fd6f35bbd871344abdaef966c7b" title="Returns the width of the boudary.">getWidth</a>() / getWidth();
<a name="l00471"></a>00471 }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 
<a name="l00474"></a>00474 <span class="keywordtype">void</span>
<a name="l00475"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a234477798912a3e863690945afe23d4c">00475</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a234477798912a3e863690945afe23d4c" title="recenters the view">GUISUMOAbstractView::recenterView</a>() {
<a name="l00476"></a>00476     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a87e5b65eaad33258cc5cbe408b6030e0" title="Sets the viewport Used for: Adapting a new viewport.">setViewport</a>(*<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a67bf9f4bdc680c11dd1827a3852f6bea" title="The visualization speed-up.">myGrid</a>);
<a name="l00477"></a>00477 }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 <span class="keywordtype">void</span>
<a name="l00481"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a89f07a97c8886dcaed14eb4863b234d2">00481</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a89f07a97c8886dcaed14eb4863b234d2" title="centers to the chosen artifact">GUISUMOAbstractView::centerTo</a>(<a class="code" href="../../d2/d0d/_g_u_i_gl_object_8h.html#aa15d4f4ec475c9fc58b18070c08978b7">GUIGlID</a> <span class="keywordtype">id</span>, <span class="keywordtype">bool</span> applyZoom, <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> zoomDist) {
<a name="l00482"></a>00482     <a class="code" href="../../de/d94/class_g_u_i_gl_object.html">GUIGlObject</a>* o = <a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#acff5ff5c1e125024b12d7f73dff98e6f" title="A single static instance of this class.">GUIGlObjectStorage::gIDStorage</a>.<a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#ad828723bc0d92ad5666baa5406b8746b" title="Returns the object from the container locking it.">getObjectBlocking</a>(<span class="keywordtype">id</span>);
<a name="l00483"></a>00483     <span class="keywordflow">if</span> (o != 0 &amp;&amp; dynamic_cast&lt;GUIGlObject*&gt;(o) != 0) {
<a name="l00484"></a>00484         <span class="keywordflow">if</span> (applyZoom &amp;&amp; zoomDist &lt; 0) {
<a name="l00485"></a>00485             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a87e5b65eaad33258cc5cbe408b6030e0" title="Sets the viewport Used for: Adapting a new viewport.">setViewport</a>(o-&gt;<a class="code" href="../../de/d94/class_g_u_i_gl_object.html#a63db351296e8ab9a7dff09a41498df0f" title="Returns the boundary to which the view shall be centered in order to show the object...">getCenteringBoundary</a>());
<a name="l00486"></a>00486         } <span class="keywordflow">else</span> {
<a name="l00487"></a>00487             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a17956d392bf6ff01d9616b0e66778050" title="Centers the view to the given position, setting it to a size that covers the radius...">centerTo</a>(o-&gt;<a class="code" href="../../de/d94/class_g_u_i_gl_object.html#a63db351296e8ab9a7dff09a41498df0f" title="Returns the boundary to which the view shall be centered in order to show the object...">getCenteringBoundary</a>().<a class="code" href="../../d5/dda/class_boundary.html#a9bccb479e81d92dc55cc98e2ae655ad4" title="Returns the center of the boundary.">getCenter</a>(), zoomDist, applyZoom);
<a name="l00488"></a>00488         }
<a name="l00489"></a>00489     }
<a name="l00490"></a>00490     <a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#acff5ff5c1e125024b12d7f73dff98e6f" title="A single static instance of this class.">GUIGlObjectStorage::gIDStorage</a>.<a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#a6cf14a4d71afc57c126b914be49801a1" title="Marks an object as unblocked.">unblockObject</a>(<span class="keywordtype">id</span>);
<a name="l00491"></a>00491 }
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 
<a name="l00494"></a>00494 <span class="keywordtype">void</span>
<a name="l00495"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a0ad0fb0fda72ebfaabb1cc68ab844c0b">00495</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a89f07a97c8886dcaed14eb4863b234d2" title="centers to the chosen artifact">GUISUMOAbstractView::centerTo</a>(<span class="keyword">const</span> <a class="code" href="../../d5/dda/class_boundary.html" title="A class that stores a 2D geometrical boundary.">Boundary</a>&amp; bound) {
<a name="l00496"></a>00496     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a87e5b65eaad33258cc5cbe408b6030e0" title="Sets the viewport Used for: Adapting a new viewport.">setViewport</a>(bound);
<a name="l00497"></a>00497     update();
<a name="l00498"></a>00498 }
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 <span class="comment">/*</span>
<a name="l00501"></a>00501 <span class="comment">bool</span>
<a name="l00502"></a>00502 <span class="comment">GUISUMOAbstractView::allowRotation() const</span>
<a name="l00503"></a>00503 <span class="comment">{</span>
<a name="l00504"></a>00504 <span class="comment">    return myParent-&gt;allowRotation();</span>
<a name="l00505"></a>00505 <span class="comment">}</span>
<a name="l00506"></a>00506 <span class="comment">*/</span>
<a name="l00507"></a>00507 
<a name="l00508"></a>00508 <span class="keywordtype">void</span>
<a name="l00509"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa9bbaa30e0318e69ccfd329fb9dc1eb0">00509</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa9bbaa30e0318e69ccfd329fb9dc1eb0" title="Returns the information whether rotation is allowd.">GUISUMOAbstractView::setWindowCursorPosition</a>(FXint x, FXint y) {
<a name="l00510"></a>00510     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acd8717d3758abe31fffb6e100c85240f" title="Position of the cursor relative to the window.">myWindowCursorPositionX</a> = x + <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a2cf0835307dab7ef7bc0a0d22d4a1b99" title="Offset to the mouse-hotspot from the mouse position.">myMouseHotspotX</a>;
<a name="l00511"></a>00511     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a420ee369e65186316af3742e94a23a6a">myWindowCursorPositionY</a> = y + <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a8f25669fc742f6904d7fb06dd50df25a">myMouseHotspotY</a>;
<a name="l00512"></a>00512 }
<a name="l00513"></a>00513 
<a name="l00514"></a>00514 
<a name="l00515"></a>00515 FXbool
<a name="l00516"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a2a256b06a0fd18e31a419c1272018c48">00516</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a2a256b06a0fd18e31a419c1272018c48" title="A reimplementation due to some internal reasons.">GUISUMOAbstractView::makeCurrent</a>() {
<a name="l00517"></a>00517     FXbool ret = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a2a256b06a0fd18e31a419c1272018c48" title="A reimplementation due to some internal reasons.">FXGLCanvas::makeCurrent</a>();
<a name="l00518"></a>00518     <span class="keywordflow">return</span> ret;
<a name="l00519"></a>00519 }
<a name="l00520"></a>00520 
<a name="l00521"></a>00521 
<a name="l00522"></a>00522 <span class="keywordtype">long</span>
<a name="l00523"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aec8c9e1b56f3d0cc0ee6df12ad207991">00523</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aec8c9e1b56f3d0cc0ee6df12ad207991">GUISUMOAbstractView::onConfigure</a>(<a class="code" href="../../d1/d63/class_f_x_object.html">FXObject</a>*, FXSelector, <span class="keywordtype">void</span>*) {
<a name="l00524"></a>00524     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a2a256b06a0fd18e31a419c1272018c48" title="A reimplementation due to some internal reasons.">makeCurrent</a>()) {
<a name="l00525"></a>00525         glViewport(0, 0, getWidth() - 1, getHeight() - 1);
<a name="l00526"></a>00526         glClearColor(
<a name="l00527"></a>00527             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a0a59d560b5b75c48e2b51734c040d3e1" title="The background color to use.">backgroundColor</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#af3739c0c10661723552770c0996ad7c2" title="Returns the red-amount of the color.">red</a>(),
<a name="l00528"></a>00528             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a0a59d560b5b75c48e2b51734c040d3e1" title="The background color to use.">backgroundColor</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#aecf0743143198bec2a7cc68fb4e9ad2e" title="Returns the green-amount of the color.">green</a>(),
<a name="l00529"></a>00529             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a0a59d560b5b75c48e2b51734c040d3e1" title="The background color to use.">backgroundColor</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#a797a5810e1de8c10b313809e4bdb5780" title="Returns the blue-amount of the color.">blue</a>(),
<a name="l00530"></a>00530             1);
<a name="l00531"></a>00531         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aaea84d586dde1f86dba61dd2f2cd271f">doInit</a>();
<a name="l00532"></a>00532         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a059d51c72fd48c693923759a20ea47a6" title="Internal information whether doInit() was called.">myAmInitialised</a> = <span class="keyword">true</span>;
<a name="l00533"></a>00533         makeNonCurrent();
<a name="l00534"></a>00534         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a0b871244d08f8bc8edf100a26edca845" title="Checks whether it is time for a snapshot.">checkSnapshots</a>();
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536     <span class="keywordflow">return</span> 1;
<a name="l00537"></a>00537 }
<a name="l00538"></a>00538 
<a name="l00539"></a>00539 
<a name="l00540"></a>00540 <span class="keywordtype">long</span>
<a name="l00541"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ae7c3144b5620bb618ec41675b0157472">00541</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ae7c3144b5620bb618ec41675b0157472">GUISUMOAbstractView::onPaint</a>(<a class="code" href="../../d1/d63/class_f_x_object.html">FXObject</a>*, FXSelector, <span class="keywordtype">void</span>*) {
<a name="l00542"></a>00542     <span class="keywordflow">if</span> (!isEnabled() || !<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a059d51c72fd48c693923759a20ea47a6" title="Internal information whether doInit() was called.">myAmInitialised</a>) {
<a name="l00543"></a>00543         <span class="keywordflow">return</span> 1;
<a name="l00544"></a>00544     }
<a name="l00545"></a>00545     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a2a256b06a0fd18e31a419c1272018c48" title="A reimplementation due to some internal reasons.">makeCurrent</a>()) {
<a name="l00546"></a>00546         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a93e39d156d69f4eb0069449afc6334f3" title="performs the painting of the simulation">paintGL</a>();
<a name="l00547"></a>00547         makeNonCurrent();
<a name="l00548"></a>00548     }
<a name="l00549"></a>00549     <span class="keywordflow">return</span> 1;
<a name="l00550"></a>00550 }
<a name="l00551"></a>00551 
<a name="l00552"></a>00552 
<a name="l00553"></a>00553 <span class="keywordtype">void</span>
<a name="l00554"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a896a2f2b8cc8f0e8a5b48406c9795cf6">00554</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a896a2f2b8cc8f0e8a5b48406c9795cf6" title="destoys the popup">GUISUMOAbstractView::destroyPopup</a>() {
<a name="l00555"></a>00555     <span class="keyword">delete</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ad0751a829130381a7b30d4dee389b963" title="The current popup-menu.">myPopup</a>;
<a name="l00556"></a>00556     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ad0751a829130381a7b30d4dee389b963" title="The current popup-menu.">myPopup</a> = 0;
<a name="l00557"></a>00557 }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559 
<a name="l00560"></a>00560 <span class="keywordtype">long</span>
<a name="l00561"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7445fb45765be747e83b71193e11e8c5">00561</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7445fb45765be747e83b71193e11e8c5">GUISUMOAbstractView::onLeftBtnPress</a>(<a class="code" href="../../d1/d63/class_f_x_object.html">FXObject</a>*, FXSelector , <span class="keywordtype">void</span>* data) {
<a name="l00562"></a>00562     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a896a2f2b8cc8f0e8a5b48406c9795cf6" title="destoys the popup">destroyPopup</a>();
<a name="l00563"></a>00563     FXEvent* e = (FXEvent*) data;
<a name="l00564"></a>00564     <span class="comment">// check whether the selection-mode is activated</span>
<a name="l00565"></a>00565     <span class="keywordflow">if</span> (e-&gt;state &amp; CONTROLMASK) {
<a name="l00566"></a>00566         <span class="comment">// try to get the object-id if so</span>
<a name="l00567"></a>00567         <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a2a256b06a0fd18e31a419c1272018c48" title="A reimplementation due to some internal reasons.">makeCurrent</a>()) {
<a name="l00568"></a>00568             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a529d99f53f098e10a7d9b527f34c11f6" title="returns the id of the object under the cursor using GL_SELECT">getObjectUnderCursor</a>();
<a name="l00569"></a>00569             <span class="keywordflow">if</span> (<span class="keywordtype">id</span> != 0) {
<a name="l00570"></a>00570                 <a class="code" href="../../de/dd7/_g_u_i_global_selection_8cpp.html#a2726a253c94700d65ae60acdf38a4f29" title="A global holder of selected objects.">gSelected</a>.<a class="code" href="../../d1/dae/class_g_u_i_selected_storage.html#a4dd2463342d7c9b3385462b3980f98af" title="Toggles selection of an object.">toggleSelection</a>(<span class="keywordtype">id</span>);
<a name="l00571"></a>00571             }
<a name="l00572"></a>00572             makeNonCurrent();
<a name="l00573"></a>00573             <span class="keywordflow">if</span> (<span class="keywordtype">id</span> != 0) {
<a name="l00574"></a>00574                 <span class="comment">// possibly, the selection-colouring is used,</span>
<a name="l00575"></a>00575                 <span class="comment">//  so we should update the screen again...</span>
<a name="l00576"></a>00576                 update();
<a name="l00577"></a>00577             }
<a name="l00578"></a>00578         }
<a name="l00579"></a>00579     }
<a name="l00580"></a>00580     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a592150ee909652f9db4a052adbb562a7">onLeftBtnPress</a>(data);
<a name="l00581"></a>00581     grab();
<a name="l00582"></a>00582     <span class="keywordflow">return</span> 1;
<a name="l00583"></a>00583 }
<a name="l00584"></a>00584 
<a name="l00585"></a>00585 
<a name="l00586"></a>00586 <span class="keywordtype">long</span>
<a name="l00587"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a107c47d8a185e87fc332c6b7cb8034c0">00587</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a107c47d8a185e87fc332c6b7cb8034c0">GUISUMOAbstractView::onLeftBtnRelease</a>(<a class="code" href="../../d1/d63/class_f_x_object.html">FXObject</a>*, FXSelector , <span class="keywordtype">void</span>* data) {
<a name="l00588"></a>00588     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a896a2f2b8cc8f0e8a5b48406c9795cf6" title="destoys the popup">destroyPopup</a>();
<a name="l00589"></a>00589     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a4002c8e33690cc25c95e682b4429a4be">onLeftBtnRelease</a>(data);
<a name="l00590"></a>00590     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a588bcd9c748b69b7e833c3845773cd72" title="The application.">myApp</a>-&gt;<a class="code" href="../../db/dba/class_g_u_i_main_window.html#afeaa605ad22939a02b85da9ebfe494c9" title="return whether the gui is in gaming mode">isGaming</a>()) {
<a name="l00591"></a>00591         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a4298f7ddc94d3c8571998979b1f6f0f8">onGamingClick</a>(<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa293e9cefde49e0d39f7717f2c76a59d" title="Returns the cursor&amp;#39;s x/y position within the network.">getPositionInformation</a>());
<a name="l00592"></a>00592     }
<a name="l00593"></a>00593     ungrab();
<a name="l00594"></a>00594     <span class="keywordflow">return</span> 1;
<a name="l00595"></a>00595 }
<a name="l00596"></a>00596 
<a name="l00597"></a>00597 
<a name="l00598"></a>00598 <span class="keywordtype">long</span>
<a name="l00599"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aebb70809c06a0188914cc99119bc32bf">00599</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aebb70809c06a0188914cc99119bc32bf">GUISUMOAbstractView::onRightBtnPress</a>(<a class="code" href="../../d1/d63/class_f_x_object.html">FXObject</a>*, FXSelector , <span class="keywordtype">void</span>* data) {
<a name="l00600"></a>00600     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a896a2f2b8cc8f0e8a5b48406c9795cf6" title="destoys the popup">destroyPopup</a>();
<a name="l00601"></a>00601     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a30798ea3e33a035f8281ca53cf393af3">onRightBtnPress</a>(data);
<a name="l00602"></a>00602     grab();
<a name="l00603"></a>00603     <span class="keywordflow">return</span> 1;
<a name="l00604"></a>00604 }
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 
<a name="l00607"></a>00607 <span class="keywordtype">long</span>
<a name="l00608"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acd047ff57014d03830d883b9f588ab14">00608</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acd047ff57014d03830d883b9f588ab14">GUISUMOAbstractView::onRightBtnRelease</a>(<a class="code" href="../../d1/d63/class_f_x_object.html">FXObject</a>*, FXSelector , <span class="keywordtype">void</span>* data) {
<a name="l00609"></a>00609     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a896a2f2b8cc8f0e8a5b48406c9795cf6" title="destoys the popup">destroyPopup</a>();
<a name="l00610"></a>00610     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#ae56a2138c7167006f524ec686b562c92">onRightBtnRelease</a>(data) &amp;&amp; !<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a588bcd9c748b69b7e833c3845773cd72" title="The application.">myApp</a>-&gt;<a class="code" href="../../db/dba/class_g_u_i_main_window.html#afeaa605ad22939a02b85da9ebfe494c9" title="return whether the gui is in gaming mode">isGaming</a>()) {
<a name="l00611"></a>00611         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a562d1b6d4334b69f2501541ff51dea40">openObjectDialog</a>();
<a name="l00612"></a>00612     }
<a name="l00613"></a>00613     ungrab();
<a name="l00614"></a>00614     <span class="keywordflow">return</span> 1;
<a name="l00615"></a>00615 }
<a name="l00616"></a>00616 
<a name="l00617"></a>00617 
<a name="l00618"></a>00618 <span class="keywordtype">long</span>
<a name="l00619"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a67438f707600800b4f32daf99f8c6977">00619</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a67438f707600800b4f32daf99f8c6977">GUISUMOAbstractView::onMouseWheel</a>(<a class="code" href="../../d1/d63/class_f_x_object.html">FXObject</a>*, FXSelector , <span class="keywordtype">void</span>* data) {
<a name="l00620"></a>00620     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#adef5b9adf4230d9832682ed0b6ca12c3">onMouseWheel</a>(data);
<a name="l00621"></a>00621     <span class="keywordflow">return</span> 1;
<a name="l00622"></a>00622 }
<a name="l00623"></a>00623 
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 <span class="keywordtype">long</span>
<a name="l00626"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a3846430cbdb72e1c2ce70880604995c8">00626</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a3846430cbdb72e1c2ce70880604995c8">GUISUMOAbstractView::onMouseMove</a>(<a class="code" href="../../d1/d63/class_f_x_object.html">FXObject</a>*, FXSelector , <span class="keywordtype">void</span>* data) {
<a name="l00627"></a>00627     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> xpos = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a62baa29ee8d9e12cde85b816ce34f85e" title="Returns the x-offset of the field to show stored in this changer.">getXPos</a>();
<a name="l00628"></a>00628     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> ypos = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a6df84b97f6dd25f4ff750ed91c6b1aba" title="Returns the y-offset of the field to show stored in this changer.">getYPos</a>();
<a name="l00629"></a>00629     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> zoom = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aae37ebcfff45a2726cf3d65c6a8a33d5" title="Returns the zoom factor computed stored in this changer.">getZoom</a>();
<a name="l00630"></a>00630     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a39df8523319abe783f14715389b77374">myViewportChooser</a> == 0 || !<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a39df8523319abe783f14715389b77374">myViewportChooser</a>-&gt;<a class="code" href="../../d3/d3d/class_g_u_i_dialog___edit_viewport.html#a40876b177cf7ce2f728d2b13141b72f8" title="Returns the information whether one of the spin dialers is grabbed.">haveGrabbed</a>()) {
<a name="l00631"></a>00631         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#acce5c48a9721184932a23cc4f365efb7">onMouseMove</a>(data);
<a name="l00632"></a>00632     }
<a name="l00633"></a>00633     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a39df8523319abe783f14715389b77374">myViewportChooser</a> != 0 &amp;&amp;
<a name="l00634"></a>00634             (xpos != <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a62baa29ee8d9e12cde85b816ce34f85e" title="Returns the x-offset of the field to show stored in this changer.">getXPos</a>() || ypos != <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a6df84b97f6dd25f4ff750ed91c6b1aba" title="Returns the y-offset of the field to show stored in this changer.">getYPos</a>() || zoom != <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aae37ebcfff45a2726cf3d65c6a8a33d5" title="Returns the zoom factor computed stored in this changer.">getZoom</a>())) {
<a name="l00635"></a>00635 
<a name="l00636"></a>00636         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a39df8523319abe783f14715389b77374">myViewportChooser</a>-&gt;<a class="code" href="../../d3/d3d/class_g_u_i_dialog___edit_viewport.html#a3c14fc980b5897fd7acf99c7c5ef532a" title="Sets the given values into the dialog.">setValues</a>(
<a name="l00637"></a>00637             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aae37ebcfff45a2726cf3d65c6a8a33d5" title="Returns the zoom factor computed stored in this changer.">getZoom</a>(), <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a62baa29ee8d9e12cde85b816ce34f85e" title="Returns the x-offset of the field to show stored in this changer.">getXPos</a>(), <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a6df84b97f6dd25f4ff750ed91c6b1aba" title="Returns the y-offset of the field to show stored in this changer.">getYPos</a>());
<a name="l00638"></a>00638 
<a name="l00639"></a>00639     }
<a name="l00640"></a>00640     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a42cd98a7463c4ec5df846c65df822c36">updatePositionInformation</a>();
<a name="l00641"></a>00641     <span class="keywordflow">return</span> 1;
<a name="l00642"></a>00642 }
<a name="l00643"></a>00643 
<a name="l00644"></a>00644 
<a name="l00645"></a>00645 <span class="keywordtype">long</span>
<a name="l00646"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acc8592ae26e73e95c8c28cdad5d35812">00646</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acc8592ae26e73e95c8c28cdad5d35812">GUISUMOAbstractView::onMouseLeft</a>(<a class="code" href="../../d1/d63/class_f_x_object.html">FXObject</a>*, FXSelector , <span class="keywordtype">void</span>* <span class="comment">/*data*/</span>) {
<a name="l00647"></a>00647     <span class="keywordflow">return</span> 1;
<a name="l00648"></a>00648 }
<a name="l00649"></a>00649 
<a name="l00650"></a>00650 
<a name="l00651"></a>00651 <span class="keywordtype">void</span>
<a name="l00652"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a562d1b6d4334b69f2501541ff51dea40">00652</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a562d1b6d4334b69f2501541ff51dea40">GUISUMOAbstractView::openObjectDialog</a>() {
<a name="l00653"></a>00653     ungrab();
<a name="l00654"></a>00654     <span class="keywordflow">if</span> (!isEnabled() || !<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a059d51c72fd48c693923759a20ea47a6" title="Internal information whether doInit() was called.">myAmInitialised</a>) {
<a name="l00655"></a>00655         <span class="keywordflow">return</span>;
<a name="l00656"></a>00656     }
<a name="l00657"></a>00657     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a2a256b06a0fd18e31a419c1272018c48" title="A reimplementation due to some internal reasons.">makeCurrent</a>()) {
<a name="l00658"></a>00658         <span class="comment">// initialise the select mode</span>
<a name="l00659"></a>00659         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a529d99f53f098e10a7d9b527f34c11f6" title="returns the id of the object under the cursor using GL_SELECT">getObjectUnderCursor</a>();
<a name="l00660"></a>00660         <a class="code" href="../../de/d94/class_g_u_i_gl_object.html">GUIGlObject</a>* o = 0;
<a name="l00661"></a>00661         <span class="keywordflow">if</span> (<span class="keywordtype">id</span> != 0) {
<a name="l00662"></a>00662             o = <a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#acff5ff5c1e125024b12d7f73dff98e6f" title="A single static instance of this class.">GUIGlObjectStorage::gIDStorage</a>.<a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#ad828723bc0d92ad5666baa5406b8746b" title="Returns the object from the container locking it.">getObjectBlocking</a>(<span class="keywordtype">id</span>);
<a name="l00663"></a>00663         } <span class="keywordflow">else</span> {
<a name="l00664"></a>00664             o = <a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#acff5ff5c1e125024b12d7f73dff98e6f" title="A single static instance of this class.">GUIGlObjectStorage::gIDStorage</a>.<a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#acd2cf6046c78d31e627f5c3f67bda7e7" title="Returns the network object.">getNetObject</a>();
<a name="l00665"></a>00665         }
<a name="l00666"></a>00666         <span class="keywordflow">if</span> (o != 0) {
<a name="l00667"></a>00667             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ad0751a829130381a7b30d4dee389b963" title="The current popup-menu.">myPopup</a> = o-&gt;<a class="code" href="../../de/d94/class_g_u_i_gl_object.html#aa449867277fb01e43eb831822d1fd82d" title="Returns an own popup-menu.">getPopUpMenu</a>(*<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a588bcd9c748b69b7e833c3845773cd72" title="The application.">myApp</a>, *<span class="keyword">this</span>);
<a name="l00668"></a>00668             <span class="keywordtype">int</span> x, y;
<a name="l00669"></a>00669             FXuint b;
<a name="l00670"></a>00670             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a588bcd9c748b69b7e833c3845773cd72" title="The application.">myApp</a>-&gt;getCursorPosition(x, y, b);
<a name="l00671"></a>00671             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ad0751a829130381a7b30d4dee389b963" title="The current popup-menu.">myPopup</a>-&gt;setX(x + <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a588bcd9c748b69b7e833c3845773cd72" title="The application.">myApp</a>-&gt;getX());
<a name="l00672"></a>00672             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ad0751a829130381a7b30d4dee389b963" title="The current popup-menu.">myPopup</a>-&gt;setY(y + <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a588bcd9c748b69b7e833c3845773cd72" title="The application.">myApp</a>-&gt;getY());
<a name="l00673"></a>00673             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ad0751a829130381a7b30d4dee389b963" title="The current popup-menu.">myPopup</a>-&gt;create();
<a name="l00674"></a>00674             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ad0751a829130381a7b30d4dee389b963" title="The current popup-menu.">myPopup</a>-&gt;show();
<a name="l00675"></a>00675             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#ae56a2138c7167006f524ec686b562c92">onRightBtnRelease</a>(0);
<a name="l00676"></a>00676             <a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#acff5ff5c1e125024b12d7f73dff98e6f" title="A single static instance of this class.">GUIGlObjectStorage::gIDStorage</a>.<a class="code" href="../../db/d36/class_g_u_i_gl_object_storage.html#a6cf14a4d71afc57c126b914be49801a1" title="Marks an object as unblocked.">unblockObject</a>(<span class="keywordtype">id</span>);
<a name="l00677"></a>00677         }
<a name="l00678"></a>00678         makeNonCurrent();
<a name="l00679"></a>00679     }
<a name="l00680"></a>00680 }
<a name="l00681"></a>00681 
<a name="l00682"></a>00682 
<a name="l00683"></a>00683 <span class="keywordtype">long</span>
<a name="l00684"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a8f6dadc4f7215448b427ae12f8cae45f">00684</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a8f6dadc4f7215448b427ae12f8cae45f">GUISUMOAbstractView::onKeyPress</a>(<a class="code" href="../../d1/d63/class_f_x_object.html">FXObject</a>* o, FXSelector sel, <span class="keywordtype">void</span>* data) {
<a name="l00685"></a>00685     FXEvent* e = (FXEvent*) data;
<a name="l00686"></a>00686     <span class="keywordflow">if</span> ((e-&gt;state &amp; ALTMASK) != 0) {
<a name="l00687"></a>00687         setDefaultCursor(getApp()-&gt;getDefaultCursor(DEF_CROSSHAIR_CURSOR));
<a name="l00688"></a>00688         grabKeyboard();
<a name="l00689"></a>00689     }
<a name="l00690"></a>00690     <span class="comment">/*</span>
<a name="l00691"></a>00691 <span class="comment">    switch(e-&gt;code) {</span>
<a name="l00692"></a>00692 <span class="comment">    case KEY_Left:</span>
<a name="l00693"></a>00693 <span class="comment">        myChanger-&gt;move((SUMOReal) -p2m((SUMOReal) getWidth()/10), 0);</span>
<a name="l00694"></a>00694 <span class="comment">        break;</span>
<a name="l00695"></a>00695 <span class="comment">    case KEY_Right:</span>
<a name="l00696"></a>00696 <span class="comment">        myChanger-&gt;move((SUMOReal) p2m((SUMOReal) getWidth()/10), 0);</span>
<a name="l00697"></a>00697 <span class="comment">        break;</span>
<a name="l00698"></a>00698 <span class="comment">    case KEY_Up:</span>
<a name="l00699"></a>00699 <span class="comment">        myChanger-&gt;move(0, (SUMOReal) -p2m((SUMOReal) getHeight()/10));</span>
<a name="l00700"></a>00700 <span class="comment">        break;</span>
<a name="l00701"></a>00701 <span class="comment">    case KEY_Down:</span>
<a name="l00702"></a>00702 <span class="comment">        myChanger-&gt;move(0, (SUMOReal) p2m((SUMOReal) getHeight()/10));</span>
<a name="l00703"></a>00703 <span class="comment">        break;</span>
<a name="l00704"></a>00704 <span class="comment">    default:</span>
<a name="l00705"></a>00705 <span class="comment">        break;</span>
<a name="l00706"></a>00706 <span class="comment">    }</span>
<a name="l00707"></a>00707 <span class="comment">    */</span>
<a name="l00708"></a>00708     <span class="keywordflow">return</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a8f6dadc4f7215448b427ae12f8cae45f">FXGLCanvas::onKeyPress</a>(o, sel, data);
<a name="l00709"></a>00709 }
<a name="l00710"></a>00710 
<a name="l00711"></a>00711 
<a name="l00712"></a>00712 <span class="keywordtype">long</span>
<a name="l00713"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa0c19fe2364d2cb0fe98136a3c8fe5c3">00713</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa0c19fe2364d2cb0fe98136a3c8fe5c3">GUISUMOAbstractView::onKeyRelease</a>(<a class="code" href="../../d1/d63/class_f_x_object.html">FXObject</a>* o, FXSelector sel, <span class="keywordtype">void</span>* data) {
<a name="l00714"></a>00714     FXEvent* e = (FXEvent*) data;
<a name="l00715"></a>00715     <span class="keywordflow">if</span> ((e-&gt;state &amp; ALTMASK) == 0) {
<a name="l00716"></a>00716         ungrabKeyboard();
<a name="l00717"></a>00717         setDefaultCursor(getApp()-&gt;getDefaultCursor(DEF_ARROW_CURSOR));
<a name="l00718"></a>00718     }
<a name="l00719"></a>00719     <span class="keywordflow">return</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa0c19fe2364d2cb0fe98136a3c8fe5c3">FXGLCanvas::onKeyRelease</a>(o, sel, data);
<a name="l00720"></a>00720 }
<a name="l00721"></a>00721 
<a name="l00722"></a>00722 
<a name="l00723"></a>00723 <span class="comment">// ------------ Dealing with snapshots</span>
<a name="l00724"></a>00724 <span class="keywordtype">void</span>
<a name="l00725"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a1482e8adc9ff8a2d721f66e9359de355">00725</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a1482e8adc9ff8a2d721f66e9359de355" title="Sets the snapshot time to file map.">GUISUMOAbstractView::setSnapshots</a>(std::map&lt;SUMOTime, std::string&gt; snaps) {
<a name="l00726"></a>00726     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a5d517be0f950ba7ae08e586329f60262">mySnapshots</a>.insert(snaps.begin(), snaps.end());
<a name="l00727"></a>00727 }
<a name="l00728"></a>00728 
<a name="l00729"></a>00729 
<a name="l00730"></a>00730 std::string
<a name="l00731"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7f64e2ff0aae75bc0149c9d60aee1dce">00731</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7f64e2ff0aae75bc0149c9d60aee1dce" title="Takes a snapshots and writes it into the given file.">GUISUMOAbstractView::makeSnapshot</a>(<span class="keyword">const</span> std::string&amp; destFile) {
<a name="l00732"></a>00732     std::string errorMessage;
<a name="l00733"></a>00733     FXString ext = FXPath::extension(destFile.c_str());
<a name="l00734"></a>00734     <span class="keywordtype">bool</span> useGL2PS = ext == <span class="stringliteral">&quot;ps&quot;</span> || ext == <span class="stringliteral">&quot;eps&quot;</span> || ext == <span class="stringliteral">&quot;pdf&quot;</span> || ext == <span class="stringliteral">&quot;svg&quot;</span> || ext == <span class="stringliteral">&quot;tex&quot;</span> || ext == <span class="stringliteral">&quot;pgf&quot;</span>;
<a name="l00735"></a>00735 
<a name="l00736"></a>00736     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10 &amp;&amp; !<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a2a256b06a0fd18e31a419c1272018c48" title="A reimplementation due to some internal reasons.">makeCurrent</a>(); ++i) {
<a name="l00737"></a>00737         <a class="code" href="../../de/dcf/class_f_x_single_event_thread.html#a544beeaedb7dc90a0d8f338f28c233ed">FXSingleEventThread::sleep</a>(100);
<a name="l00738"></a>00738     }
<a name="l00739"></a>00739     <span class="comment">// draw</span>
<a name="l00740"></a>00740     glClearColor(
<a name="l00741"></a>00741         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a0a59d560b5b75c48e2b51734c040d3e1" title="The background color to use.">backgroundColor</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#af3739c0c10661723552770c0996ad7c2" title="Returns the red-amount of the color.">red</a>(),
<a name="l00742"></a>00742         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a0a59d560b5b75c48e2b51734c040d3e1" title="The background color to use.">backgroundColor</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#aecf0743143198bec2a7cc68fb4e9ad2e" title="Returns the green-amount of the color.">green</a>(),
<a name="l00743"></a>00743         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a0a59d560b5b75c48e2b51734c040d3e1" title="The background color to use.">backgroundColor</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#a797a5810e1de8c10b313809e4bdb5780" title="Returns the blue-amount of the color.">blue</a>(),
<a name="l00744"></a>00744         1);
<a name="l00745"></a>00745     glClear(GL_DEPTH_BUFFER_BIT | GL_COLOR_BUFFER_BIT);
<a name="l00746"></a>00746     glPolygonMode(GL_FRONT_AND_BACK, GL_FILL);
<a name="l00747"></a>00747 
<a name="l00748"></a>00748     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a20967e7453c09d8028c19545a18d7581" title="Information whether dithering shall be enabled.">dither</a>) {
<a name="l00749"></a>00749         glEnable(GL_DITHER);
<a name="l00750"></a>00750     } <span class="keywordflow">else</span> {
<a name="l00751"></a>00751         glDisable(GL_DITHER);
<a name="l00752"></a>00752     }
<a name="l00753"></a>00753     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a4785f0367ad6b842a8a623ad801c8cb1" title="Information whether antialiase shall be enabled.">antialiase</a>) {
<a name="l00754"></a>00754         glEnable(GL_BLEND);
<a name="l00755"></a>00755         glEnable(GL_POLYGON_SMOOTH);
<a name="l00756"></a>00756         glEnable(GL_LINE_SMOOTH);
<a name="l00757"></a>00757     } <span class="keywordflow">else</span> {
<a name="l00758"></a>00758         glDisable(GL_BLEND);
<a name="l00759"></a>00759         glDisable(GL_POLYGON_SMOOTH);
<a name="l00760"></a>00760         glDisable(GL_LINE_SMOOTH);
<a name="l00761"></a>00761     }
<a name="l00762"></a>00762 
<a name="l00763"></a>00763     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a828f29525f64e0388c850e14f7b360d8">applyGLTransform</a>();
<a name="l00764"></a>00764 
<a name="l00765"></a>00765     <span class="keywordflow">if</span> (useGL2PS) {
<a name="l00766"></a>00766         GLint format = <a class="code" href="../../df/db7/gl2ps_8h.html#af1193d09c2ce06be5c695cf2fb6b55be">GL2PS_PS</a>;
<a name="l00767"></a>00767         <span class="keywordflow">if</span> (ext == <span class="stringliteral">&quot;ps&quot;</span>) {
<a name="l00768"></a>00768             format = <a class="code" href="../../df/db7/gl2ps_8h.html#af1193d09c2ce06be5c695cf2fb6b55be">GL2PS_PS</a>;
<a name="l00769"></a>00769         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ext == <span class="stringliteral">&quot;eps&quot;</span>) {
<a name="l00770"></a>00770             format = <a class="code" href="../../df/db7/gl2ps_8h.html#ad916bcac1cd3b19dc164e38bd8dea490">GL2PS_EPS</a>;
<a name="l00771"></a>00771         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ext == <span class="stringliteral">&quot;pdf&quot;</span>) {
<a name="l00772"></a>00772             format = <a class="code" href="../../df/db7/gl2ps_8h.html#aef414084a2fa1a612546b888607b59bd">GL2PS_PDF</a>;
<a name="l00773"></a>00773         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ext == <span class="stringliteral">&quot;tex&quot;</span>) {
<a name="l00774"></a>00774             format = <a class="code" href="../../df/db7/gl2ps_8h.html#aef2e3a2fe6013480786df6874da163d6">GL2PS_TEX</a>;
<a name="l00775"></a>00775         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ext == <span class="stringliteral">&quot;svg&quot;</span>) {
<a name="l00776"></a>00776             format = <a class="code" href="../../df/db7/gl2ps_8h.html#a0623a105f4a08f63d0b71bdf3d7e5ded">GL2PS_SVG</a>;
<a name="l00777"></a>00777         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ext == <span class="stringliteral">&quot;pgf&quot;</span>) {
<a name="l00778"></a>00778             format = <a class="code" href="../../df/db7/gl2ps_8h.html#ae35d3ea3ef884d62790f633acb03f715">GL2PS_PGF</a>;
<a name="l00779"></a>00779         } <span class="keywordflow">else</span> {
<a name="l00780"></a>00780             <span class="keywordflow">return</span> <span class="stringliteral">&quot;Could not save &#39;&quot;</span> + destFile + <span class="stringliteral">&quot;&#39;.\n Unrecognized format &#39;&quot;</span> + std::string(ext.text()) + <span class="stringliteral">&quot;&#39;.&quot;</span>;
<a name="l00781"></a>00781         }
<a name="l00782"></a>00782         FILE* fp = fopen(destFile.c_str(), <span class="stringliteral">&quot;wb&quot;</span>);
<a name="l00783"></a>00783         <span class="keywordflow">if</span> (fp == 0) {
<a name="l00784"></a>00784             <span class="keywordflow">return</span> <span class="stringliteral">&quot;Could not save &#39;&quot;</span> + destFile + <span class="stringliteral">&quot;&#39;.\n Could not open file for writing&quot;</span>;
<a name="l00785"></a>00785         }
<a name="l00786"></a>00786         GLint buffsize = 0, state = <a class="code" href="../../df/db7/gl2ps_8h.html#a89d279dade6b94b48538198f047df79f">GL2PS_OVERFLOW</a>;
<a name="l00787"></a>00787         GLint viewport[4];
<a name="l00788"></a>00788         glGetIntegerv(GL_VIEWPORT, viewport);
<a name="l00789"></a>00789         <span class="keywordflow">while</span> (state == <a class="code" href="../../df/db7/gl2ps_8h.html#a89d279dade6b94b48538198f047df79f">GL2PS_OVERFLOW</a>) {
<a name="l00790"></a>00790             buffsize += 1024 * 1024;
<a name="l00791"></a>00791             <a class="code" href="../../d3/d9c/gl2ps_8c.html#a4890e21e66dbad401a0090f79ec3e6fc">gl2psBeginPage</a>(destFile.c_str(), <span class="stringliteral">&quot;sumo-gui; http://sumo.sf.net&quot;</span>, viewport, format, <a class="code" href="../../df/db7/gl2ps_8h.html#a3ce1bce3dd73a802654a7be5b38c60b4">GL2PS_SIMPLE_SORT</a>,
<a name="l00792"></a>00792                            <a class="code" href="../../df/db7/gl2ps_8h.html#aaf136cdc7cf8234c107257c657874a32">GL2PS_DRAW_BACKGROUND</a> | <a class="code" href="../../df/db7/gl2ps_8h.html#ae5650cbba4f4c49f0803d9727ccf05f6">GL2PS_USE_CURRENT_VIEWPORT</a>,
<a name="l00793"></a>00793                            GL_RGBA, 0, NULL, 0, 0, 0, buffsize, fp, <span class="stringliteral">&quot;out.eps&quot;</span>);
<a name="l00794"></a>00794             glMatrixMode(GL_MODELVIEW);
<a name="l00795"></a>00795             glPushMatrix();
<a name="l00796"></a>00796             glDisable(GL_TEXTURE_2D);
<a name="l00797"></a>00797             glDisable(GL_ALPHA_TEST);
<a name="l00798"></a>00798             glDisable(GL_BLEND);
<a name="l00799"></a>00799             glEnable(GL_DEPTH_TEST);
<a name="l00800"></a>00800             <span class="comment">// compute lane width</span>
<a name="l00801"></a>00801             <span class="comment">// draw decals (if not in grabbing mode)</span>
<a name="l00802"></a>00802             <span class="keywordflow">if</span> (!<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7744bfcee37891a3c2be2505388bdfdb">myUseToolTips</a>) {
<a name="l00803"></a>00803                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ab613680ee0dd0165e90994a2ef7bec29" title="Draws the stored decals.">drawDecals</a>();
<a name="l00804"></a>00804                 <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#a75ce64cc7b198360139965016e7bb376" title="Information whether a grid shall be shown.">showGrid</a>) {
<a name="l00805"></a>00805                     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a039c738d88d3e307c1095a965513cfd9" title="paints a grid">paintGLGrid</a>();
<a name="l00806"></a>00806                 }
<a name="l00807"></a>00807             }
<a name="l00808"></a>00808             glLineWidth(1);
<a name="l00809"></a>00809             glPolygonMode(GL_FRONT_AND_BACK, GL_FILL);
<a name="l00810"></a>00810             <a class="code" href="../../d5/dda/class_boundary.html" title="A class that stores a 2D geometrical boundary.">Boundary</a> viewPort = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aea56ecc20db34c280f8f6fc2f2030bd4">getViewport</a>();
<a name="l00811"></a>00811             <span class="keywordtype">float</span> minB[2];
<a name="l00812"></a>00812             <span class="keywordtype">float</span> maxB[2];
<a name="l00813"></a>00813             minB[0] = viewPort.<a class="code" href="../../d5/dda/class_boundary.html#a68c581ea01becd3954fcc808ac476040" title="Returns minimum x-coordinate.">xmin</a>();
<a name="l00814"></a>00814             minB[1] = viewPort.<a class="code" href="../../d5/dda/class_boundary.html#a23f3304d1d057aec6a5255f519cc567d" title="Returns minimum y-coordinate.">ymin</a>();
<a name="l00815"></a>00815             maxB[0] = viewPort.<a class="code" href="../../d5/dda/class_boundary.html#ace0f25069b6d972da95a747136261fcd" title="Returns maximum x-coordinate.">xmax</a>();
<a name="l00816"></a>00816             maxB[1] = viewPort.<a class="code" href="../../d5/dda/class_boundary.html#ab908d8e6c0fc8abdee797e789176a43e" title="Returns maximum y-coordinate.">ymax</a>();
<a name="l00817"></a>00817             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#ae4d98fb95967f494f54cd2c2c8042609" title="information about a lane&amp;#39;s width (temporary, used for a single view)">scale</a> = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a71c204d7b282a54cf7bad2ce0b77f7d2" title="meter-to-pixels conversion method">m2p</a>(<a class="code" href="../../da/dbd/_std_defs_8h.html#ad3dc471ca699b165609aa4be50eeb7dc">SUMO_const_laneWidth</a>);
<a name="l00818"></a>00818             glEnable(GL_POLYGON_OFFSET_FILL);
<a name="l00819"></a>00819             glEnable(GL_POLYGON_OFFSET_LINE);
<a name="l00820"></a>00820             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a67bf9f4bdc680c11dd1827a3852f6bea" title="The visualization speed-up.">myGrid</a>-&gt;<a class="code" href="../../d0/dea/class_r_tree.html#a7c6e43f339befee724b48834605b6c81" title="DK 15.10.2008 - begin.">Search</a>(minB, maxB, *<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>);
<a name="l00821"></a>00821 
<a name="l00822"></a>00822             <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#ac42a7eff976a68afded43a7e89ed307b" title="Information whether the size legend shall be drawn.">showSizeLegend</a>) {
<a name="l00823"></a>00823                 <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a13886c169edc2f1c1fe19749f8d9ea82">displayLegend</a>();
<a name="l00824"></a>00824             }
<a name="l00825"></a>00825             state = <a class="code" href="../../d3/d9c/gl2ps_8c.html#aaf866dd47c48600f1a724ddc49961a87">gl2psEndPage</a>();
<a name="l00826"></a>00826             glFinish();
<a name="l00827"></a>00827         }
<a name="l00828"></a>00828         fclose(fp);
<a name="l00829"></a>00829     } <span class="keywordflow">else</span> {
<a name="l00830"></a>00830         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ae7ab139acb8e03f17cbb88b6ec83cacf">doPaintGL</a>(GL_RENDER, <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aea56ecc20db34c280f8f6fc2f2030bd4">getViewport</a>());
<a name="l00831"></a>00831         <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a871c00584b81264a1694f0728e62988d">myVisualizationSettings</a>-&gt;<a class="code" href="../../db/d21/class_g_u_i_visualization_settings.html#ac42a7eff976a68afded43a7e89ed307b" title="Information whether the size legend shall be drawn.">showSizeLegend</a>) {
<a name="l00832"></a>00832             <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a13886c169edc2f1c1fe19749f8d9ea82">displayLegend</a>();
<a name="l00833"></a>00833         }
<a name="l00834"></a>00834         swapBuffers();
<a name="l00835"></a>00835         glFinish();
<a name="l00836"></a>00836         FXColor* buf;
<a name="l00837"></a>00837         FXMALLOC(&amp;buf, FXColor, getWidth()*getHeight());
<a name="l00838"></a>00838         <span class="comment">// read from the back buffer</span>
<a name="l00839"></a>00839         glReadBuffer(GL_BACK);
<a name="l00840"></a>00840         <span class="comment">// Read the pixels</span>
<a name="l00841"></a>00841         glReadPixels(0, 0, getWidth(), getHeight(), GL_RGBA, GL_UNSIGNED_BYTE, (GLvoid*)buf);
<a name="l00842"></a>00842         makeNonCurrent();
<a name="l00843"></a>00843         update();
<a name="l00844"></a>00844         <span class="comment">// mirror</span>
<a name="l00845"></a>00845         <span class="keywordtype">size_t</span> mwidth = getWidth();
<a name="l00846"></a>00846         <span class="keywordtype">size_t</span> mheight = getHeight();
<a name="l00847"></a>00847         FXColor* paa = buf;
<a name="l00848"></a>00848         FXColor* pbb = buf + mwidth * (mheight - 1);
<a name="l00849"></a>00849         <span class="keywordflow">do</span> {
<a name="l00850"></a>00850             FXColor* pa = paa;
<a name="l00851"></a>00851             paa += mwidth;
<a name="l00852"></a>00852             FXColor* pb = pbb;
<a name="l00853"></a>00853             pbb -= mwidth;
<a name="l00854"></a>00854             <span class="keywordflow">do</span> {
<a name="l00855"></a>00855                 FXColor t = *pa;
<a name="l00856"></a>00856                 *pa++ = *pb;
<a name="l00857"></a>00857                 *pb++ = t;
<a name="l00858"></a>00858             } <span class="keywordflow">while</span> (pa &lt; paa);
<a name="l00859"></a>00859         } <span class="keywordflow">while</span> (paa &lt; pbb);
<a name="l00860"></a>00860         <span class="keywordflow">try</span> {
<a name="l00861"></a>00861             <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d42/class_m_f_x_image_helper.html#aac55d2bdb95026fe6840f54749f3733c">MFXImageHelper::saveImage</a>(destFile, getWidth(), getHeight(), buf)) {
<a name="l00862"></a>00862                 errorMessage = <span class="stringliteral">&quot;Could not save &#39;&quot;</span> + destFile + <span class="stringliteral">&quot;&#39;.&quot;</span>;
<a name="l00863"></a>00863             }
<a name="l00864"></a>00864         } <span class="keywordflow">catch</span> (<a class="code" href="../../d3/d68/class_invalid_argument.html">InvalidArgument</a>&amp; e) {
<a name="l00865"></a>00865             errorMessage = <span class="stringliteral">&quot;Could not save &#39;&quot;</span> + destFile + <span class="stringliteral">&quot;&#39;.\n&quot;</span> + e.what();
<a name="l00866"></a>00866         }
<a name="l00867"></a>00867         FXFREE(&amp;buf);
<a name="l00868"></a>00868     }
<a name="l00869"></a>00869     <span class="keywordflow">return</span> errorMessage;
<a name="l00870"></a>00870 }
<a name="l00871"></a>00871 
<a name="l00872"></a>00872 
<a name="l00873"></a>00873 <span class="keywordtype">void</span>
<a name="l00874"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a0b871244d08f8bc8edf100a26edca845">00874</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a0b871244d08f8bc8edf100a26edca845" title="Checks whether it is time for a snapshot.">GUISUMOAbstractView::checkSnapshots</a>() {
<a name="l00875"></a>00875     std::map&lt;SUMOTime, std::string&gt;::iterator snapIt = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a5d517be0f950ba7ae08e586329f60262">mySnapshots</a>.find(<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a5b5a04d032e08b5c9e2f00b05fe3c6c8" title="get the current simulation time">getCurrentTimeStep</a>());
<a name="l00876"></a>00876     <span class="keywordflow">if</span> (snapIt != <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a5d517be0f950ba7ae08e586329f60262">mySnapshots</a>.end()) {
<a name="l00877"></a>00877         std::string error = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7f64e2ff0aae75bc0149c9d60aee1dce" title="Takes a snapshots and writes it into the given file.">makeSnapshot</a>(snapIt-&gt;second);
<a name="l00878"></a>00878         <span class="keywordflow">if</span> (error != <span class="stringliteral">&quot;&quot;</span>) {
<a name="l00879"></a>00879             <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(error);
<a name="l00880"></a>00880         }
<a name="l00881"></a>00881     }
<a name="l00882"></a>00882 }
<a name="l00883"></a>00883 
<a name="l00884"></a>00884 
<a name="l00885"></a>00885 <span class="keywordtype">void</span>
<a name="l00886"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a46ebbe966c8897adc7b59c59ad86de80">00886</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a46ebbe966c8897adc7b59c59ad86de80">GUISUMOAbstractView::showViewportEditor</a>() {
<a name="l00887"></a>00887     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a39df8523319abe783f14715389b77374">myViewportChooser</a> == 0) {
<a name="l00888"></a>00888         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a39df8523319abe783f14715389b77374">myViewportChooser</a> =
<a name="l00889"></a>00889             <span class="keyword">new</span> <a class="code" href="../../d3/d3d/class_g_u_i_dialog___edit_viewport.html" title="A dialog to change the viewport.">GUIDialog_EditViewport</a>(<span class="keyword">this</span>, <span class="stringliteral">&quot;Edit Viewport...&quot;</span>,
<a name="l00890"></a>00890                                        <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aae37ebcfff45a2726cf3d65c6a8a33d5" title="Returns the zoom factor computed stored in this changer.">getZoom</a>(), <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a62baa29ee8d9e12cde85b816ce34f85e" title="Returns the x-offset of the field to show stored in this changer.">getXPos</a>(), <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a6df84b97f6dd25f4ff750ed91c6b1aba" title="Returns the y-offset of the field to show stored in this changer.">getYPos</a>(),
<a name="l00891"></a>00891                                        0, 0);
<a name="l00892"></a>00892         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a39df8523319abe783f14715389b77374">myViewportChooser</a>-&gt;create();
<a name="l00893"></a>00893     }
<a name="l00894"></a>00894     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a39df8523319abe783f14715389b77374">myViewportChooser</a>-&gt;<a class="code" href="../../d3/d3d/class_g_u_i_dialog___edit_viewport.html#abb7b6115d462186e5809195b1a2c4602" title="Resets old values.">setOldValues</a>(
<a name="l00895"></a>00895         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aae37ebcfff45a2726cf3d65c6a8a33d5" title="Returns the zoom factor computed stored in this changer.">getZoom</a>(), <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a62baa29ee8d9e12cde85b816ce34f85e" title="Returns the x-offset of the field to show stored in this changer.">getXPos</a>(), <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a6df84b97f6dd25f4ff750ed91c6b1aba" title="Returns the y-offset of the field to show stored in this changer.">getYPos</a>());
<a name="l00896"></a>00896     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a39df8523319abe783f14715389b77374">myViewportChooser</a>-&gt;show();
<a name="l00897"></a>00897 }
<a name="l00898"></a>00898 
<a name="l00899"></a>00899 
<a name="l00900"></a>00900 <span class="keywordtype">void</span>
<a name="l00901"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ab3018e0a20bfcf32bfc1271cd8a565fb">00901</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ab3018e0a20bfcf32bfc1271cd8a565fb" title="applies the given viewport settings">GUISUMOAbstractView::setViewport</a>(<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> zoom, <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> xPos, <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> yPos) {
<a name="l00902"></a>00902     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#a87e5b65eaad33258cc5cbe408b6030e0" title="Sets the viewport Used for: Adapting a new viewport.">setViewport</a>(zoom, xPos, yPos);
<a name="l00903"></a>00903     update();
<a name="l00904"></a>00904 }
<a name="l00905"></a>00905 
<a name="l00906"></a>00906 
<a name="l00907"></a>00907 <span class="keywordtype">void</span>
<a name="l00908"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a65c077eae3a5f99819b95acc0f0b680a">00908</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a65c077eae3a5f99819b95acc0f0b680a">GUISUMOAbstractView::showToolTips</a>(<span class="keywordtype">bool</span> val) {
<a name="l00909"></a>00909     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a7744bfcee37891a3c2be2505388bdfdb">myUseToolTips</a> = val;
<a name="l00910"></a>00910 }
<a name="l00911"></a>00911 
<a name="l00912"></a>00912 
<a name="l00913"></a>00913 
<a name="l00914"></a>00914 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>
<a name="l00915"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a5deba30e3c781375e1e082af6f194280">00915</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a5deba30e3c781375e1e082af6f194280">GUISUMOAbstractView::getGridWidth</a>()<span class="keyword"> const </span>{
<a name="l00916"></a>00916     <span class="keywordflow">return</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a67bf9f4bdc680c11dd1827a3852f6bea" title="The visualization speed-up.">myGrid</a>-&gt;<a class="code" href="../../d5/dda/class_boundary.html#a32ae1fd6f35bbd871344abdaef966c7b" title="Returns the width of the boudary.">getWidth</a>();
<a name="l00917"></a>00917 }
<a name="l00918"></a>00918 
<a name="l00919"></a>00919 
<a name="l00920"></a>00920 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>
<a name="l00921"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa0c0b28ae924a4b25ad008004ed3edb6">00921</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aa0c0b28ae924a4b25ad008004ed3edb6">GUISUMOAbstractView::getGridHeight</a>()<span class="keyword"> const </span>{
<a name="l00922"></a>00922     <span class="keywordflow">return</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a67bf9f4bdc680c11dd1827a3852f6bea" title="The visualization speed-up.">myGrid</a>-&gt;<a class="code" href="../../d5/dda/class_boundary.html#a9ea2d7003c5b45aed089f0870371d5f6" title="Returns the height of the boundary.">getHeight</a>();
<a name="l00923"></a>00923 }
<a name="l00924"></a>00924 
<a name="l00925"></a>00925 
<a name="l00926"></a>00926 FXComboBox&amp;
<a name="l00927"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a23237f35d730c6b98a8c33632de15320">00927</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a23237f35d730c6b98a8c33632de15320">GUISUMOAbstractView::getColoringSchemesCombo</a>() {
<a name="l00928"></a>00928     <span class="keywordflow">return</span> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ae107a81f6fb6a21dd49586d317cbe17d" title="The parent window.">myParent</a>-&gt;<a class="code" href="../../d3/d1b/class_g_u_i_gl_child_window.html#a2724d896b787bf5bc9e71dca7da23dad">getColoringSchemesCombo</a>();
<a name="l00929"></a>00929 }
<a name="l00930"></a>00930 
<a name="l00931"></a>00931 
<a name="l00932"></a>00932 <span class="keywordtype">void</span>
<a name="l00933"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ab613680ee0dd0165e90994a2ef7bec29">00933</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ab613680ee0dd0165e90994a2ef7bec29" title="Draws the stored decals.">GUISUMOAbstractView::drawDecals</a>() {
<a name="l00934"></a>00934     glTranslated(0, 0, .99);
<a name="l00935"></a>00935     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ac04ce08b174d2600b13c348753a0d7b0" title="The mutex to use before accessing the decals list in order to avoid thread conficts...">myDecalsLock</a>.<a class="code" href="../../d9/d79/class_m_f_x_mutex.html#a3609793086e8009740a9a31d7751e17c" title="lock mutex">lock</a>();
<a name="l00936"></a>00936     <span class="keywordflow">for</span> (std::vector&lt;GUISUMOAbstractView::Decal&gt;::iterator l = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a837d6c5e72f40cacb13161563552ecd6" title="The list of decals to show.">myDecals</a>.begin(); l != <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a837d6c5e72f40cacb13161563552ecd6" title="The list of decals to show.">myDecals</a>.end();) {
<a name="l00937"></a>00937         <a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html" title="A decal (an image) that can be shown.">GUISUMOAbstractView::Decal</a>&amp; d = *l;
<a name="l00938"></a>00938         <span class="keywordflow">if</span> (!d.<a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html#a7182798d95842abfa71f6a48df710135" title="Whether this image was initialised (inserted as a texture).">initialised</a>) {
<a name="l00939"></a>00939             <span class="keywordflow">try</span> {
<a name="l00940"></a>00940                 FXImage* i = <a class="code" href="../../d8/d42/class_m_f_x_image_helper.html#a318391fe5b66d5903fe9f23636ec5ebe">MFXImageHelper::loadImage</a>(getApp(), d.<a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html#ac60f7695f029d1ea49865bde8206874e" title="The path to the file the image is located at.">filename</a>);
<a name="l00941"></a>00941                 <span class="keywordflow">if</span> (<a class="code" href="../../d8/d42/class_m_f_x_image_helper.html#a57e87b9f2f67896c278e28dc2430c673">MFXImageHelper::scalePower2</a>(i)) {
<a name="l00942"></a>00942                     <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(<span class="stringliteral">&quot;Scaling &#39;&quot;</span> + d.<a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html#ac60f7695f029d1ea49865bde8206874e" title="The path to the file the image is located at.">filename</a> + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00943"></a>00943                 }
<a name="l00944"></a>00944                 d.<a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html#ad1c8d57199b8c43b920e83caae9ea05b" title="The gl-id of the texture that holds this image.">glID</a> = <a class="code" href="../../d9/dff/class_g_u_i_textures_helper.html#a481dbd22c0a7ffd97148b126c4ef7678" title="Adds a texture to use.">GUITexturesHelper::add</a>(i);
<a name="l00945"></a>00945                 d.<a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html#a7182798d95842abfa71f6a48df710135" title="Whether this image was initialised (inserted as a texture).">initialised</a> = <span class="keyword">true</span>;
<a name="l00946"></a>00946             } <span class="keywordflow">catch</span> (<a class="code" href="../../d3/d68/class_invalid_argument.html">InvalidArgument</a>&amp; e) {
<a name="l00947"></a>00947                 <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Could not load &#39;&quot;</span> + d.<a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html#ac60f7695f029d1ea49865bde8206874e" title="The path to the file the image is located at.">filename</a> + <span class="stringliteral">&quot;&#39;.\n&quot;</span> + e.what());
<a name="l00948"></a>00948                 l = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a837d6c5e72f40cacb13161563552ecd6" title="The list of decals to show.">myDecals</a>.erase(l);
<a name="l00949"></a>00949                 <span class="keywordflow">continue</span>;
<a name="l00950"></a>00950             }
<a name="l00951"></a>00951         }
<a name="l00952"></a>00952         glPushMatrix();
<a name="l00953"></a>00953         glTranslated(d.<a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html#aa627e681a24483b17a342f639b96e1dd" title="The center of the image in x-direction (net coordinates, in m).">centerX</a>, d.<a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html#ad9d4463aa3c0ed2d0ff9ff1336595061" title="The center of the image in y-direction (net coordinates, in m).">centerY</a>, 0);
<a name="l00954"></a>00954         glRotated(d.<a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html#aea735fdd54594c9378097f6737a4f2e4" title="The rotation of the image (in degrees).">rot</a>, 0, 0, 1);
<a name="l00955"></a>00955         glColor3d(1, 1, 1);
<a name="l00956"></a>00956         <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> halfWidth((d.<a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html#a90a1fe8382cd7c4acaad6fb740216aa2" title="The width of the image (net coordinates, in m).">width</a> / 2.));
<a name="l00957"></a>00957         <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> halfHeight((d.<a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html#ac47d30b3d121eafbf44310632fce7728" title="The height of the image (net coordinates, in m).">height</a> / 2.));
<a name="l00958"></a>00958         <a class="code" href="../../d9/dff/class_g_u_i_textures_helper.html#a4be9639bb384bb46b2a6f2ca4be2d4c1" title="Draws a named texture as a box with the given size.">GUITexturesHelper::drawTexturedBox</a>(d.<a class="code" href="../../dd/dd7/struct_g_u_i_s_u_m_o_abstract_view_1_1_decal.html#ad1c8d57199b8c43b920e83caae9ea05b" title="The gl-id of the texture that holds this image.">glID</a>, -halfWidth, -halfHeight, halfWidth, halfHeight);
<a name="l00959"></a>00959         glPopMatrix();
<a name="l00960"></a>00960         ++l;
<a name="l00961"></a>00961     }
<a name="l00962"></a>00962     <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ac04ce08b174d2600b13c348753a0d7b0" title="The mutex to use before accessing the decals list in order to avoid thread conficts...">myDecalsLock</a>.<a class="code" href="../../d9/d79/class_m_f_x_mutex.html#aea4ed8cbb1d65e9d43119c21c4b1b93a" title="release mutex lock">unlock</a>();
<a name="l00963"></a>00963     glTranslated(0, 0, -.99);
<a name="l00964"></a>00964 }
<a name="l00965"></a>00965 
<a name="l00966"></a>00966 
<a name="l00967"></a>00967 <span class="comment">// ------------ Additional visualisations</span>
<a name="l00968"></a>00968 <span class="keywordtype">bool</span>
<a name="l00969"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ad5e62babe5217ea8f7bea638bb74e008">00969</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ad5e62babe5217ea8f7bea638bb74e008" title="Adds an object to call its additional visualisation method.">GUISUMOAbstractView::addAdditionalGLVisualisation</a>(<a class="code" href="../../de/d94/class_g_u_i_gl_object.html">GUIGlObject</a>* <span class="keyword">const</span> which) {
<a name="l00970"></a>00970     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aacd45e86cccde498f75a2db9536bd02b" title="List of objects for which GUIGlObject::drawGLAdditional is called.">myAdditionallyDrawn</a>.find(which) == <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aacd45e86cccde498f75a2db9536bd02b" title="List of objects for which GUIGlObject::drawGLAdditional is called.">myAdditionallyDrawn</a>.end()) {
<a name="l00971"></a>00971         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aacd45e86cccde498f75a2db9536bd02b" title="List of objects for which GUIGlObject::drawGLAdditional is called.">myAdditionallyDrawn</a>[which] = 1;
<a name="l00972"></a>00972     } <span class="keywordflow">else</span> {
<a name="l00973"></a>00973         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aacd45e86cccde498f75a2db9536bd02b" title="List of objects for which GUIGlObject::drawGLAdditional is called.">myAdditionallyDrawn</a>[which] = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aacd45e86cccde498f75a2db9536bd02b" title="List of objects for which GUIGlObject::drawGLAdditional is called.">myAdditionallyDrawn</a>[which] + 1;
<a name="l00974"></a>00974     }
<a name="l00975"></a>00975     update();
<a name="l00976"></a>00976     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00977"></a>00977 }
<a name="l00978"></a>00978 
<a name="l00979"></a>00979 
<a name="l00980"></a>00980 <span class="keywordtype">bool</span>
<a name="l00981"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a6cf345df5e7d83156bb08fb0969ec2ec">00981</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a6cf345df5e7d83156bb08fb0969ec2ec" title="Removes an object from the list of objects that show additional things.">GUISUMOAbstractView::removeAdditionalGLVisualisation</a>(<a class="code" href="../../de/d94/class_g_u_i_gl_object.html">GUIGlObject</a>* <span class="keyword">const</span> which) {
<a name="l00982"></a>00982     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a0f5d56d0283da9b2e7567e1ca80d8671">getTrackedID</a>() == static_cast&lt;int&gt;(which-&gt;<a class="code" href="../../de/d94/class_g_u_i_gl_object.html#ac6cfa69398d352646e3d2228f7772a46" title="Returns the numerical id of the object.">getGlID</a>())) {
<a name="l00983"></a>00983         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#ad00156161e3b71cfa827a8a1c415a7d2">stopTrack</a>();
<a name="l00984"></a>00984     }
<a name="l00985"></a>00985     <span class="keywordflow">if</span> (<a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aacd45e86cccde498f75a2db9536bd02b" title="List of objects for which GUIGlObject::drawGLAdditional is called.">myAdditionallyDrawn</a>.find(which) == <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aacd45e86cccde498f75a2db9536bd02b" title="List of objects for which GUIGlObject::drawGLAdditional is called.">myAdditionallyDrawn</a>.end()) {
<a name="l00986"></a>00986         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00987"></a>00987     }
<a name="l00988"></a>00988     <span class="keywordtype">int</span> cnt = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aacd45e86cccde498f75a2db9536bd02b" title="List of objects for which GUIGlObject::drawGLAdditional is called.">myAdditionallyDrawn</a>[which];
<a name="l00989"></a>00989     <span class="keywordflow">if</span> (cnt == 1) {
<a name="l00990"></a>00990         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aacd45e86cccde498f75a2db9536bd02b" title="List of objects for which GUIGlObject::drawGLAdditional is called.">myAdditionallyDrawn</a>.erase(which);
<a name="l00991"></a>00991     } <span class="keywordflow">else</span> {
<a name="l00992"></a>00992         <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aacd45e86cccde498f75a2db9536bd02b" title="List of objects for which GUIGlObject::drawGLAdditional is called.">myAdditionallyDrawn</a>[which] = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#aacd45e86cccde498f75a2db9536bd02b" title="List of objects for which GUIGlObject::drawGLAdditional is called.">myAdditionallyDrawn</a>[which] - 1;
<a name="l00993"></a>00993     }
<a name="l00994"></a>00994     update();
<a name="l00995"></a>00995     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00996"></a>00996 }
<a name="l00997"></a>00997 
<a name="l00998"></a>00998 
<a name="l00999"></a>00999 <span class="keywordtype">void</span>
<a name="l01000"></a><a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a828f29525f64e0388c850e14f7b360d8">01000</a> <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#a828f29525f64e0388c850e14f7b360d8">GUISUMOAbstractView::applyGLTransform</a>(<span class="keywordtype">bool</span> fixRatio) {
<a name="l01001"></a>01001     <a class="code" href="../../d5/dda/class_boundary.html" title="A class that stores a 2D geometrical boundary.">Boundary</a> bound = <a class="code" href="../../db/d5a/class_g_u_i_s_u_m_o_abstract_view.html#acdef58169896c670a7b80033fb2ef1ed" title="The perspective changer.">myChanger</a>-&gt;<a class="code" href="../../d1/d4e/class_g_u_i_perspective_changer.html#aea56ecc20db34c280f8f6fc2f2030bd4">getViewport</a>(fixRatio);
<a name="l01002"></a>01002     glMatrixMode(GL_PROJECTION);
<a name="l01003"></a>01003     glLoadIdentity();
<a name="l01004"></a>01004     <span class="comment">// as a rough rule, each GLObject is drawn at z = -GUIGlObjectType</span>
<a name="l01005"></a>01005     <span class="comment">// thus, objects with a higher value will be closer (drawn on top)</span>
<a name="l01006"></a>01006     <span class="comment">// // @todo last param should be 0 after modifying all glDraw methods</span>
<a name="l01007"></a>01007     glOrtho(0, getWidth(), 0, getHeight(), -<a class="code" href="../../db/dcf/_g_u_i_gl_object_types_8h.html#af2b60d80f2ed12c3f597887aec83db5ca6543212809249afbaac5dfcce9e55942" title="empty max">GLO_MAX</a> - 1, <a class="code" href="../../db/dcf/_g_u_i_gl_object_types_8h.html#af2b60d80f2ed12c3f597887aec83db5ca6543212809249afbaac5dfcce9e55942" title="empty max">GLO_MAX</a> + 1);
<a name="l01008"></a>01008     glMatrixMode(GL_MODELVIEW);
<a name="l01009"></a>01009     glLoadIdentity();
<a name="l01010"></a>01010     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> scaleX = (<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>)getWidth() / bound.<a class="code" href="../../d5/dda/class_boundary.html#a32ae1fd6f35bbd871344abdaef966c7b" title="Returns the width of the boudary.">getWidth</a>();
<a name="l01011"></a>01011     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> scaleY = (<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>)getHeight() / bound.<a class="code" href="../../d5/dda/class_boundary.html#a9ea2d7003c5b45aed089f0870371d5f6" title="Returns the height of the boundary.">getHeight</a>();
<a name="l01012"></a>01012     glScaled(scaleX, scaleY, 1);
<a name="l01013"></a>01013     glTranslated(-bound.<a class="code" href="../../d5/dda/class_boundary.html#a68c581ea01becd3954fcc808ac476040" title="Returns minimum x-coordinate.">xmin</a>(), -bound.<a class="code" href="../../d5/dda/class_boundary.html#a23f3304d1d057aec6a5255f519cc567d" title="Returns minimum y-coordinate.">ymin</a>(), 0);
<a name="l01014"></a>01014 }
<a name="l01015"></a>01015 
<a name="l01016"></a>01016 <span class="comment">/****************************************************************************/</span>
<a name="l01017"></a>01017 
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Jul 17 12:15:59 2012 for SUMO - Simulation of Urban MObility by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
