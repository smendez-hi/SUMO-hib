<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SUMO - Simulation of Urban MObility: MSBaseVehicle.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="../../dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_46b8f36974b309f038ffc35aa047a32b.html">boni</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_52e5be8ca53cec2b5437a8ba83e8e4f0.html">Desktop</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_7de3ce0f65e0314f747915173f89e60e.html">DanielTouched</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_a0096e276045b3ff0719c75e0b3c59bf.html">sumo-0.14.0</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_e9b8d709919855cd07b0394009af2578.html">src</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_6b4e825611921d20a66b187b0ee8072c.html">microsim</a>
  </div>
</div>
<div class="contents">
<h1>MSBaseVehicle.cpp</h1><a href="../../d8/d3e/_m_s_base_vehicle_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************/</span>
<a name="l00009"></a>00009 <span class="comment">// A base class for vehicle implementations</span>
<a name="l00010"></a>00010 <span class="comment">/****************************************************************************/</span>
<a name="l00011"></a>00011 <span class="comment">// SUMO, Simulation of Urban MObility; see http://sumo.sourceforge.net/</span>
<a name="l00012"></a>00012 <span class="comment">// Copyright (C) 2001-2012 DLR (http://www.dlr.de/) and contributors</span>
<a name="l00013"></a>00013 <span class="comment">/****************************************************************************/</span>
<a name="l00014"></a>00014 <span class="comment">//</span>
<a name="l00015"></a>00015 <span class="comment">//   This file is part of SUMO.</span>
<a name="l00016"></a>00016 <span class="comment">//   SUMO is free software: you can redistribute it and/or modify</span>
<a name="l00017"></a>00017 <span class="comment">//   it under the terms of the GNU General Public License as published by</span>
<a name="l00018"></a>00018 <span class="comment">//   the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00019"></a>00019 <span class="comment">//   (at your option) any later version.</span>
<a name="l00020"></a>00020 <span class="comment">//</span>
<a name="l00021"></a>00021 <span class="comment">/****************************************************************************/</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="comment">// ===========================================================================</span>
<a name="l00025"></a>00025 <span class="comment">// included modules</span>
<a name="l00026"></a>00026 <span class="comment">// ===========================================================================</span>
<a name="l00027"></a>00027 <span class="preprocessor">#ifdef _MSC_VER</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d3/d99/windows__config_8h.html">windows_config.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#else</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../db/d16/config_8h.html">config.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#endif</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="../../da/dbd/_std_defs_8h.html">utils/common/StdDefs.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="../../d4/df7/_msg_handler_8h.html">utils/common/MsgHandler.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d2e/_m_s_vehicle_type_8h.html">MSVehicleType.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../da/dea/_m_s_edge_8h.html">MSEdge.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/d38/_m_s_lane_8h.html">MSLane.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../db/dd5/_m_s_move_reminder_8h.html">MSMoveReminder.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="../../d9/d44/_m_s_device___vehroutes_8h.html">microsim/devices/MSDevice_Vehroutes.h</a>&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;<a class="code" href="../../d5/d55/_m_s_device___tripinfo_8h.html">microsim/devices/MSDevice_Tripinfo.h</a>&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="../../d9/de8/_m_s_device___routing_8h.html">microsim/devices/MSDevice_Routing.h</a>&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;<a class="code" href="../../d5/d10/_m_s_device___person_8h.html">microsim/devices/MSDevice_Person.h</a>&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;<a class="code" href="../../d1/dd8/_m_s_device___h_b_e_f_a_8h.html">microsim/devices/MSDevice_HBEFA.h</a>&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;<a class="code" href="../../d8/d76/_m_s_device___f_e_v_8h.html">microsim/devices/MSDevice_FEV.h</a>&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/da7/_m_s_base_vehicle_8h.html">MSBaseVehicle.h</a>&quot;</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="preprocessor">#ifdef CHECK_MEMORY_LEAKS</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d7/d8d/debug__new_8h.html">foreign/nvwa/debug_new.h</a>&gt;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#endif // CHECK_MEMORY_LEAKS</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="comment">// ===========================================================================</span>
<a name="l00055"></a>00055 <span class="comment">// method definitions</span>
<a name="l00056"></a>00056 <span class="comment">// ===========================================================================</span>
<a name="l00057"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a4b2c6bbe92d0c903f617b77f06395c1c">00057</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a4b2c6bbe92d0c903f617b77f06395c1c" title="Constructor.">MSBaseVehicle::MSBaseVehicle</a>(<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html" title="Structure representing possible vehicle parameter.">SUMOVehicleParameter</a>* pars, <span class="keyword">const</span> <a class="code" href="../../de/dd8/class_m_s_route.html">MSRoute</a>* route, <span class="keyword">const</span> <a class="code" href="../../de/da2/class_m_s_vehicle_type.html" title="The car-following model and parameter.">MSVehicleType</a>* type) :
<a name="l00058"></a>00058     myParameter(pars),
<a name="l00059"></a>00059     myRoute(route),
<a name="l00060"></a>00060     myType(type),
<a name="l00061"></a>00061     myCurrEdge(route-&gt;begin()),
<a name="l00062"></a>00062     myIndividualMaxSpeed(0.0),
<a name="l00063"></a>00063     myHasIndividualMaxSpeed(false),
<a name="l00064"></a>00064     myReferenceSpeed(-1.0),
<a name="l00065"></a>00065     myMoveReminders(0),
<a name="l00066"></a>00066     myDeparture(-1),
<a name="l00067"></a>00067     myArrivalPos(-1),
<a name="l00068"></a>00068     myNumberReroutes(0) {
<a name="l00069"></a>00069     <span class="comment">// init devices</span>
<a name="l00070"></a>00070 
<a name="l00071"></a>00071     <a class="code" href="../../d3/db0/class_m_s_device___vehroutes.html#ac8bdcc94f5c7900a8d997cff5196fb34" title="Build devices for the given vehicle, if needed.">MSDevice_Vehroutes::buildVehicleDevices</a>(*<span class="keyword">this</span>, <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9cd1f3f4aba9025cab8404a95dcae6d8" title="The devices this vehicle has.">myDevices</a>);
<a name="l00072"></a>00072     <a class="code" href="../../d8/dfb/class_m_s_device___tripinfo.html#a47d2d60c2f1e5f127beb76d757f28956" title="Build devices for the given vehicle, if needed.">MSDevice_Tripinfo::buildVehicleDevices</a>(*<span class="keyword">this</span>, <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9cd1f3f4aba9025cab8404a95dcae6d8" title="The devices this vehicle has.">myDevices</a>);
<a name="l00073"></a>00073     <a class="code" href="../../de/da1/class_m_s_device___routing.html#a8f60cdaef2a094bc41627425a362ef29" title="Build devices for the given vehicle, if needed.">MSDevice_Routing::buildVehicleDevices</a>(*<span class="keyword">this</span>, <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9cd1f3f4aba9025cab8404a95dcae6d8" title="The devices this vehicle has.">myDevices</a>);
<a name="l00074"></a>00074     <a class="code" href="../../da/d79/class_m_s_device___h_b_e_f_a.html#a3be4357e8afe239655e1256fc6705d50" title="Build devices for the given vehicle, if needed.">MSDevice_HBEFA::buildVehicleDevices</a>(*<span class="keyword">this</span>, <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9cd1f3f4aba9025cab8404a95dcae6d8" title="The devices this vehicle has.">myDevices</a>);
<a name="l00075"></a>00075     <a class="code" href="../../d1/dfd/class_m_s_device___f_e_v.html#a62318cc86f3de690a0340ee8660a765a" title="Build devices for the given vehicle, if needed.">MSDevice_FEV::buildVehicleDevices</a>(*<span class="keyword">this</span>, <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9cd1f3f4aba9025cab8404a95dcae6d8" title="The devices this vehicle has.">myDevices</a>);
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 
<a name="l00078"></a>00078     <span class="keywordflow">for</span> (std::vector&lt; MSDevice* &gt;::iterator dev = <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9cd1f3f4aba9025cab8404a95dcae6d8" title="The devices this vehicle has.">myDevices</a>.begin(); dev != <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9cd1f3f4aba9025cab8404a95dcae6d8" title="The devices this vehicle has.">myDevices</a>.end(); ++dev) {
<a name="l00079"></a>00079         <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a2fdd6a88fbee98b18e17c61602a18638" title="Current lane&amp;#39;s move reminder.">myMoveReminders</a>.push_back(std::make_pair(*dev, 0.));
<a name="l00080"></a>00080     }
<a name="l00081"></a>00081     <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9d734b6c4adc76c81e0b5be3fdd96a48" title="This Vehicle&amp;#39;s route.">myRoute</a>-&gt;<a class="code" href="../../de/dd8/class_m_s_route.html#a6c90716ed4c237338afbf3b249345264" title="increments the reference counter for the route">addReference</a>();
<a name="l00082"></a>00082     <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a176693feb2a2312be1aca414d27e3373" title="(Re-)Calculates the arrival position from the vehicle parameters">calculateArrivalPos</a>();
<a name="l00083"></a>00083 }
<a name="l00084"></a>00084 
<a name="l00085"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#aba0523f8088515c2e34f7abfc14c1a54">00085</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#aba0523f8088515c2e34f7abfc14c1a54" title="Destructor.">MSBaseVehicle::~MSBaseVehicle</a>() {
<a name="l00086"></a>00086     <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9d734b6c4adc76c81e0b5be3fdd96a48" title="This Vehicle&amp;#39;s route.">myRoute</a>-&gt;<a class="code" href="../../de/dd8/class_m_s_route.html#ad9f4430dbaaeebc843a7d9f01ab5c470" title="deletes the route if there are no further references to it">release</a>();
<a name="l00087"></a>00087     <span class="keyword">delete</span> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae39ca6810ce513cc01b4a48d71f1a060" title="This Vehicle&amp;#39;s parameter.">myParameter</a>;
<a name="l00088"></a>00088     <span class="keywordflow">for</span> (std::vector&lt; MSDevice* &gt;::iterator dev = <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9cd1f3f4aba9025cab8404a95dcae6d8" title="The devices this vehicle has.">myDevices</a>.begin(); dev != <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9cd1f3f4aba9025cab8404a95dcae6d8" title="The devices this vehicle has.">myDevices</a>.end(); ++dev) {
<a name="l00089"></a>00089         <span class="keyword">delete</span>(*dev);
<a name="l00090"></a>00090     }
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="keyword">const</span> std::string&amp;
<a name="l00095"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af558b8f5379ec8f91cb47e9b7d2b7556">00095</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af558b8f5379ec8f91cb47e9b7d2b7556" title="Returns the name of the vehicle.">MSBaseVehicle::getID</a>()<span class="keyword"> const </span>{
<a name="l00096"></a>00096     <span class="keywordflow">return</span> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae39ca6810ce513cc01b4a48d71f1a060" title="This Vehicle&amp;#39;s parameter.">myParameter</a>-&gt;<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#ab39b1071f7e8b20fc560b30685069601" title="The vehicle&amp;#39;s id.">id</a>;
<a name="l00097"></a>00097 }
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 <span class="keyword">const</span> <a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html" title="Structure representing possible vehicle parameter.">SUMOVehicleParameter</a>&amp;
<a name="l00101"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a79d93ef1833e1154d26d5f381ddb33d9">00101</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a79d93ef1833e1154d26d5f381ddb33d9" title="Returns the vehicle&amp;#39;s parameter (including departure definition).">MSBaseVehicle::getParameter</a>()<span class="keyword"> const </span>{
<a name="l00102"></a>00102     <span class="keywordflow">return</span> *<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae39ca6810ce513cc01b4a48d71f1a060" title="This Vehicle&amp;#39;s parameter.">myParameter</a>;
<a name="l00103"></a>00103 }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 <span class="keyword">const</span> <a class="code" href="../../de/dd8/class_m_s_route.html">MSRoute</a>&amp;
<a name="l00107"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ad54c9a2eeea444f4538ac5c405844d46">00107</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ad54c9a2eeea444f4538ac5c405844d46" title="Returns the current route.">MSBaseVehicle::getRoute</a>()<span class="keyword"> const </span>{
<a name="l00108"></a>00108     <span class="keywordflow">return</span> *<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9d734b6c4adc76c81e0b5be3fdd96a48" title="This Vehicle&amp;#39;s route.">myRoute</a>;
<a name="l00109"></a>00109 }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 <span class="keyword">const</span> <a class="code" href="../../de/da2/class_m_s_vehicle_type.html" title="The car-following model and parameter.">MSVehicleType</a>&amp;
<a name="l00113"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af0509244821c3c7c85e64344ca66929c">00113</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af0509244821c3c7c85e64344ca66929c" title="Returns the vehicle&amp;#39;s type definition.">MSBaseVehicle::getVehicleType</a>()<span class="keyword"> const </span>{
<a name="l00114"></a>00114     <span class="keywordflow">return</span> *<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a5891f4fb411d990184f7f62e0fcaca52" title="This Vehicle&amp;#39;s type.">myType</a>;
<a name="l00115"></a>00115 }
<a name="l00116"></a>00116 
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>
<a name="l00119"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a52dce019121d18dc5680d36f2c645512">00119</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a52dce019121d18dc5680d36f2c645512" title="Returns the current maximum speed.">MSBaseVehicle::getMaxSpeed</a>()<span class="keyword"> const </span>{
<a name="l00120"></a>00120     <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a40eb8ae7516849f029036705f93df338" title="is true if there has an individual speed been set">myHasIndividualMaxSpeed</a>) {
<a name="l00121"></a>00121         <span class="keywordflow">return</span> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a4c4488b451c6e44dde8a187a1f0d77aa">myIndividualMaxSpeed</a>;
<a name="l00122"></a>00122     }
<a name="l00123"></a>00123     <span class="keywordflow">return</span> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a5891f4fb411d990184f7f62e0fcaca52" title="This Vehicle&amp;#39;s type.">myType</a>-&gt;<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#addf5daef83140069cd56d337921cb639" title="Get vehicle&amp;#39;s maximum speed [m/s].">getMaxSpeed</a>();
<a name="l00124"></a>00124 }
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>
<a name="l00128"></a>00128 <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ad3faea92e2b5696017b527eb99b484be" title="Adapts the current maximum speed using the distribution given in the type.">MSBaseVehicle::adaptMaxSpeed</a>(<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> referenceSpeed) {
<a name="l00129"></a>00129     <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a5891f4fb411d990184f7f62e0fcaca52" title="This Vehicle&amp;#39;s type.">myType</a>-&gt;<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#a23da119d1a99db84c39348bb7c99888e" title="Get vehicle&amp;#39;s maximum speed [m/s].">hasSpeedDeviation</a>() &amp;&amp; referenceSpeed != <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a83bb86ec99543017667a42679a84fea9" title="the speed which served as reference when calculating the individual maxspeed">myReferenceSpeed</a>) {
<a name="l00130"></a>00130         <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a40eb8ae7516849f029036705f93df338" title="is true if there has an individual speed been set">myHasIndividualMaxSpeed</a> = <span class="keyword">true</span>;
<a name="l00131"></a>00131         <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a4c4488b451c6e44dde8a187a1f0d77aa">myIndividualMaxSpeed</a> = <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a5891f4fb411d990184f7f62e0fcaca52" title="This Vehicle&amp;#39;s type.">myType</a>-&gt;<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#a924a90653c8c0e0efecf46e2d583c356" title="Get vehicle&amp;#39;s maximum speed [m/s] drawn from a normal distribution.">getMaxSpeedWithDeviation</a>(referenceSpeed);
<a name="l00132"></a>00132         <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a83bb86ec99543017667a42679a84fea9" title="the speed which served as reference when calculating the individual maxspeed">myReferenceSpeed</a> = referenceSpeed;
<a name="l00133"></a>00133     }
<a name="l00134"></a>00134     <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a40eb8ae7516849f029036705f93df338" title="is true if there has an individual speed been set">myHasIndividualMaxSpeed</a>) {
<a name="l00135"></a>00135         <span class="keywordflow">return</span> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a4c4488b451c6e44dde8a187a1f0d77aa">myIndividualMaxSpeed</a>;
<a name="l00136"></a>00136     }
<a name="l00137"></a>00137     <span class="keywordflow">return</span> <a class="code" href="../../da/dbd/_std_defs_8h.html#addea5df1107152d65231122e3dfad6fb">MIN2</a>(<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a5891f4fb411d990184f7f62e0fcaca52" title="This Vehicle&amp;#39;s type.">myType</a>-&gt;<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#addf5daef83140069cd56d337921cb639" title="Get vehicle&amp;#39;s maximum speed [m/s].">getMaxSpeed</a>(), referenceSpeed);
<a name="l00138"></a>00138 }
<a name="l00139"></a>00139 
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 <span class="keyword">const</span> <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>*
<a name="l00142"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae52bc5081af9a0556a3b239432a6eb73">00142</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae52bc5081af9a0556a3b239432a6eb73" title="Returns the nSuccs&amp;#39;th successor of edge the vehicle is currently at.">MSBaseVehicle::succEdge</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nSuccs)<span class="keyword"> const </span>{
<a name="l00143"></a>00143     <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a74ef8a75661b17a4c9cf871338ccb6f2" title="Iterator to current route-edge.">myCurrEdge</a> + nSuccs &lt; myRoute-&gt;end()) {
<a name="l00144"></a>00144         <span class="keywordflow">return</span> *(<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a74ef8a75661b17a4c9cf871338ccb6f2" title="Iterator to current route-edge.">myCurrEdge</a> + nSuccs);
<a name="l00145"></a>00145     } <span class="keywordflow">else</span> {
<a name="l00146"></a>00146         <span class="keywordflow">return</span> 0;
<a name="l00147"></a>00147     }
<a name="l00148"></a>00148 }
<a name="l00149"></a>00149 
<a name="l00150"></a>00150 
<a name="l00151"></a>00151 <span class="keyword">const</span> <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>*
<a name="l00152"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a5c164acad4d5151687a2b551ad57fb17">00152</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a5c164acad4d5151687a2b551ad57fb17" title="Returns the edge the vehicle is currently at.">MSBaseVehicle::getEdge</a>()<span class="keyword"> const </span>{
<a name="l00153"></a>00153     <span class="keywordflow">return</span> *<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a74ef8a75661b17a4c9cf871338ccb6f2" title="Iterator to current route-edge.">myCurrEdge</a>;
<a name="l00154"></a>00154 }
<a name="l00155"></a>00155 
<a name="l00156"></a>00156 
<a name="l00157"></a>00157 <span class="keywordtype">void</span>
<a name="l00158"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af5d2ccf436f94ac49fcb8aebdac12cdc">00158</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af5d2ccf436f94ac49fcb8aebdac12cdc" title="Performs a rerouting using the given router.">MSBaseVehicle::reroute</a>(<a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a> t, <a class="code" href="../../d2/d23/class_s_u_m_o_abstract_router.html">SUMOAbstractRouter&lt;MSEdge, SUMOVehicle&gt;</a> &amp;router, <span class="keywordtype">bool</span> withTaz) {
<a name="l00159"></a>00159     <span class="comment">// check whether to reroute</span>
<a name="l00160"></a>00160     std::vector&lt;const MSEdge*&gt; edges;
<a name="l00161"></a>00161     <span class="keywordflow">if</span> (withTaz &amp;&amp; <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae39ca6810ce513cc01b4a48d71f1a060" title="This Vehicle&amp;#39;s parameter.">myParameter</a>-&gt;<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#aeb82af5a3764ba39d9abf513ba7571eb" title="The vehicle&amp;#39;s origin zone (district).">fromTaz</a> + <span class="stringliteral">&quot;-source&quot;</span>) &amp;&amp; <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae39ca6810ce513cc01b4a48d71f1a060" title="This Vehicle&amp;#39;s parameter.">myParameter</a>-&gt;<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#ad65fe60e10e097e0e869239465f46679" title="The vehicle&amp;#39;s destination zone (district).">toTaz</a> + <span class="stringliteral">&quot;-sink&quot;</span>)) {
<a name="l00162"></a>00162         router.<a class="code" href="../../d2/d23/class_s_u_m_o_abstract_router.html#a19048b6ee892db92fa73c1a6d6c15756" title="Builds the route between the given edges using the minimum afford at the given time...">compute</a>(<a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae39ca6810ce513cc01b4a48d71f1a060" title="This Vehicle&amp;#39;s parameter.">myParameter</a>-&gt;<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#aeb82af5a3764ba39d9abf513ba7571eb" title="The vehicle&amp;#39;s origin zone (district).">fromTaz</a> + <span class="stringliteral">&quot;-source&quot;</span>), <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae39ca6810ce513cc01b4a48d71f1a060" title="This Vehicle&amp;#39;s parameter.">myParameter</a>-&gt;<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#ad65fe60e10e097e0e869239465f46679" title="The vehicle&amp;#39;s destination zone (district).">toTaz</a> + <span class="stringliteral">&quot;-sink&quot;</span>), <span class="keyword">this</span>, t, edges);
<a name="l00163"></a>00163         <span class="keywordflow">if</span> (edges.size() &gt;= 2) {
<a name="l00164"></a>00164             edges.erase(edges.begin());
<a name="l00165"></a>00165             edges.pop_back();
<a name="l00166"></a>00166         }
<a name="l00167"></a>00167     } <span class="keywordflow">else</span> {
<a name="l00168"></a>00168         router.<a class="code" href="../../d2/d23/class_s_u_m_o_abstract_router.html#a19048b6ee892db92fa73c1a6d6c15756" title="Builds the route between the given edges using the minimum afford at the given time...">compute</a>(*<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a74ef8a75661b17a4c9cf871338ccb6f2" title="Iterator to current route-edge.">myCurrEdge</a>, <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9d734b6c4adc76c81e0b5be3fdd96a48" title="This Vehicle&amp;#39;s route.">myRoute</a>-&gt;<a class="code" href="../../de/dd8/class_m_s_route.html#ae034685f16f42cfc7b580267d4f95cf1" title="returns the destination edge">getLastEdge</a>(), <span class="keyword">this</span>, t, edges);
<a name="l00169"></a>00169     }
<a name="l00170"></a>00170     <span class="keywordflow">if</span> (edges.empty()) {
<a name="l00171"></a>00171         <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(<span class="stringliteral">&quot;No route for vehicle &#39;&quot;</span> + <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af558b8f5379ec8f91cb47e9b7d2b7556" title="Returns the name of the vehicle.">getID</a>() + <span class="stringliteral">&quot;&#39; found.&quot;</span>);
<a name="l00172"></a>00172         <span class="keywordflow">return</span>;
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174     <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a387005fb4cb0b544f6b8dda528f2777a" title="Replaces the current route by the given edges.">replaceRouteEdges</a>(edges, withTaz);
<a name="l00175"></a>00175 }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 
<a name="l00178"></a>00178 <span class="keywordtype">bool</span>
<a name="l00179"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a387005fb4cb0b544f6b8dda528f2777a">00179</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a387005fb4cb0b544f6b8dda528f2777a" title="Replaces the current route by the given edges.">MSBaseVehicle::replaceRouteEdges</a>(<span class="keyword">const</span> <a class="code" href="../../d3/db6/_m_s_person_8h.html#a5fee2764c12f25c3a26e65fd2f258097">MSEdgeVector</a>&amp; edges, <span class="keywordtype">bool</span> onInit) {
<a name="l00180"></a>00180     <span class="comment">// build a new id, first</span>
<a name="l00181"></a>00181     std::string <span class="keywordtype">id</span> = <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af558b8f5379ec8f91cb47e9b7d2b7556" title="Returns the name of the vehicle.">getID</a>();
<a name="l00182"></a>00182     <span class="keywordflow">if</span> (<span class="keywordtype">id</span>[0] != <span class="charliteral">&#39;!&#39;</span>) {
<a name="l00183"></a>00183         <span class="keywordtype">id</span> = <span class="stringliteral">&quot;!&quot;</span> + id;
<a name="l00184"></a>00184     }
<a name="l00185"></a>00185     <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9d734b6c4adc76c81e0b5be3fdd96a48" title="This Vehicle&amp;#39;s route.">myRoute</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().find(<span class="stringliteral">&quot;!var#&quot;</span>) != std::string::npos) {
<a name="l00186"></a>00186         <span class="keywordtype">id</span> = <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9d734b6c4adc76c81e0b5be3fdd96a48" title="This Vehicle&amp;#39;s route.">myRoute</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().substr(0, <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9d734b6c4adc76c81e0b5be3fdd96a48" title="This Vehicle&amp;#39;s route.">myRoute</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>().rfind(<span class="stringliteral">&quot;!var#&quot;</span>) + 4) + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#aeb8674e4fe981591f541e4b1d8875e3b" title="Returns the number of new routes this vehicle got.">getNumberReroutes</a>() + 1);
<a name="l00187"></a>00187     } <span class="keywordflow">else</span> {
<a name="l00188"></a>00188         <span class="keywordtype">id</span> = <span class="keywordtype">id</span> + <span class="stringliteral">&quot;!var#1&quot;</span>;
<a name="l00189"></a>00189     }
<a name="l00190"></a>00190     <a class="code" href="../../de/dd8/class_m_s_route.html">MSRoute</a>* newRoute = <span class="keyword">new</span> <a class="code" href="../../de/dd8/class_m_s_route.html">MSRoute</a>(<span class="keywordtype">id</span>, edges, 0, <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9d734b6c4adc76c81e0b5be3fdd96a48" title="This Vehicle&amp;#39;s route.">myRoute</a>-&gt;<a class="code" href="../../de/dd8/class_m_s_route.html#ab7f5941cf2537a83cbb306ee2e1a30a0" title="Returns the color.">getColor</a>(), <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9d734b6c4adc76c81e0b5be3fdd96a48" title="This Vehicle&amp;#39;s route.">myRoute</a>-&gt;<a class="code" href="../../de/dd8/class_m_s_route.html#ac72f97a49bcdd6948ad32f73d6baf5f2" title="Returns the stops.">getStops</a>());
<a name="l00191"></a>00191     <span class="keywordflow">if</span> (!<a class="code" href="../../de/dd8/class_m_s_route.html#a379e71c30ffbb0c2366b47f32014980f" title="Adds a route to the dictionary.">MSRoute::dictionary</a>(<span class="keywordtype">id</span>, newRoute)) {
<a name="l00192"></a>00192         <span class="keyword">delete</span> newRoute;
<a name="l00193"></a>00193         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00194"></a>00194     }
<a name="l00195"></a>00195     <span class="keywordflow">if</span> (!<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#aeb02d3a8f486751bcbc4b25a4d09976b" title="Replaces the current route by the given one.">replaceRoute</a>(newRoute, onInit)) {
<a name="l00196"></a>00196         newRoute-&gt;<a class="code" href="../../de/dd8/class_m_s_route.html#a6c90716ed4c237338afbf3b249345264" title="increments the reference counter for the route">addReference</a>();
<a name="l00197"></a>00197         newRoute-&gt;<a class="code" href="../../de/dd8/class_m_s_route.html#ad9f4430dbaaeebc843a7d9f01ab5c470" title="deletes the route if there are no further references to it">release</a>();
<a name="l00198"></a>00198         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00199"></a>00199     }
<a name="l00200"></a>00200     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00201"></a>00201 }
<a name="l00202"></a>00202 
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>
<a name="l00205"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ac300920608569179236ba6dfd569526e">00205</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ac300920608569179236ba6dfd569526e" title="Returns the vehicle&amp;#39;s acceleration before dawdling.">MSBaseVehicle::getPreDawdleAcceleration</a>()<span class="keyword"> const </span>{
<a name="l00206"></a>00206     <span class="keywordflow">return</span> 0;
<a name="l00207"></a>00207 }
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 
<a name="l00210"></a>00210 <span class="keywordtype">void</span>
<a name="l00211"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#acd40d634fb13dd8438c0553ba3c4120d">00211</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#acd40d634fb13dd8438c0553ba3c4120d" title="Called when the vehicle is inserted into the network.">MSBaseVehicle::onDepart</a>() {
<a name="l00212"></a>00212     <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#abd9044c7ae982865548302f58132bd5a" title="The real departure time.">myDeparture</a> = <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;<a class="code" href="../../dc/d5d/class_m_s_net.html#a835b8056e154e434da624033500e1943" title="Returns the current simulation step (in s).">getCurrentTimeStep</a>();
<a name="l00213"></a>00213     <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;<a class="code" href="../../dc/d5d/class_m_s_net.html#a5e74ee833cafefa74b84e2091ef135a3" title="Returns the vehicle control.">getVehicleControl</a>().<a class="code" href="../../db/d2f/class_m_s_vehicle_control.html#a42dff04b079c9852f70ae5969d139168" title="Informs this control about a vehicle&amp;#39;s departure.">vehicleDeparted</a>(*<span class="keyword">this</span>);
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 <a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a>
<a name="l00218"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a1e90d2c30db812dfd579ddb9ac804bb8">00218</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a1e90d2c30db812dfd579ddb9ac804bb8" title="Returns this vehicle&amp;#39;s real departure time.">MSBaseVehicle::getDeparture</a>()<span class="keyword"> const </span>{
<a name="l00219"></a>00219     <span class="keywordflow">return</span> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#abd9044c7ae982865548302f58132bd5a" title="The real departure time.">myDeparture</a>;
<a name="l00220"></a>00220 }
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 
<a name="l00223"></a>00223 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>
<a name="l00224"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#aeb8674e4fe981591f541e4b1d8875e3b">00224</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#aeb8674e4fe981591f541e4b1d8875e3b" title="Returns the number of new routes this vehicle got.">MSBaseVehicle::getNumberReroutes</a>()<span class="keyword"> const </span>{
<a name="l00225"></a>00225     <span class="keywordflow">return</span> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a17aa2315d1bd8621f0304117f603e261" title="The number of reroutings.">myNumberReroutes</a>;
<a name="l00226"></a>00226 }
<a name="l00227"></a>00227 
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 <span class="keywordtype">void</span>
<a name="l00230"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a31832320e929689b17fc4668d2aee025">00230</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a31832320e929689b17fc4668d2aee025" title="Adds a person to this vehicle.">MSBaseVehicle::addPerson</a>(<a class="code" href="../../de/d25/class_m_s_person.html">MSPerson</a>* <span class="comment">/*person*/</span>) {
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 <span class="keywordtype">bool</span>
<a name="l00234"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae12a05c9dc34e4ec82cd553776e7cdbc">00234</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae12a05c9dc34e4ec82cd553776e7cdbc" title="Returns whether the vehicle is at a stop.">MSBaseVehicle::isStopped</a>()<span class="keyword"> const </span>{
<a name="l00235"></a>00235     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00236"></a>00236 }
<a name="l00237"></a>00237 
<a name="l00238"></a>00238 
<a name="l00239"></a>00239 <span class="keywordtype">bool</span>
<a name="l00240"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a3deed8cc382be7fd479a7b30d86b8dc5">00240</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a3deed8cc382be7fd479a7b30d86b8dc5" title="Validates the current route.">MSBaseVehicle::hasValidRoute</a>(std::string&amp; msg)<span class="keyword"> const </span>{
<a name="l00241"></a>00241     <a class="code" href="../../d0/d24/_m_s_route_8h.html#a7253220e09ff4670521e6da98a9fc3f6">MSRouteIterator</a> last = <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9d734b6c4adc76c81e0b5be3fdd96a48" title="This Vehicle&amp;#39;s route.">myRoute</a>-&gt;<a class="code" href="../../de/dd8/class_m_s_route.html#a46a50e341d78ea7ac195dbfaf9fa7367" title="Returns the end of the list of edges to pass.">end</a>() - 1;
<a name="l00242"></a>00242     <span class="comment">// check connectivity, first</span>
<a name="l00243"></a>00243     <span class="keywordflow">for</span> (<a class="code" href="../../d0/d24/_m_s_route_8h.html#a7253220e09ff4670521e6da98a9fc3f6">MSRouteIterator</a> e = <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a74ef8a75661b17a4c9cf871338ccb6f2" title="Iterator to current route-edge.">myCurrEdge</a>; e != last; ++e) {
<a name="l00244"></a>00244         <span class="keywordflow">if</span> ((*e)-&gt;allowedLanes(**(e + 1), <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a5891f4fb411d990184f7f62e0fcaca52" title="This Vehicle&amp;#39;s type.">myType</a>-&gt;<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#ac0b28516cbc8c572f58edc8d01348cb1" title="Get this vehicle type&amp;#39;s vehicle class.">getVehicleClass</a>()) == 0) {
<a name="l00245"></a>00245             msg = <span class="stringliteral">&quot;No connection between &#39;&quot;</span> + (*e)-&gt;getID() + <span class="stringliteral">&quot;&#39; and &#39;&quot;</span> + (*(e + 1))-&gt;getID() + <span class="stringliteral">&quot;&#39;.&quot;</span>;
<a name="l00246"></a>00246             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00247"></a>00247         }
<a name="l00248"></a>00248     }
<a name="l00249"></a>00249     last = <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9d734b6c4adc76c81e0b5be3fdd96a48" title="This Vehicle&amp;#39;s route.">myRoute</a>-&gt;<a class="code" href="../../de/dd8/class_m_s_route.html#a46a50e341d78ea7ac195dbfaf9fa7367" title="Returns the end of the list of edges to pass.">end</a>();
<a name="l00250"></a>00250     <span class="comment">// check usable lanes, then</span>
<a name="l00251"></a>00251     <span class="keywordflow">for</span> (<a class="code" href="../../d0/d24/_m_s_route_8h.html#a7253220e09ff4670521e6da98a9fc3f6">MSRouteIterator</a> e = <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a74ef8a75661b17a4c9cf871338ccb6f2" title="Iterator to current route-edge.">myCurrEdge</a>; e != last; ++e) {
<a name="l00252"></a>00252         <span class="keywordflow">if</span> ((*e)-&gt;prohibits(<span class="keyword">this</span>)) {
<a name="l00253"></a>00253             msg = <span class="stringliteral">&quot;Edge &#39;&quot;</span> + (*e)-&gt;getID() + <span class="stringliteral">&quot;&#39; prohibits.&quot;</span>;
<a name="l00254"></a>00254             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00255"></a>00255         }
<a name="l00256"></a>00256     }
<a name="l00257"></a>00257     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00258"></a>00258 }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 
<a name="l00261"></a>00261 <span class="keywordtype">void</span>
<a name="l00262"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a32bbfcef95b3ea0c42d77b5e9921b953">00262</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a32bbfcef95b3ea0c42d77b5e9921b953" title="Adds a MoveReminder dynamically.">MSBaseVehicle::addReminder</a>(<a class="code" href="../../d2/da5/class_m_s_move_reminder.html" title="Something on a lane to be noticed about vehicle movement.">MSMoveReminder</a>* rem) {
<a name="l00263"></a>00263     <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a2fdd6a88fbee98b18e17c61602a18638" title="Current lane&amp;#39;s move reminder.">myMoveReminders</a>.push_back(std::make_pair(rem, 0.));
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="keywordtype">void</span>
<a name="l00268"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ace7ce0d7b5bc12c1002655df729a16f4">00268</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ace7ce0d7b5bc12c1002655df729a16f4" title="Removes a MoveReminder dynamically.">MSBaseVehicle::removeReminder</a>(<a class="code" href="../../d2/da5/class_m_s_move_reminder.html" title="Something on a lane to be noticed about vehicle movement.">MSMoveReminder</a>* rem) {
<a name="l00269"></a>00269     <span class="keywordflow">for</span> (MoveReminderCont::iterator r = <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a2fdd6a88fbee98b18e17c61602a18638" title="Current lane&amp;#39;s move reminder.">myMoveReminders</a>.begin(); r != <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a2fdd6a88fbee98b18e17c61602a18638" title="Current lane&amp;#39;s move reminder.">myMoveReminders</a>.end(); ++r) {
<a name="l00270"></a>00270         <span class="keywordflow">if</span> (r-&gt;first == rem) {
<a name="l00271"></a>00271             <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a2fdd6a88fbee98b18e17c61602a18638" title="Current lane&amp;#39;s move reminder.">myMoveReminders</a>.erase(r);
<a name="l00272"></a>00272             <span class="keywordflow">return</span>;
<a name="l00273"></a>00273         }
<a name="l00274"></a>00274     }
<a name="l00275"></a>00275 }
<a name="l00276"></a>00276 
<a name="l00277"></a>00277 
<a name="l00278"></a>00278 <span class="keywordtype">void</span>
<a name="l00279"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a850fe60662c895774ddd29321b06c566">00279</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a850fe60662c895774ddd29321b06c566" title="&amp;quot;Activates&amp;quot; all current move reminder">MSBaseVehicle::activateReminders</a>(<span class="keyword">const</span> <a class="code" href="../../d2/da5/class_m_s_move_reminder.html#a9bb933702facf0323c2541dfb8d5c208" title="Definition of a vehicle state.">MSMoveReminder::Notification</a> reason) {
<a name="l00280"></a>00280     <span class="keywordflow">for</span> (MoveReminderCont::iterator rem = <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a2fdd6a88fbee98b18e17c61602a18638" title="Current lane&amp;#39;s move reminder.">myMoveReminders</a>.begin(); rem != <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a2fdd6a88fbee98b18e17c61602a18638" title="Current lane&amp;#39;s move reminder.">myMoveReminders</a>.end();) {
<a name="l00281"></a>00281         <span class="keywordflow">if</span> (rem-&gt;first-&gt;notifyEnter(*<span class="keyword">this</span>, reason)) {
<a name="l00282"></a>00282             ++rem;
<a name="l00283"></a>00283         } <span class="keywordflow">else</span> {
<a name="l00284"></a>00284             rem = <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a2fdd6a88fbee98b18e17c61602a18638" title="Current lane&amp;#39;s move reminder.">myMoveReminders</a>.erase(rem);
<a name="l00285"></a>00285         }
<a name="l00286"></a>00286     }
<a name="l00287"></a>00287 }
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 
<a name="l00290"></a>00290 <span class="keywordtype">void</span>
<a name="l00291"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a176693feb2a2312be1aca414d27e3373">00291</a> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a176693feb2a2312be1aca414d27e3373" title="(Re-)Calculates the arrival position from the vehicle parameters">MSBaseVehicle::calculateArrivalPos</a>() {
<a name="l00292"></a>00292     <span class="keyword">const</span> <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> lastLaneLength = (<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a9d734b6c4adc76c81e0b5be3fdd96a48" title="This Vehicle&amp;#39;s route.">myRoute</a>-&gt;<a class="code" href="../../de/dd8/class_m_s_route.html#ae034685f16f42cfc7b580267d4f95cf1" title="returns the destination edge">getLastEdge</a>()-&gt;<a class="code" href="../../d7/d27/class_m_s_edge.html#ac6454be7984c840da4fa48808cf22833" title="Returns this edge&amp;#39;s lanes.">getLanes</a>())[0]-&gt;getLength();
<a name="l00293"></a>00293     <span class="keywordflow">switch</span> (<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae39ca6810ce513cc01b4a48d71f1a060" title="This Vehicle&amp;#39;s parameter.">myParameter</a>-&gt;<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#ac37d1a33b08a5546555b2a502add8a13" title="Information how the vehicle shall choose the arrival position.">arrivalPosProcedure</a>) {
<a name="l00294"></a>00294         <span class="keywordflow">case</span> <a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#abf4823ced117f4abbbe56d70852e9d51a8bed731c1d295182c92bf9e3fcfb0967" title="The arrival position is given.">ARRIVAL_POS_GIVEN</a>:
<a name="l00295"></a>00295             <span class="comment">// Maybe we should warn the user about invalid inputs!</span>
<a name="l00296"></a>00296             <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#afd710496383af73ec9caee1dcb674a5a" title="the position on the destination lane where the vehicle stops">myArrivalPos</a> = <a class="code" href="../../da/dbd/_std_defs_8h.html#addea5df1107152d65231122e3dfad6fb">MIN2</a>(<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae39ca6810ce513cc01b4a48d71f1a060" title="This Vehicle&amp;#39;s parameter.">myParameter</a>-&gt;<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a1048b36a7f3b1ca87af10443a789fb5e" title="(optional) The position the vehicle shall arrive on">arrivalPos</a>, lastLaneLength);
<a name="l00297"></a>00297             <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#afd710496383af73ec9caee1dcb674a5a" title="the position on the destination lane where the vehicle stops">myArrivalPos</a> &lt; 0) {
<a name="l00298"></a>00298                 <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#afd710496383af73ec9caee1dcb674a5a" title="the position on the destination lane where the vehicle stops">myArrivalPos</a> = <a class="code" href="../../da/dbd/_std_defs_8h.html#a3c4556662cf5cb93067cdc7365aecbcd">MAX2</a>(<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#afd710496383af73ec9caee1dcb674a5a" title="the position on the destination lane where the vehicle stops">myArrivalPos</a> + lastLaneLength, static_cast&lt;SUMOReal&gt;(0));
<a name="l00299"></a>00299             }
<a name="l00300"></a>00300             <span class="keywordflow">break</span>;
<a name="l00301"></a>00301         <span class="keywordflow">case</span> <a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#abf4823ced117f4abbbe56d70852e9d51a38619dc06d5d4327231b0598786eea4f" title="The arrival position is chosen randomly.">ARRIVAL_POS_RANDOM</a>:
<a name="l00302"></a>00302             <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#afd710496383af73ec9caee1dcb674a5a" title="the position on the destination lane where the vehicle stops">myArrivalPos</a> = <a class="code" href="../../d2/d65/class_rand_helper.html#aef69dc4be902eb96aad293ce4aee51c9" title="Returns a random real number in [0, 1).">RandHelper::rand</a>(static_cast&lt;SUMOReal&gt;(0), lastLaneLength);
<a name="l00303"></a>00303             <span class="keywordflow">break</span>;
<a name="l00304"></a>00304         <span class="keywordflow">case</span> <a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#abf4823ced117f4abbbe56d70852e9d51a262aef4471ebc840626b0184900cf5c1" title="The maximum arrival position is used.">ARRIVAL_POS_MAX</a>:
<a name="l00305"></a>00305         <span class="keywordflow">case</span> <a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#abf4823ced117f4abbbe56d70852e9d51a1f99eb5c79db5ff5b68f13bbaaec89a0" title="No information given; use default.">ARRIVAL_POS_DEFAULT</a>:
<a name="l00306"></a>00306             <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#afd710496383af73ec9caee1dcb674a5a" title="the position on the destination lane where the vehicle stops">myArrivalPos</a> = lastLaneLength;
<a name="l00307"></a>00307             <span class="keywordflow">break</span>;
<a name="l00308"></a>00308     }
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a><a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae4fcc0e9f7db45b05153b13c5bc4806c">00311</a> <span class="keyword">const</span> <a class="code" href="../../de/da2/class_m_s_vehicle_type.html" title="The car-following model and parameter.">MSVehicleType</a> *<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ae4fcc0e9f7db45b05153b13c5bc4806c">MSBaseVehicle::getMyType</a>()<span class="keyword"> const</span>
<a name="l00312"></a>00312 <span class="keyword"></span>{
<a name="l00313"></a>00313     <span class="keywordflow">return</span> <a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a5891f4fb411d990184f7f62e0fcaca52" title="This Vehicle&amp;#39;s type.">myType</a>;
<a name="l00314"></a>00314 }
<a name="l00315"></a>00315 
<a name="l00316"></a>00316 
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 
<a name="l00319"></a>00319 <span class="comment">/****************************************************************************/</span>
<a name="l00320"></a>00320 
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Jul 17 12:16:00 2012 for SUMO - Simulation of Urban MObility by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
