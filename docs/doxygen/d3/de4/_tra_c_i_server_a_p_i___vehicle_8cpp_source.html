<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SUMO - Simulation of Urban MObility: TraCIServerAPI_Vehicle.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="../../dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_46b8f36974b309f038ffc35aa047a32b.html">boni</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_52e5be8ca53cec2b5437a8ba83e8e4f0.html">Desktop</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_7de3ce0f65e0314f747915173f89e60e.html">DanielTouched</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_a0096e276045b3ff0719c75e0b3c59bf.html">sumo-0.14.0</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_e9b8d709919855cd07b0394009af2578.html">src</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_321e1e012996dae673e7b6b67cce78a7.html">traci-server</a>
  </div>
</div>
<div class="contents">
<h1>TraCIServerAPI_Vehicle.cpp</h1><a href="../../d3/de4/_tra_c_i_server_a_p_i___vehicle_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************/</span>
<a name="l00011"></a>00011 <span class="comment">// APIs for getting/setting vehicle values via TraCI</span>
<a name="l00012"></a>00012 <span class="comment">/****************************************************************************/</span>
<a name="l00013"></a>00013 <span class="comment">// SUMO, Simulation of Urban MObility; see http://sumo.sourceforge.net/</span>
<a name="l00014"></a>00014 <span class="comment">// Copyright (C) 2001-2012 DLR (http://www.dlr.de/) and contributors</span>
<a name="l00015"></a>00015 <span class="comment">/****************************************************************************/</span>
<a name="l00016"></a>00016 <span class="comment">//</span>
<a name="l00017"></a>00017 <span class="comment">//   This file is part of SUMO.</span>
<a name="l00018"></a>00018 <span class="comment">//   SUMO is free software: you can redistribute it and/or modify</span>
<a name="l00019"></a>00019 <span class="comment">//   it under the terms of the GNU General Public License as published by</span>
<a name="l00020"></a>00020 <span class="comment">//   the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00021"></a>00021 <span class="comment">//   (at your option) any later version.</span>
<a name="l00022"></a>00022 <span class="comment">//</span>
<a name="l00023"></a>00023 <span class="comment">/****************************************************************************/</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="comment">// ===========================================================================</span>
<a name="l00027"></a>00027 <span class="comment">// included modules</span>
<a name="l00028"></a>00028 <span class="comment">// ===========================================================================</span>
<a name="l00029"></a>00029 <span class="preprocessor">#ifdef _MSC_VER</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d3/d99/windows__config_8h.html">windows_config.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#else</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../db/d16/config_8h.html">config.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#endif</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="../../d9/dfa/_m_s_net_8h.html">microsim/MSNet.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="../../d8/daf/_m_s_insertion_control_8h.html">microsim/MSInsertionControl.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="../../dc/d38/_m_s_vehicle_8h.html">microsim/MSVehicle.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/d38/_m_s_lane_8h.html">microsim/MSLane.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="../../da/dea/_m_s_edge_8h.html">microsim/MSEdge.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="../../d2/d74/_m_s_edge_weights_storage_8h.html">microsim/MSEdgeWeightsStorage.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="../../df/dbe/_m_s_abstract_lane_change_model_8h.html">microsim/MSAbstractLaneChangeModel.h</a>&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/d43/_position_vector_8h.html">utils/geom/PositionVector.h</a>&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="../../d6/d78/_dijkstra_router_t_t_8h.html">utils/common/DijkstraRouterTT.h</a>&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;<a class="code" href="../../d0/dd7/_dijkstra_router_effort_8h.html">utils/common/DijkstraRouterEffort.h</a>&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;<a class="code" href="../../d9/d51/_helpers_h_b_e_f_a_8h.html">utils/common/HelpersHBEFA.h</a>&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;<a class="code" href="../../de/d1a/_helpers_harmonoise_8h.html">utils/common/HelpersHarmonoise.h</a>&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;<a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html">utils/common/SUMOVehicleParameter.h</a>&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html">TraCIConstants.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/df3/_tra_c_i_server_a_p_i___simulation_8h.html">TraCIServerAPI_Simulation.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/da4/_tra_c_i_server_a_p_i___vehicle_8h.html">TraCIServerAPI_Vehicle.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="../../dd/d42/_tra_c_i_server_a_p_i___vehicle_type_8h.html">TraCIServerAPI_VehicleType.h</a>&quot;</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="preprocessor">#ifdef CHECK_MEMORY_LEAKS</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d7/d8d/debug__new_8h.html">foreign/nvwa/debug_new.h</a>&gt;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#endif // CHECK_MEMORY_LEAKS</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="comment">// ===========================================================================</span>
<a name="l00059"></a>00059 <span class="comment">// used namespaces</span>
<a name="l00060"></a>00060 <span class="comment">// ===========================================================================</span>
<a name="l00061"></a>00061 <span class="keyword">using namespace </span>traci;
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="comment">// ===========================================================================</span>
<a name="l00065"></a>00065 <span class="comment">// method definitions</span>
<a name="l00066"></a>00066 <span class="comment">// ===========================================================================</span>
<a name="l00067"></a>00067 <span class="keywordtype">bool</span>
<a name="l00068"></a><a class="code" href="../../d9/d85/class_tra_c_i_server_a_p_i___vehicle.html#a4ac98a631ffe2a17d1084d789c3ab5ff">00068</a> <a class="code" href="../../d9/d85/class_tra_c_i_server_a_p_i___vehicle.html#a4ac98a631ffe2a17d1084d789c3ab5ff" title="Processes a get value command (Command 0xa4: Get Vehicle Variable).">TraCIServerAPI_Vehicle::processGet</a>(<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html">TraCIServer</a>&amp; server, tcpip::Storage&amp; inputStorage,
<a name="l00069"></a>00069                                    tcpip::Storage&amp; outputStorage) {
<a name="l00070"></a>00070     std::string warning = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// additional description for response</span>
<a name="l00071"></a>00071     <span class="comment">// variable &amp; id</span>
<a name="l00072"></a>00072     <span class="keywordtype">int</span> variable = inputStorage.readUnsignedByte();
<a name="l00073"></a>00073     std::string <span class="keywordtype">id</span> = inputStorage.readString();
<a name="l00074"></a>00074     <span class="comment">// check variable</span>
<a name="l00075"></a>00075     <span class="keywordflow">if</span> (variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a28687ff0fca27086bca2dfb0c0aa8708">ID_LIST</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a803f3a1743aef11a357e838e50d80f6a">VAR_SPEED</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a152867a4fb7b5bbc0557db0511384503">VAR_SPEED_WITHOUT_TRACI</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a40ee44d232bc7661ec5a37bacd60702e">VAR_POSITION</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aef6ef58b8c84169ca96fc70f9c5cee8c">VAR_ANGLE</a>
<a name="l00076"></a>00076             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a006ca3246206d575bc949da18c7d075b">VAR_ROAD_ID</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#afb32e44c504d7f1bd7f7ba1fb3a56a71">VAR_LANE_ID</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a19d2b339169244a09db78bb764fadd62">VAR_LANE_INDEX</a>
<a name="l00077"></a>00077             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ae136061e5a4bf896d9cfb27868baf9fb">VAR_TYPE</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a48cbe1bf5748e27183054ed2ddcfa3ae">VAR_ROUTE_ID</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#adcc89457ed75668afd992c756fc58549">VAR_COLOR</a>
<a name="l00078"></a>00078             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4493c1eaff38410b9afd3b5ec86e760e">VAR_LANEPOSITION</a>
<a name="l00079"></a>00079             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#adcc6403451c32bda03d9563843f4eb23">VAR_CO2EMISSION</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a55f8fd37376dc3adc19fc6e2ceaf53ce">VAR_COEMISSION</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aaa0aad5c649d543d8de81bdb22d06664">VAR_HCEMISSION</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a37217bdbf8be36dc1bd44ecd62a807a4">VAR_PMXEMISSION</a>
<a name="l00080"></a>00080             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a89457fa8c4ae6bd5adf6cc97860d08bd">VAR_NOXEMISSION</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#acdec282d3916d2d2ec373cd6f5f5e977">VAR_FUELCONSUMPTION</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54cb80eb2dc3f07710f64ca77f9b732d">VAR_NOISEEMISSION</a>
<a name="l00081"></a>00081             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aa03c145ea3d6ed1039ee650ad0599452">VAR_EDGE_TRAVELTIME</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a82afe862545ade0192be2788e5b29f82">VAR_EDGE_EFFORT</a>
<a name="l00082"></a>00082             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a817e029aaf52b9bd33c3115af6384e0c">VAR_ROUTE_VALID</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ada001729364b89aa926730f631d6e429">VAR_EDGES</a>
<a name="l00083"></a>00083             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a7378a076f1ed4fb133d04d474ec36110">VAR_SIGNALS</a>
<a name="l00084"></a>00084             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a60e947bd75233810d5417b41f27e68df">VAR_LENGTH</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a1f8d8754eb24cd09fb3107a3f71bf76b">VAR_MAXSPEED</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5cdedbf9fd0353a0a7c60982b4bd1494">VAR_VEHICLECLASS</a>
<a name="l00085"></a>00085             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac73c5a63a7ba70a57e9f2162277799db">VAR_SPEED_FACTOR</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aaa434a0096961983f3ca1fddbeb73b3a">VAR_SPEED_DEVIATION</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a46a1e04d43660551e055d44f2d0ca41c">VAR_EMISSIONCLASS</a>
<a name="l00086"></a>00086             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#adb08f65a6543f976dbfe6ee7db5d08a2">VAR_WIDTH</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aea443b43de4353bbaab7f34d303afe3c">VAR_MINGAP</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a0f50ad2a0f01241405381b9e895ab2d6">VAR_SHAPECLASS</a>
<a name="l00087"></a>00087             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aafdce9f42320b3e72c814cceaab9809c">VAR_ACCEL</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4f883334365d5c2e0f18944be814441f">VAR_DECEL</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac98dc6e9bc82ae734fa638762f81eca6">VAR_IMPERFECTION</a>
<a name="l00088"></a>00088             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8d32ba4c4cc7e453e9b63426d84eb084">VAR_TAU</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a547dc5b69db59f7d5919f1e295469049">VAR_BEST_LANES</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a92f25b953319f56d635ea4fe599d65c1">DISTANCE_REQUEST</a>
<a name="l00089"></a>00089             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a10ef5e45606c2977dd1eaf386f5d3de6">ID_COUNT</a>
<a name="l00090"></a>00090        ) {
<a name="l00091"></a>00091         server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Get Vehicle Variable: unsupported variable specified&quot;</span>, outputStorage);
<a name="l00092"></a>00092         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00093"></a>00093     }
<a name="l00094"></a>00094     <span class="comment">// begin response building</span>
<a name="l00095"></a>00095     tcpip::Storage tempMsg;
<a name="l00096"></a>00096     <span class="comment">//  response-code, variableID, objectID</span>
<a name="l00097"></a>00097     tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8efb67d70d2b7c6b86d9d99a40806e2f">RESPONSE_GET_VEHICLE_VARIABLE</a>);
<a name="l00098"></a>00098     tempMsg.writeUnsignedByte(variable);
<a name="l00099"></a>00099     tempMsg.writeString(<span class="keywordtype">id</span>);
<a name="l00100"></a>00100     <span class="comment">// process request</span>
<a name="l00101"></a>00101     <span class="keywordflow">if</span> (variable == <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a28687ff0fca27086bca2dfb0c0aa8708">ID_LIST</a> || variable == <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a10ef5e45606c2977dd1eaf386f5d3de6">ID_COUNT</a>) {
<a name="l00102"></a>00102         std::vector&lt;std::string&gt; ids;
<a name="l00103"></a>00103         <a class="code" href="../../db/d2f/class_m_s_vehicle_control.html" title="The class responsible for building and deletion of vehicles.">MSVehicleControl</a>&amp; c = <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;<a class="code" href="../../dc/d5d/class_m_s_net.html#a5e74ee833cafefa74b84e2091ef135a3" title="Returns the vehicle control.">getVehicleControl</a>();
<a name="l00104"></a>00104         <span class="keywordflow">for</span> (<a class="code" href="../../db/d2f/class_m_s_vehicle_control.html#a0e316cb9bba72dd2a8263f1929a99044" title="Definition of the internal vehicles map iterator.">MSVehicleControl::constVehIt</a> i = c.<a class="code" href="../../db/d2f/class_m_s_vehicle_control.html#a7637268cf9923d7d804052f67cf20ae3" title="Returns the begin of the internal vehicle map.">loadedVehBegin</a>(); i != c.<a class="code" href="../../db/d2f/class_m_s_vehicle_control.html#a55128c77480ced4740629987a061f5ac" title="Returns the end of the internal vehicle map.">loadedVehEnd</a>(); ++i) {
<a name="l00105"></a>00105             <span class="keywordflow">if</span> ((*i).second-&gt;isOnRoad()) {
<a name="l00106"></a>00106                 ids.push_back((*i).first);
<a name="l00107"></a>00107             }
<a name="l00108"></a>00108         }
<a name="l00109"></a>00109         <span class="keywordflow">if</span> (variable == <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a28687ff0fca27086bca2dfb0c0aa8708">ID_LIST</a>) {
<a name="l00110"></a>00110             tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5561b6050ea28ec6d322e28848460c17">TYPE_STRINGLIST</a>);
<a name="l00111"></a>00111             tempMsg.writeStringList(ids);
<a name="l00112"></a>00112         } <span class="keywordflow">else</span> {
<a name="l00113"></a>00113             tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>);
<a name="l00114"></a>00114             tempMsg.writeInt((<span class="keywordtype">int</span>) ids.size());
<a name="l00115"></a>00115         }
<a name="l00116"></a>00116     } <span class="keywordflow">else</span> {
<a name="l00117"></a>00117         <a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>* v = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;<a class="code" href="../../dc/d5d/class_m_s_net.html#a5e74ee833cafefa74b84e2091ef135a3" title="Returns the vehicle control.">getVehicleControl</a>().<a class="code" href="../../db/d2f/class_m_s_vehicle_control.html#a7e0bba043cf6d995661667fc4961f0a3" title="Returns the vehicle with the given id.">getVehicle</a>(<span class="keywordtype">id</span>));
<a name="l00118"></a>00118         <span class="keywordflow">if</span> (v == 0) {
<a name="l00119"></a>00119             server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Vehicle &#39;&quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot;&#39; is not known&quot;</span>, outputStorage);
<a name="l00120"></a>00120             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00121"></a>00121         }
<a name="l00122"></a>00122         <span class="keyword">const</span> <span class="keywordtype">bool</span> onRoad = v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a9c57b7d54c70b1d5c7b2db6434c2c7e0" title="Returns the information whether the vehicle is on a road (is simulated).">isOnRoad</a>();
<a name="l00123"></a>00123         <span class="keywordflow">switch</span> (variable) {
<a name="l00124"></a>00124             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a803f3a1743aef11a357e838e50d80f6a">VAR_SPEED</a>:
<a name="l00125"></a>00125                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00126"></a>00126                 tempMsg.writeDouble(onRoad ? v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#ac6847bb54de8bdf75ddb8e2fc689cb2e" title="Returns the vehicle&amp;#39;s current speed.">getSpeed</a>() : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00127"></a>00127                 <span class="keywordflow">break</span>;
<a name="l00128"></a>00128             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a152867a4fb7b5bbc0557db0511384503">VAR_SPEED_WITHOUT_TRACI</a>:
<a name="l00129"></a>00129                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00130"></a>00130                 tempMsg.writeDouble(onRoad ? v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#af7094df359b127b37dee127d66a76ca7" title="Returns the uninfluenced velocity.">getSpeedWithoutTraciInfluence</a>() : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00131"></a>00131                 <span class="keywordflow">break</span>;
<a name="l00132"></a>00132             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a40ee44d232bc7661ec5a37bacd60702e">VAR_POSITION</a>:
<a name="l00133"></a>00133                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a9fc3eb37a8ae494084b863c411cf8c17">POSITION_2D</a>);
<a name="l00134"></a>00134                 tempMsg.writeDouble(onRoad ? v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a0e464e17d48501f4515b5ede67306a73" title="Return current position (x/y, cartesian).">getPosition</a>().<a class="code" href="../../d7/d3b/class_position.html#a51c33a67d08730631a34482850b2203b" title="Returns the x-position.">x</a>() : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00135"></a>00135                 tempMsg.writeDouble(onRoad ? v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a0e464e17d48501f4515b5ede67306a73" title="Return current position (x/y, cartesian).">getPosition</a>().<a class="code" href="../../d7/d3b/class_position.html#a4a65556f1de2548b23ce662f81c7ab1a" title="Returns the y-position.">y</a>() : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00136"></a>00136                 <span class="keywordflow">break</span>;
<a name="l00137"></a>00137             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aef6ef58b8c84169ca96fc70f9c5cee8c">VAR_ANGLE</a>:
<a name="l00138"></a>00138                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00139"></a>00139                 tempMsg.writeDouble(onRoad ? v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a58306cace8fdb949c89fefb3279220f8" title="Returns the vehicle&amp;#39;s direction in degrees.">getAngle</a>() : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00140"></a>00140                 <span class="keywordflow">break</span>;
<a name="l00141"></a>00141             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a006ca3246206d575bc949da18c7d075b">VAR_ROAD_ID</a>:
<a name="l00142"></a>00142                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>);
<a name="l00143"></a>00143                 tempMsg.writeString(onRoad ? v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a7ed3e152a9a05f5629b84d443fe428bb" title="Returns the lane the vehicle is on.">getLane</a>()-&gt;<a class="code" href="../../d9/d16/class_m_s_lane.html#ad689e4b858799c088f315442527a814f" title="Returns the lane&amp;#39;s edge.">getEdge</a>().<a class="code" href="../../d7/d27/class_m_s_edge.html#a715096baba12f1f89b7bc1bedd6df1b5" title="Returns the id of the edge.">getID</a>() : <span class="stringliteral">&quot;&quot;</span>);
<a name="l00144"></a>00144                 <span class="keywordflow">break</span>;
<a name="l00145"></a>00145             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#afb32e44c504d7f1bd7f7ba1fb3a56a71">VAR_LANE_ID</a>:
<a name="l00146"></a>00146                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>);
<a name="l00147"></a>00147                 tempMsg.writeString(onRoad ? v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a7ed3e152a9a05f5629b84d443fe428bb" title="Returns the lane the vehicle is on.">getLane</a>()-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>() : <span class="stringliteral">&quot;&quot;</span>);
<a name="l00148"></a>00148                 <span class="keywordflow">break</span>;
<a name="l00149"></a>00149             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a19d2b339169244a09db78bb764fadd62">VAR_LANE_INDEX</a>:
<a name="l00150"></a>00150                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>);
<a name="l00151"></a>00151                 <span class="keywordflow">if</span> (onRoad) {
<a name="l00152"></a>00152                     <span class="keyword">const</span> std::vector&lt;MSLane*&gt; &amp;lanes = v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a7ed3e152a9a05f5629b84d443fe428bb" title="Returns the lane the vehicle is on.">getLane</a>()-&gt;<a class="code" href="../../d9/d16/class_m_s_lane.html#ad689e4b858799c088f315442527a814f" title="Returns the lane&amp;#39;s edge.">getEdge</a>().<a class="code" href="../../d7/d27/class_m_s_edge.html#ac6454be7984c840da4fa48808cf22833" title="Returns this edge&amp;#39;s lanes.">getLanes</a>();
<a name="l00153"></a>00153                     tempMsg.writeInt((<span class="keywordtype">int</span>)std::distance(lanes.begin(), std::find(lanes.begin(), lanes.end(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a7ed3e152a9a05f5629b84d443fe428bb" title="Returns the lane the vehicle is on.">getLane</a>())));
<a name="l00154"></a>00154                 } <span class="keywordflow">else</span> {
<a name="l00155"></a>00155                     tempMsg.writeInt(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5722d9b8df900cf44a69151b6f4b1e8b">INVALID_INT_VALUE</a>);
<a name="l00156"></a>00156                 }
<a name="l00157"></a>00157                 <span class="keywordflow">break</span>;
<a name="l00158"></a>00158             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ae136061e5a4bf896d9cfb27868baf9fb">VAR_TYPE</a>:
<a name="l00159"></a>00159                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>);
<a name="l00160"></a>00160                 tempMsg.writeString(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af0509244821c3c7c85e64344ca66929c" title="Returns the vehicle&amp;#39;s type definition.">getVehicleType</a>().<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#ad6dc1278af1ab98cbbc19d924739f766" title="Returns the name of the vehicle type.">getID</a>());
<a name="l00161"></a>00161                 <span class="keywordflow">break</span>;
<a name="l00162"></a>00162             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a48cbe1bf5748e27183054ed2ddcfa3ae">VAR_ROUTE_ID</a>:
<a name="l00163"></a>00163                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>);
<a name="l00164"></a>00164                 tempMsg.writeString(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ad54c9a2eeea444f4538ac5c405844d46" title="Returns the current route.">getRoute</a>().<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>());
<a name="l00165"></a>00165                 <span class="keywordflow">break</span>;
<a name="l00166"></a>00166             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#adcc89457ed75668afd992c756fc58549">VAR_COLOR</a>:
<a name="l00167"></a>00167                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4a2941e13cc0bd28c847984e7f573850">TYPE_COLOR</a>);
<a name="l00168"></a>00168                 tempMsg.writeUnsignedByte(static_cast&lt;int&gt;(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a79d93ef1833e1154d26d5f381ddb33d9" title="Returns the vehicle&amp;#39;s parameter (including departure definition).">getParameter</a>().<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a9f2aaf24a7bd52568405319ebc2283b3" title="The vehicle&amp;#39;s color.">color</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#af3739c0c10661723552770c0996ad7c2" title="Returns the red-amount of the color.">red</a>() * 255. + 0.5));
<a name="l00169"></a>00169                 tempMsg.writeUnsignedByte(static_cast&lt;int&gt;(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a79d93ef1833e1154d26d5f381ddb33d9" title="Returns the vehicle&amp;#39;s parameter (including departure definition).">getParameter</a>().<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a9f2aaf24a7bd52568405319ebc2283b3" title="The vehicle&amp;#39;s color.">color</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#aecf0743143198bec2a7cc68fb4e9ad2e" title="Returns the green-amount of the color.">green</a>() * 255. + 0.5));
<a name="l00170"></a>00170                 tempMsg.writeUnsignedByte(static_cast&lt;int&gt;(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a79d93ef1833e1154d26d5f381ddb33d9" title="Returns the vehicle&amp;#39;s parameter (including departure definition).">getParameter</a>().<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a9f2aaf24a7bd52568405319ebc2283b3" title="The vehicle&amp;#39;s color.">color</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#a797a5810e1de8c10b313809e4bdb5780" title="Returns the blue-amount of the color.">blue</a>() * 255. + 0.5));
<a name="l00171"></a>00171                 tempMsg.writeUnsignedByte(255);
<a name="l00172"></a>00172                 <span class="keywordflow">break</span>;
<a name="l00173"></a>00173             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4493c1eaff38410b9afd3b5ec86e760e">VAR_LANEPOSITION</a>:
<a name="l00174"></a>00174                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00175"></a>00175                 tempMsg.writeDouble(onRoad ? v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a9730b019bfc264e955b4af196619f72d" title="Get the vehicle&amp;#39;s position along the lane.">getPositionOnLane</a>() : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00176"></a>00176                 <span class="keywordflow">break</span>;
<a name="l00177"></a>00177             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#adcc6403451c32bda03d9563843f4eb23">VAR_CO2EMISSION</a>:
<a name="l00178"></a>00178                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00179"></a>00179                 tempMsg.writeDouble(onRoad ? <a class="code" href="../../d4/d8d/class_helpers_h_b_e_f_a.html#a10cfbec21459af6c18486a298b6e0501" title="Returns the amount of emitted CO2 given the vehicle type and state (in mg/s).">HelpersHBEFA::computeCO2</a>(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af0509244821c3c7c85e64344ca66929c" title="Returns the vehicle&amp;#39;s type definition.">getVehicleType</a>().<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#af504fa5e7be61e03c9c7163cc511d53a" title="Get this vehicle type&amp;#39;s emission class.">getEmissionClass</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#ac6847bb54de8bdf75ddb8e2fc689cb2e" title="Returns the vehicle&amp;#39;s current speed.">getSpeed</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a0983ab9e87d3e24e380ad52cac1f2625" title="Returns the vehicle&amp;#39;s acceleration before dawdling.">getPreDawdleAcceleration</a>()) : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00180"></a>00180                 <span class="keywordflow">break</span>;
<a name="l00181"></a>00181             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a55f8fd37376dc3adc19fc6e2ceaf53ce">VAR_COEMISSION</a>:
<a name="l00182"></a>00182                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00183"></a>00183                 tempMsg.writeDouble(onRoad ? <a class="code" href="../../d4/d8d/class_helpers_h_b_e_f_a.html#ae4891ba7e78774927de234d84cfe44e6" title="Returns the amount of emitted CO given the vehicle type and state (in mg/s).">HelpersHBEFA::computeCO</a>(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af0509244821c3c7c85e64344ca66929c" title="Returns the vehicle&amp;#39;s type definition.">getVehicleType</a>().<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#af504fa5e7be61e03c9c7163cc511d53a" title="Get this vehicle type&amp;#39;s emission class.">getEmissionClass</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#ac6847bb54de8bdf75ddb8e2fc689cb2e" title="Returns the vehicle&amp;#39;s current speed.">getSpeed</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a0983ab9e87d3e24e380ad52cac1f2625" title="Returns the vehicle&amp;#39;s acceleration before dawdling.">getPreDawdleAcceleration</a>()) : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00184"></a>00184                 <span class="keywordflow">break</span>;
<a name="l00185"></a>00185             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aaa0aad5c649d543d8de81bdb22d06664">VAR_HCEMISSION</a>:
<a name="l00186"></a>00186                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00187"></a>00187                 tempMsg.writeDouble(onRoad ? <a class="code" href="../../d4/d8d/class_helpers_h_b_e_f_a.html#ad0cff77bfb3ceca30a3b6acbc77c134d" title="Returns the amount of emitted HC given the vehicle type and state (in mg/s).">HelpersHBEFA::computeHC</a>(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af0509244821c3c7c85e64344ca66929c" title="Returns the vehicle&amp;#39;s type definition.">getVehicleType</a>().<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#af504fa5e7be61e03c9c7163cc511d53a" title="Get this vehicle type&amp;#39;s emission class.">getEmissionClass</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#ac6847bb54de8bdf75ddb8e2fc689cb2e" title="Returns the vehicle&amp;#39;s current speed.">getSpeed</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a0983ab9e87d3e24e380ad52cac1f2625" title="Returns the vehicle&amp;#39;s acceleration before dawdling.">getPreDawdleAcceleration</a>()) : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00188"></a>00188                 <span class="keywordflow">break</span>;
<a name="l00189"></a>00189             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a37217bdbf8be36dc1bd44ecd62a807a4">VAR_PMXEMISSION</a>:
<a name="l00190"></a>00190                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00191"></a>00191                 tempMsg.writeDouble(onRoad ? <a class="code" href="../../d4/d8d/class_helpers_h_b_e_f_a.html#a66eccc7953c43d58d53712f05867b641" title="Returns the amount of emitted PMx given the vehicle type and state (in mg/s).">HelpersHBEFA::computePMx</a>(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af0509244821c3c7c85e64344ca66929c" title="Returns the vehicle&amp;#39;s type definition.">getVehicleType</a>().<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#af504fa5e7be61e03c9c7163cc511d53a" title="Get this vehicle type&amp;#39;s emission class.">getEmissionClass</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#ac6847bb54de8bdf75ddb8e2fc689cb2e" title="Returns the vehicle&amp;#39;s current speed.">getSpeed</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a0983ab9e87d3e24e380ad52cac1f2625" title="Returns the vehicle&amp;#39;s acceleration before dawdling.">getPreDawdleAcceleration</a>()) : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00192"></a>00192                 <span class="keywordflow">break</span>;
<a name="l00193"></a>00193             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a89457fa8c4ae6bd5adf6cc97860d08bd">VAR_NOXEMISSION</a>:
<a name="l00194"></a>00194                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00195"></a>00195                 tempMsg.writeDouble(onRoad ? <a class="code" href="../../d4/d8d/class_helpers_h_b_e_f_a.html#ac1303a8a485d9a770a1c58ea6bc50277" title="Returns the amount of emitted NOx given the vehicle type and state (in mg/s).">HelpersHBEFA::computeNOx</a>(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af0509244821c3c7c85e64344ca66929c" title="Returns the vehicle&amp;#39;s type definition.">getVehicleType</a>().<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#af504fa5e7be61e03c9c7163cc511d53a" title="Get this vehicle type&amp;#39;s emission class.">getEmissionClass</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#ac6847bb54de8bdf75ddb8e2fc689cb2e" title="Returns the vehicle&amp;#39;s current speed.">getSpeed</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a0983ab9e87d3e24e380ad52cac1f2625" title="Returns the vehicle&amp;#39;s acceleration before dawdling.">getPreDawdleAcceleration</a>()) : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00196"></a>00196                 <span class="keywordflow">break</span>;
<a name="l00197"></a>00197             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#acdec282d3916d2d2ec373cd6f5f5e977">VAR_FUELCONSUMPTION</a>:
<a name="l00198"></a>00198                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00199"></a>00199                 tempMsg.writeDouble(onRoad ? <a class="code" href="../../d4/d8d/class_helpers_h_b_e_f_a.html#afb9fc3d0c0cfc706e825900d4ff9fe97" title="Returns the amount of consumed fuel given the vehicle type and state (in ml/s).">HelpersHBEFA::computeFuel</a>(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af0509244821c3c7c85e64344ca66929c" title="Returns the vehicle&amp;#39;s type definition.">getVehicleType</a>().<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#af504fa5e7be61e03c9c7163cc511d53a" title="Get this vehicle type&amp;#39;s emission class.">getEmissionClass</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#ac6847bb54de8bdf75ddb8e2fc689cb2e" title="Returns the vehicle&amp;#39;s current speed.">getSpeed</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a0983ab9e87d3e24e380ad52cac1f2625" title="Returns the vehicle&amp;#39;s acceleration before dawdling.">getPreDawdleAcceleration</a>()) : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00200"></a>00200                 <span class="keywordflow">break</span>;
<a name="l00201"></a>00201             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a54cb80eb2dc3f07710f64ca77f9b732d">VAR_NOISEEMISSION</a>:
<a name="l00202"></a>00202                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00203"></a>00203                 tempMsg.writeDouble(onRoad ? <a class="code" href="../../dd/d41/class_helpers_harmonoise.html#ab98909fb77610a59e65d17193478cc0e" title="Returns the noise produced by the a vehicle of the given type at the given speed...">HelpersHarmonoise::computeNoise</a>(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af0509244821c3c7c85e64344ca66929c" title="Returns the vehicle&amp;#39;s type definition.">getVehicleType</a>().<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#af504fa5e7be61e03c9c7163cc511d53a" title="Get this vehicle type&amp;#39;s emission class.">getEmissionClass</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#ac6847bb54de8bdf75ddb8e2fc689cb2e" title="Returns the vehicle&amp;#39;s current speed.">getSpeed</a>(), v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a0983ab9e87d3e24e380ad52cac1f2625" title="Returns the vehicle&amp;#39;s acceleration before dawdling.">getPreDawdleAcceleration</a>()) : <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00204"></a>00204                 <span class="keywordflow">break</span>;
<a name="l00205"></a>00205             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aa03c145ea3d6ed1039ee650ad0599452">VAR_EDGE_TRAVELTIME</a>: {
<a name="l00206"></a>00206                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>) {
<a name="l00207"></a>00207                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Retrieval of travel time requires a compound object.&quot;</span>, outputStorage);
<a name="l00208"></a>00208                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00209"></a>00209                 }
<a name="l00210"></a>00210                 <span class="keywordflow">if</span> (inputStorage.readInt() != 2) {
<a name="l00211"></a>00211                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Retrieval of travel time requires time, and edge as parameter.&quot;</span>, outputStorage);
<a name="l00212"></a>00212                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00213"></a>00213                 }
<a name="l00214"></a>00214                 <span class="comment">// time</span>
<a name="l00215"></a>00215                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>) {
<a name="l00216"></a>00216                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Retrieval of travel time requires the referenced time as first parameter.&quot;</span>, outputStorage);
<a name="l00217"></a>00217                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00218"></a>00218                 }
<a name="l00219"></a>00219                 <a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a> time = inputStorage.readInt();
<a name="l00220"></a>00220                 <span class="comment">// edge</span>
<a name="l00221"></a>00221                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00222"></a>00222                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Retrieval of travel time requires the referenced edge as second parameter.&quot;</span>, outputStorage);
<a name="l00223"></a>00223                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00224"></a>00224                 }
<a name="l00225"></a>00225                 std::string edgeID = inputStorage.readString();
<a name="l00226"></a>00226                 <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>* edge = <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(edgeID);
<a name="l00227"></a>00227                 <span class="keywordflow">if</span> (edge == 0) {
<a name="l00228"></a>00228                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Referenced edge &#39;&quot;</span> + edgeID + <span class="stringliteral">&quot;&#39; is not known.&quot;</span>, outputStorage);
<a name="l00229"></a>00229                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00230"></a>00230                 }
<a name="l00231"></a>00231                 <span class="comment">// retrieve</span>
<a name="l00232"></a>00232                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00233"></a>00233                 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> value;
<a name="l00234"></a>00234                 <span class="keywordflow">if</span> (!v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a9f7808ad293132af07435a98b745f8ce" title="Returns the vehicle&amp;#39;s internal edge travel times/efforts container.">getWeightsStorage</a>().<a class="code" href="../../d6/d8f/class_m_s_edge_weights_storage.html#a1e42d5a68b56af9424a503aaa2c0dab5" title="Returns a travel time for an edge and time if stored.">retrieveExistingTravelTime</a>(edge, 0, time, value)) {
<a name="l00235"></a>00235                     tempMsg.writeDouble(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00236"></a>00236                 } <span class="keywordflow">else</span> {
<a name="l00237"></a>00237                     tempMsg.writeDouble(value);
<a name="l00238"></a>00238                 }
<a name="l00239"></a>00239 
<a name="l00240"></a>00240             }
<a name="l00241"></a>00241             <span class="keywordflow">break</span>;
<a name="l00242"></a>00242             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a82afe862545ade0192be2788e5b29f82">VAR_EDGE_EFFORT</a>: {
<a name="l00243"></a>00243                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>) {
<a name="l00244"></a>00244                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Retrieval of travel time requires a compound object.&quot;</span>, outputStorage);
<a name="l00245"></a>00245                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00246"></a>00246                 }
<a name="l00247"></a>00247                 <span class="keywordflow">if</span> (inputStorage.readInt() != 2) {
<a name="l00248"></a>00248                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Retrieval of travel time requires time, and edge as parameter.&quot;</span>, outputStorage);
<a name="l00249"></a>00249                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00250"></a>00250                 }
<a name="l00251"></a>00251                 <span class="comment">// time</span>
<a name="l00252"></a>00252                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>) {
<a name="l00253"></a>00253                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Retrieval of effort requires the referenced time as first parameter.&quot;</span>, outputStorage);
<a name="l00254"></a>00254                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00255"></a>00255                 }
<a name="l00256"></a>00256                 <a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a> time = inputStorage.readInt();
<a name="l00257"></a>00257                 <span class="comment">// edge</span>
<a name="l00258"></a>00258                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00259"></a>00259                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Retrieval of effort requires the referenced edge as second parameter.&quot;</span>, outputStorage);
<a name="l00260"></a>00260                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00261"></a>00261                 }
<a name="l00262"></a>00262                 std::string edgeID = inputStorage.readString();
<a name="l00263"></a>00263                 <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>* edge = <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(edgeID);
<a name="l00264"></a>00264                 <span class="keywordflow">if</span> (edge == 0) {
<a name="l00265"></a>00265                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Referenced edge &#39;&quot;</span> + edgeID + <span class="stringliteral">&quot;&#39; is not known.&quot;</span>, outputStorage);
<a name="l00266"></a>00266                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00267"></a>00267                 }
<a name="l00268"></a>00268                 <span class="comment">// retrieve</span>
<a name="l00269"></a>00269                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00270"></a>00270                 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> value;
<a name="l00271"></a>00271                 <span class="keywordflow">if</span> (!v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a9f7808ad293132af07435a98b745f8ce" title="Returns the vehicle&amp;#39;s internal edge travel times/efforts container.">getWeightsStorage</a>().<a class="code" href="../../d6/d8f/class_m_s_edge_weights_storage.html#aa70bc11a9a1f3dca6fd2d3d5860e5e59" title="Returns an effort for an edge and time if stored.">retrieveExistingEffort</a>(edge, 0, time, value)) {
<a name="l00272"></a>00272                     tempMsg.writeDouble(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>);
<a name="l00273"></a>00273                 } <span class="keywordflow">else</span> {
<a name="l00274"></a>00274                     tempMsg.writeDouble(value);
<a name="l00275"></a>00275                 }
<a name="l00276"></a>00276 
<a name="l00277"></a>00277             }
<a name="l00278"></a>00278             <span class="keywordflow">break</span>;
<a name="l00279"></a>00279             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a817e029aaf52b9bd33c3115af6384e0c">VAR_ROUTE_VALID</a>: {
<a name="l00280"></a>00280                 std::string msg;
<a name="l00281"></a>00281                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a3d7c110d8026c92c2fee435f7cd12193">TYPE_UBYTE</a>);
<a name="l00282"></a>00282                 tempMsg.writeUnsignedByte(v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a3deed8cc382be7fd479a7b30d86b8dc5" title="Validates the current route.">hasValidRoute</a>(msg));
<a name="l00283"></a>00283             }
<a name="l00284"></a>00284             <span class="keywordflow">break</span>;
<a name="l00285"></a>00285             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ada001729364b89aa926730f631d6e429">VAR_EDGES</a>: {
<a name="l00286"></a>00286                 <span class="keyword">const</span> <a class="code" href="../../de/dd8/class_m_s_route.html">MSRoute</a>&amp; r = v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ad54c9a2eeea444f4538ac5c405844d46" title="Returns the current route.">getRoute</a>();
<a name="l00287"></a>00287                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5561b6050ea28ec6d322e28848460c17">TYPE_STRINGLIST</a>);
<a name="l00288"></a>00288                 tempMsg.writeInt(r.<a class="code" href="../../de/dd8/class_m_s_route.html#a267094c65db4dcaded41bfa657d4065b" title="Returns the number of edges to pass.">size</a>());
<a name="l00289"></a>00289                 <span class="keywordflow">for</span> (<a class="code" href="../../d0/d24/_m_s_route_8h.html#a7253220e09ff4670521e6da98a9fc3f6">MSRouteIterator</a> i = r.<a class="code" href="../../de/dd8/class_m_s_route.html#a19df3c97135029c574956a7c0f88b9eb" title="Returns the begin of the list of edges to pass.">begin</a>(); i != r.<a class="code" href="../../de/dd8/class_m_s_route.html#a46a50e341d78ea7ac195dbfaf9fa7367" title="Returns the end of the list of edges to pass.">end</a>(); ++i) {
<a name="l00290"></a>00290                     tempMsg.writeString((*i)-&gt;getID());
<a name="l00291"></a>00291                 }
<a name="l00292"></a>00292             }
<a name="l00293"></a>00293             <span class="keywordflow">break</span>;
<a name="l00294"></a>00294             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a7378a076f1ed4fb133d04d474ec36110">VAR_SIGNALS</a>:
<a name="l00295"></a>00295                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>);
<a name="l00296"></a>00296                 tempMsg.writeInt(v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a157b00ff4740d0fd29ea7d80009d9ad9" title="Returns the signals.">getSignals</a>());
<a name="l00297"></a>00297                 <span class="keywordflow">break</span>;
<a name="l00298"></a>00298             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a547dc5b69db59f7d5919f1e295469049">VAR_BEST_LANES</a>: {
<a name="l00299"></a>00299                 tempMsg.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>);
<a name="l00300"></a>00300                 tcpip::Storage tempContent;
<a name="l00301"></a>00301                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cnt = 0;
<a name="l00302"></a>00302                 tempContent.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>);
<a name="l00303"></a>00303                 <span class="keyword">const</span> std::vector&lt;MSVehicle::LaneQ&gt; &amp;bestLanes = onRoad ? v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a4fc0b32f53a2415b39634217a5741adc" title="Returns the description of best lanes to use in order to continue the route.">getBestLanes</a>() : std::vector&lt;MSVehicle::LaneQ&gt;();
<a name="l00304"></a>00304                 tempContent.writeInt((<span class="keywordtype">int</span>) bestLanes.size());
<a name="l00305"></a>00305                 ++cnt;
<a name="l00306"></a>00306                 <span class="keywordflow">for</span> (std::vector&lt;MSVehicle::LaneQ&gt;::const_iterator i = bestLanes.begin(); i != bestLanes.end(); ++i) {
<a name="l00307"></a>00307                     <span class="keyword">const</span> <a class="code" href="../../d3/d89/struct_m_s_vehicle_1_1_lane_q.html" title="A structure representing the best lanes for continuing the route.">MSVehicle::LaneQ</a>&amp; lq = *i;
<a name="l00308"></a>00308                     tempContent.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>);
<a name="l00309"></a>00309                     tempContent.writeString(lq.<a class="code" href="../../d3/d89/struct_m_s_vehicle_1_1_lane_q.html#a3df6bd9b94a7e3e4795547feddf68bf2" title="The described lane.">lane</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>());
<a name="l00310"></a>00310                     ++cnt;
<a name="l00311"></a>00311                     tempContent.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00312"></a>00312                     tempContent.writeDouble(lq.<a class="code" href="../../d3/d89/struct_m_s_vehicle_1_1_lane_q.html#a05b50e3736d96f07fe7e6144e5d7f1a3" title="The overall length which may be driven when using this lane without a lane change...">length</a>);
<a name="l00313"></a>00313                     ++cnt;
<a name="l00314"></a>00314                     tempContent.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l00315"></a>00315                     tempContent.writeDouble(lq.<a class="code" href="../../d3/d89/struct_m_s_vehicle_1_1_lane_q.html#a2af28393ac639bfd347ba5d3cae29918" title="As occupation, but without the first lane.">nextOccupation</a>);
<a name="l00316"></a>00316                     ++cnt;
<a name="l00317"></a>00317                     tempContent.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ad62574650f26d2392ab55729769948b8">TYPE_BYTE</a>);
<a name="l00318"></a>00318                     tempContent.writeByte(lq.<a class="code" href="../../d3/d89/struct_m_s_vehicle_1_1_lane_q.html#aa7f926a77c7d33c071c620ae7e9d0ac1" title="The (signed) number of lanes to be crossed to get to the lane which allows to continue...">bestLaneOffset</a>);
<a name="l00319"></a>00319                     ++cnt;
<a name="l00320"></a>00320                     tempContent.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a3d7c110d8026c92c2fee435f7cd12193">TYPE_UBYTE</a>);
<a name="l00321"></a>00321                     lq.<a class="code" href="../../d3/d89/struct_m_s_vehicle_1_1_lane_q.html#a1491a03d3e914ce9f78fe892c6f8594b" title="Whether this lane allows to continue the drive.">allowsContinuation</a> ? tempContent.writeUnsignedByte(1) : tempContent.writeUnsignedByte(0);
<a name="l00322"></a>00322                     ++cnt;
<a name="l00323"></a>00323                     std::vector&lt;std::string&gt; bestContIDs;
<a name="l00324"></a>00324                     <span class="keywordflow">for</span> (std::vector&lt;MSLane*&gt;::const_iterator j = lq.<a class="code" href="../../d3/d89/struct_m_s_vehicle_1_1_lane_q.html#a2fc7b1df76210eff08026dbd53c13312" title="Consecutive lane that can be followed without a lane change (contribute to length...">bestContinuations</a>.begin(); j != lq.<a class="code" href="../../d3/d89/struct_m_s_vehicle_1_1_lane_q.html#a2fc7b1df76210eff08026dbd53c13312" title="Consecutive lane that can be followed without a lane change (contribute to length...">bestContinuations</a>.end(); ++j) {
<a name="l00325"></a>00325                         bestContIDs.push_back((*j)-&gt;getID());
<a name="l00326"></a>00326                     }
<a name="l00327"></a>00327                     tempContent.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5561b6050ea28ec6d322e28848460c17">TYPE_STRINGLIST</a>);
<a name="l00328"></a>00328                     tempContent.writeStringList(bestContIDs);
<a name="l00329"></a>00329                     ++cnt;
<a name="l00330"></a>00330                 }
<a name="l00331"></a>00331                 tempMsg.writeInt((<span class="keywordtype">int</span>) cnt);
<a name="l00332"></a>00332                 tempMsg.writeStorage(tempContent);
<a name="l00333"></a>00333             }
<a name="l00334"></a>00334             <span class="keywordflow">break</span>;
<a name="l00335"></a>00335             <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a92f25b953319f56d635ea4fe599d65c1">DISTANCE_REQUEST</a>:
<a name="l00336"></a>00336                 <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d85/class_tra_c_i_server_a_p_i___vehicle.html#a9f69b8fce5841ce4e84111b9b01e6747">commandDistanceRequest</a>(server, inputStorage, tempMsg, v)) {
<a name="l00337"></a>00337                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00338"></a>00338                 }
<a name="l00339"></a>00339                 <span class="keywordflow">break</span>;
<a name="l00340"></a>00340             <span class="keywordflow">default</span>:
<a name="l00341"></a>00341                 <a class="code" href="../../d0/d89/class_tra_c_i_server_a_p_i___vehicle_type.html#a80fc6e24064eb782ac43d1156c5fed1b" title="Processes a value request for the given type.">TraCIServerAPI_VehicleType::getVariable</a>(variable, v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af0509244821c3c7c85e64344ca66929c" title="Returns the vehicle&amp;#39;s type definition.">getVehicleType</a>(), tempMsg);
<a name="l00342"></a>00342                 <span class="keywordflow">break</span>;
<a name="l00343"></a>00343         }
<a name="l00344"></a>00344     }
<a name="l00345"></a>00345     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a541fc8755958a227fe412e2df7fa31fa">RTYPE_OK</a>, warning, outputStorage);
<a name="l00346"></a>00346     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#ad863107695199922e2dace0bbb517f2c">writeResponseWithLength</a>(outputStorage, tempMsg);
<a name="l00347"></a>00347     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00348"></a>00348 }
<a name="l00349"></a>00349 
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 <span class="keywordtype">bool</span>
<a name="l00352"></a><a class="code" href="../../d9/d85/class_tra_c_i_server_a_p_i___vehicle.html#a2b5716f79a99cadf1c8b132a6c16d5fb">00352</a> <a class="code" href="../../d9/d85/class_tra_c_i_server_a_p_i___vehicle.html#a2b5716f79a99cadf1c8b132a6c16d5fb" title="Processes a set value command (Command 0xc4: Change Vehicle State).">TraCIServerAPI_Vehicle::processSet</a>(<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html">TraCIServer</a>&amp; server, tcpip::Storage&amp; inputStorage,
<a name="l00353"></a>00353                                    tcpip::Storage&amp; outputStorage) {
<a name="l00354"></a>00354     std::string warning = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// additional description for response</span>
<a name="l00355"></a>00355     <span class="comment">// variable</span>
<a name="l00356"></a>00356     <span class="keywordtype">int</span> variable = inputStorage.readUnsignedByte();
<a name="l00357"></a>00357     <span class="keywordflow">if</span> (variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a46dc7ae84992bfe62cc00731959a67f4">CMD_STOP</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#adf76abeac554994696e6af2df832caac">CMD_CHANGELANE</a>
<a name="l00358"></a>00358             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a628edc613cc0dc75723a440d4f59cf9b">CMD_SLOWDOWN</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#adeeddcd0f58304495e3e30c5285be51e">CMD_CHANGETARGET</a>
<a name="l00359"></a>00359             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a48cbe1bf5748e27183054ed2ddcfa3ae">VAR_ROUTE_ID</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ab193f946f651c97e299dfc4285133516">VAR_ROUTE</a>
<a name="l00360"></a>00360             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aa03c145ea3d6ed1039ee650ad0599452">VAR_EDGE_TRAVELTIME</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a82afe862545ade0192be2788e5b29f82">VAR_EDGE_EFFORT</a>
<a name="l00361"></a>00361             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a9cf2d3b5926694eca9a290606153dbb6">CMD_REROUTE_TRAVELTIME</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a27d763793c3a43050ece9e76caa0f697">CMD_REROUTE_EFFORT</a>
<a name="l00362"></a>00362             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a7378a076f1ed4fb133d04d474ec36110">VAR_SIGNALS</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ad18db3a6f2be838f3ea6d75bb1784b5e">VAR_MOVE_TO</a>
<a name="l00363"></a>00363             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a60e947bd75233810d5417b41f27e68df">VAR_LENGTH</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a1f8d8754eb24cd09fb3107a3f71bf76b">VAR_MAXSPEED</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5cdedbf9fd0353a0a7c60982b4bd1494">VAR_VEHICLECLASS</a>
<a name="l00364"></a>00364             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac73c5a63a7ba70a57e9f2162277799db">VAR_SPEED_FACTOR</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aaa434a0096961983f3ca1fddbeb73b3a">VAR_SPEED_DEVIATION</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a46a1e04d43660551e055d44f2d0ca41c">VAR_EMISSIONCLASS</a>
<a name="l00365"></a>00365             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#adb08f65a6543f976dbfe6ee7db5d08a2">VAR_WIDTH</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aea443b43de4353bbaab7f34d303afe3c">VAR_MINGAP</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a0f50ad2a0f01241405381b9e895ab2d6">VAR_SHAPECLASS</a>
<a name="l00366"></a>00366             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aafdce9f42320b3e72c814cceaab9809c">VAR_ACCEL</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4f883334365d5c2e0f18944be814441f">VAR_DECEL</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac98dc6e9bc82ae734fa638762f81eca6">VAR_IMPERFECTION</a>
<a name="l00367"></a>00367             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8d32ba4c4cc7e453e9b63426d84eb084">VAR_TAU</a>
<a name="l00368"></a>00368             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a803f3a1743aef11a357e838e50d80f6a">VAR_SPEED</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5c4f611616810959183c7b4e1d6e1b88">VAR_SPEEDSETMODE</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#adcc89457ed75668afd992c756fc58549">VAR_COLOR</a>
<a name="l00369"></a>00369             &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a97fe5470fb1ac167c713671655ff3e52">ADD</a> &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ab9959e75e26bc66b3733ddc04de6b4cf">REMOVE</a>
<a name="l00370"></a>00370        ) {
<a name="l00371"></a>00371         server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Change Vehicle State: unsupported variable specified&quot;</span>, outputStorage);
<a name="l00372"></a>00372         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00373"></a>00373     }
<a name="l00374"></a>00374     <span class="comment">// id</span>
<a name="l00375"></a>00375     std::string <span class="keywordtype">id</span> = inputStorage.readString();
<a name="l00376"></a>00376     <a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html" title="Representation of a vehicle.">SUMOVehicle</a>* v = <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;<a class="code" href="../../dc/d5d/class_m_s_net.html#a5e74ee833cafefa74b84e2091ef135a3" title="Returns the vehicle control.">getVehicleControl</a>().<a class="code" href="../../db/d2f/class_m_s_vehicle_control.html#a7e0bba043cf6d995661667fc4961f0a3" title="Returns the vehicle with the given id.">getVehicle</a>(<span class="keywordtype">id</span>);
<a name="l00377"></a>00377     <span class="keywordflow">if</span> (v == 0 &amp;&amp; variable != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a97fe5470fb1ac167c713671655ff3e52">ADD</a>) {
<a name="l00378"></a>00378         server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Vehicle &#39;&quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot;&#39; is not known&quot;</span>, outputStorage);
<a name="l00379"></a>00379         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00380"></a>00380     }
<a name="l00381"></a>00381     <span class="comment">// process</span>
<a name="l00382"></a>00382     <span class="keywordtype">int</span> valueDataType = inputStorage.readUnsignedByte();
<a name="l00383"></a>00383     <span class="keywordflow">switch</span> (variable) {
<a name="l00384"></a>00384         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a46dc7ae84992bfe62cc00731959a67f4">CMD_STOP</a>: {
<a name="l00385"></a>00385             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>) {
<a name="l00386"></a>00386                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Stop needs a compound object description.&quot;</span>, outputStorage);
<a name="l00387"></a>00387                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00388"></a>00388             }
<a name="l00389"></a>00389             <span class="keywordflow">if</span> (inputStorage.readInt() != 4) {
<a name="l00390"></a>00390                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Stop needs a compound object description of four items.&quot;</span>, outputStorage);
<a name="l00391"></a>00391                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00392"></a>00392             }
<a name="l00393"></a>00393             <span class="comment">// read road map position</span>
<a name="l00394"></a>00394             valueDataType = inputStorage.readUnsignedByte();
<a name="l00395"></a>00395             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00396"></a>00396                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The first stop parameter must be the edge id given as a string.&quot;</span>, outputStorage);
<a name="l00397"></a>00397                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00398"></a>00398             }
<a name="l00399"></a>00399             std::string roadId = inputStorage.readString();
<a name="l00400"></a>00400             valueDataType = inputStorage.readUnsignedByte();
<a name="l00401"></a>00401             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>) {
<a name="l00402"></a>00402                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The second stop parameter must be the position along the edge given as a double.&quot;</span>, outputStorage);
<a name="l00403"></a>00403                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00404"></a>00404             }
<a name="l00405"></a>00405             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> pos = inputStorage.readDouble();
<a name="l00406"></a>00406             valueDataType = inputStorage.readUnsignedByte();
<a name="l00407"></a>00407             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ad62574650f26d2392ab55729769948b8">TYPE_BYTE</a>) {
<a name="l00408"></a>00408                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The third stop parameter must be the lane index given as a byte.&quot;</span>, outputStorage);
<a name="l00409"></a>00409                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00410"></a>00410             }
<a name="l00411"></a>00411             <span class="keywordtype">int</span> laneIndex = inputStorage.readByte();
<a name="l00412"></a>00412             <span class="comment">// waitTime</span>
<a name="l00413"></a>00413             valueDataType = inputStorage.readUnsignedByte();
<a name="l00414"></a>00414             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>) {
<a name="l00415"></a>00415                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The fourth stop parameter must be the waiting time given as an integer.&quot;</span>, outputStorage);
<a name="l00416"></a>00416                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00417"></a>00417             }
<a name="l00418"></a>00418             <a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a> waitTime = inputStorage.readInt();
<a name="l00419"></a>00419             <span class="comment">// check</span>
<a name="l00420"></a>00420             <span class="keywordflow">if</span> (pos &lt; 0) {
<a name="l00421"></a>00421                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Position on lane must not be negative&quot;</span>, outputStorage);
<a name="l00422"></a>00422                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00423"></a>00423             }
<a name="l00424"></a>00424             <span class="comment">// get the actual lane that is referenced by laneIndex</span>
<a name="l00425"></a>00425             <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>* road = <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(roadId);
<a name="l00426"></a>00426             <span class="keywordflow">if</span> (road == 0) {
<a name="l00427"></a>00427                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Unable to retrieve road with given id&quot;</span>, outputStorage);
<a name="l00428"></a>00428                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00429"></a>00429             }
<a name="l00430"></a>00430             <span class="keyword">const</span> std::vector&lt;MSLane*&gt; &amp;allLanes = road-&gt;<a class="code" href="../../d7/d27/class_m_s_edge.html#ac6454be7984c840da4fa48808cf22833" title="Returns this edge&amp;#39;s lanes.">getLanes</a>();
<a name="l00431"></a>00431             <span class="keywordflow">if</span> ((laneIndex &lt; 0) || laneIndex &gt;= (<span class="keywordtype">int</span>)(allLanes.size())) {
<a name="l00432"></a>00432                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;No lane existing with such id on the given road&quot;</span>, outputStorage);
<a name="l00433"></a>00433                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00434"></a>00434             }
<a name="l00435"></a>00435             <span class="comment">// Forward command to vehicle</span>
<a name="l00436"></a>00436             <span class="keywordflow">if</span> (!static_cast&lt;MSVehicle*&gt;(v)-&gt;addTraciStop(allLanes[laneIndex], pos, 0, waitTime)) {
<a name="l00437"></a>00437                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Vehicle is too close or behind the stop on &quot;</span> + allLanes[laneIndex]-&gt;getID(), outputStorage);
<a name="l00438"></a>00438                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00439"></a>00439             }
<a name="l00440"></a>00440         }
<a name="l00441"></a>00441         <span class="keywordflow">break</span>;
<a name="l00442"></a>00442         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#adf76abeac554994696e6af2df832caac">CMD_CHANGELANE</a>: {
<a name="l00443"></a>00443             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>) {
<a name="l00444"></a>00444                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Lane change needs a compound object description.&quot;</span>, outputStorage);
<a name="l00445"></a>00445                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00446"></a>00446             }
<a name="l00447"></a>00447             <span class="keywordflow">if</span> (inputStorage.readInt() != 2) {
<a name="l00448"></a>00448                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Lane change needs a compound object description of two items.&quot;</span>, outputStorage);
<a name="l00449"></a>00449                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00450"></a>00450             }
<a name="l00451"></a>00451             <span class="comment">// Lane ID</span>
<a name="l00452"></a>00452             valueDataType = inputStorage.readUnsignedByte();
<a name="l00453"></a>00453             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ad62574650f26d2392ab55729769948b8">TYPE_BYTE</a>) {
<a name="l00454"></a>00454                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The first lane change parameter must be the lane index given as a byte.&quot;</span>, outputStorage);
<a name="l00455"></a>00455                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00456"></a>00456             }
<a name="l00457"></a>00457             <span class="keywordtype">int</span> laneIndex = inputStorage.readByte();
<a name="l00458"></a>00458             <span class="comment">// stickyTime</span>
<a name="l00459"></a>00459             valueDataType = inputStorage.readUnsignedByte();
<a name="l00460"></a>00460             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>) {
<a name="l00461"></a>00461                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The second lane change parameter must be the duration given as an integer.&quot;</span>, outputStorage);
<a name="l00462"></a>00462                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00463"></a>00463             }
<a name="l00464"></a>00464             <a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a> stickyTime = inputStorage.readInt();
<a name="l00465"></a>00465             <span class="keywordflow">if</span> ((laneIndex &lt; 0) || (laneIndex &gt;= (<span class="keywordtype">int</span>)(v-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#ae0bbeab1f4e41bce8cf615383efd3605" title="Returns the edge the vehicle is currently at.">getEdge</a>()-&gt;<a class="code" href="../../d7/d27/class_m_s_edge.html#ac6454be7984c840da4fa48808cf22833" title="Returns this edge&amp;#39;s lanes.">getLanes</a>().size()))) {
<a name="l00466"></a>00466                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;No lane existing with given id on the current road&quot;</span>, outputStorage);
<a name="l00467"></a>00467                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00468"></a>00468             }
<a name="l00469"></a>00469             <span class="comment">// Forward command to vehicle</span>
<a name="l00470"></a>00470             std::vector&lt;std::pair&lt;SUMOTime, unsigned int&gt; &gt; laneTimeLine;
<a name="l00471"></a>00471             laneTimeLine.push_back(std::make_pair(<a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;getCurrentTimeStep(), laneIndex));
<a name="l00472"></a>00472             laneTimeLine.push_back(std::make_pair(<a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;getCurrentTimeStep() + stickyTime, laneIndex));
<a name="l00473"></a>00473             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getInfluencer().setLaneTimeLine(laneTimeLine);
<a name="l00474"></a>00474             <a class="code" href="../../d7/d90/class_m_s_vehicle.html#aa79784b474b1abfce0584f2e9476d9fe" title="Requests set via TraCI.">MSVehicle::ChangeRequest</a> req = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getInfluencer().checkForLaneChanges(<a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;getCurrentTimeStep(),
<a name="l00475"></a>00475                                            *static_cast&lt;MSVehicle*&gt;(v)-&gt;getEdge(), static_cast&lt;MSVehicle*&gt;(v)-&gt;getLaneIndex());
<a name="l00476"></a>00476             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getLaneChangeModel().requestLaneChange(req);
<a name="l00477"></a>00477         }
<a name="l00478"></a>00478         <span class="keywordflow">break</span>;
<a name="l00479"></a>00479         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a628edc613cc0dc75723a440d4f59cf9b">CMD_SLOWDOWN</a>: {
<a name="l00480"></a>00480             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>) {
<a name="l00481"></a>00481                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Slow down needs a compound object description.&quot;</span>, outputStorage);
<a name="l00482"></a>00482                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00483"></a>00483             }
<a name="l00484"></a>00484             <span class="keywordflow">if</span> (inputStorage.readInt() != 2) {
<a name="l00485"></a>00485                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Slow down needs a compound object description of two items.&quot;</span>, outputStorage);
<a name="l00486"></a>00486                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00487"></a>00487             }
<a name="l00488"></a>00488             <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>) {
<a name="l00489"></a>00489                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The first slow down parameter must be the speed given as a double.&quot;</span>, outputStorage);
<a name="l00490"></a>00490                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00491"></a>00491             }
<a name="l00492"></a>00492             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> newSpeed = <a class="code" href="../../da/dbd/_std_defs_8h.html#a3c4556662cf5cb93067cdc7365aecbcd">MAX2</a>(inputStorage.readDouble(), 0.0);
<a name="l00493"></a>00493             <span class="keywordflow">if</span> (newSpeed &lt; 0) {
<a name="l00494"></a>00494                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Speed must not be negative&quot;</span>, outputStorage);
<a name="l00495"></a>00495                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00496"></a>00496             }
<a name="l00497"></a>00497             <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>) {
<a name="l00498"></a>00498                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The second slow down parameter must be the duration given as an integer.&quot;</span>, outputStorage);
<a name="l00499"></a>00499                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00500"></a>00500             }
<a name="l00501"></a>00501             <a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a> duration = inputStorage.readInt();
<a name="l00502"></a>00502             <span class="keywordflow">if</span> (duration &lt; 0) {
<a name="l00503"></a>00503                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Invalid time interval&quot;</span>, outputStorage);
<a name="l00504"></a>00504                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00505"></a>00505             }
<a name="l00506"></a>00506             std::vector&lt;std::pair&lt;SUMOTime, SUMOReal&gt; &gt; speedTimeLine;
<a name="l00507"></a>00507             speedTimeLine.push_back(std::make_pair(<a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;getCurrentTimeStep(), v-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#acd43ca82eab2d9792a2cde97cc4a0349" title="Returns the vehicle&amp;#39;s current speed.">getSpeed</a>()));
<a name="l00508"></a>00508             speedTimeLine.push_back(std::make_pair(<a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;getCurrentTimeStep() + duration, newSpeed));
<a name="l00509"></a>00509             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getInfluencer().setSpeedTimeLine(speedTimeLine);
<a name="l00510"></a>00510         }
<a name="l00511"></a>00511         <span class="keywordflow">break</span>;
<a name="l00512"></a>00512         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#adeeddcd0f58304495e3e30c5285be51e">CMD_CHANGETARGET</a>: {
<a name="l00513"></a>00513             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00514"></a>00514                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Change target requires a string containing the id of the new destination edge as parameter.&quot;</span>, outputStorage);
<a name="l00515"></a>00515                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00516"></a>00516             }
<a name="l00517"></a>00517             std::string edgeID = inputStorage.readString();
<a name="l00518"></a>00518             <span class="keyword">const</span> <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>* destEdge = <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(edgeID);
<a name="l00519"></a>00519             <span class="keywordflow">if</span> (destEdge == 0) {
<a name="l00520"></a>00520                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Can not retrieve road with ID &quot;</span> + edgeID, outputStorage);
<a name="l00521"></a>00521                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00522"></a>00522             }
<a name="l00523"></a>00523             <span class="comment">// build a new route between the vehicle&#39;s current edge and destination edge</span>
<a name="l00524"></a>00524             <a class="code" href="../../d3/db6/_m_s_person_8h.html#a5fee2764c12f25c3a26e65fd2f258097">MSEdgeVector</a> newRoute;
<a name="l00525"></a>00525             <span class="keyword">const</span> <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>* currentEdge = v-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#ae0bbeab1f4e41bce8cf615383efd3605" title="Returns the edge the vehicle is currently at.">getEdge</a>();
<a name="l00526"></a>00526             <a class="code" href="../../d6/d8f/class_m_s_edge_weights_storage.html" title="A storage for edge travel times and efforts.">MSEdgeWeightsStorage</a> empty;
<a name="l00527"></a>00527             <a class="code" href="../../d2/d35/class_m_s_net_1_1_edge_weights_proxi.html" title="A proxi for edge weights known by a vehicle/known globally.">MSNet::EdgeWeightsProxi</a> proxi(empty, <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;getWeightsStorage());
<a name="l00528"></a>00528             <a class="code" href="../../db/df3/class_dijkstra_router_t_t___by_proxi.html">DijkstraRouterTT_ByProxi&lt;MSEdge, SUMOVehicle, prohibited_withRestrictions&lt;MSEdge, SUMOVehicle&gt;</a>, <a class="code" href="../../d2/d35/class_m_s_net_1_1_edge_weights_proxi.html" title="A proxi for edge weights known by a vehicle/known globally.">MSNet::EdgeWeightsProxi</a>&gt; router(<a class="code" href="../../d7/d27/class_m_s_edge.html#a54b8eb3a4358e69944b8cbd77d94ceaf" title="Returns the number of edges.">MSEdge::dictSize</a>(), <span class="keyword">true</span>, &amp;proxi, &amp;<a class="code" href="../../d2/d35/class_m_s_net_1_1_edge_weights_proxi.html#aa407ea973d857ea6f62a3a10d73c0de9" title="Returns the travel time to pass an edge.">MSNet::EdgeWeightsProxi::getTravelTime</a>);
<a name="l00529"></a>00529             router.<a class="code" href="../../d8/d31/class_dijkstra_router_t_t_base.html#a599ff75cef821f74e5f8af8d3938fb7f" title="Builds the route between the given edges using the minimum afford at the given time...">compute</a>(currentEdge, destEdge, (<span class="keyword">const</span> <a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a> * <span class="keyword">const</span>) v, <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;getCurrentTimeStep(), newRoute);
<a name="l00530"></a>00530             <span class="comment">// replace the vehicle&#39;s route by the new one</span>
<a name="l00531"></a>00531             <span class="keywordflow">if</span> (!v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a387005fb4cb0b544f6b8dda528f2777a" title="Replaces the current route by the given edges.">replaceRouteEdges</a>(newRoute)) {
<a name="l00532"></a>00532                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Route replacement failed for &quot;</span> + v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#af558b8f5379ec8f91cb47e9b7d2b7556" title="Returns the name of the vehicle.">getID</a>(), outputStorage);
<a name="l00533"></a>00533                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00534"></a>00534             }
<a name="l00535"></a>00535         }
<a name="l00536"></a>00536         <span class="keywordflow">break</span>;
<a name="l00537"></a>00537         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a48cbe1bf5748e27183054ed2ddcfa3ae">VAR_ROUTE_ID</a>: {
<a name="l00538"></a>00538             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00539"></a>00539                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The route id must be given as a string.&quot;</span>, outputStorage);
<a name="l00540"></a>00540                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00541"></a>00541             }
<a name="l00542"></a>00542             std::string rid = inputStorage.readString();
<a name="l00543"></a>00543             <span class="keyword">const</span> <a class="code" href="../../de/dd8/class_m_s_route.html">MSRoute</a>* r = <a class="code" href="../../de/dd8/class_m_s_route.html#a379e71c30ffbb0c2366b47f32014980f" title="Adds a route to the dictionary.">MSRoute::dictionary</a>(rid);
<a name="l00544"></a>00544             <span class="keywordflow">if</span> (r == 0) {
<a name="l00545"></a>00545                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The route &#39;&quot;</span> + rid + <span class="stringliteral">&quot;&#39; is not known.&quot;</span>, outputStorage);
<a name="l00546"></a>00546                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00547"></a>00547             }
<a name="l00548"></a>00548             <span class="keywordflow">if</span> (!v-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#aeb02d3a8f486751bcbc4b25a4d09976b" title="Replaces the current route by the given one.">replaceRoute</a>(r)) {
<a name="l00549"></a>00549                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Route replacement failed for &quot;</span> + v-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#a42cdd9b7723e52037bbc5d76bacf266f" title="Get the vehicle&amp;#39;s ID.">getID</a>(), outputStorage);
<a name="l00550"></a>00550                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00551"></a>00551             }
<a name="l00552"></a>00552         }
<a name="l00553"></a>00553         <span class="keywordflow">break</span>;
<a name="l00554"></a>00554         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ab193f946f651c97e299dfc4285133516">VAR_ROUTE</a>: {
<a name="l00555"></a>00555             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5561b6050ea28ec6d322e28848460c17">TYPE_STRINGLIST</a>) {
<a name="l00556"></a>00556                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;A route must be defined as a list of edge ids.&quot;</span>, outputStorage);
<a name="l00557"></a>00557                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00558"></a>00558             }
<a name="l00559"></a>00559             std::vector&lt;std::string&gt; edgeIDs = inputStorage.readStringList();
<a name="l00560"></a>00560             std::vector&lt;const MSEdge*&gt; edges;
<a name="l00561"></a>00561             <a class="code" href="../../d7/d27/class_m_s_edge.html#a47bff6e3209bb2aa1a1a9f1e0968ed97" title="Parses the given string assuming it contains a list of edge ids divided by spaces...">MSEdge::parseEdgesList</a>(edgeIDs, edges, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>);
<a name="l00562"></a>00562             <span class="keywordflow">if</span> (!v-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#a76291ff14aeebe1fa0fb87f1cca2f3cf" title="Replaces the current route by the given edges.">replaceRouteEdges</a>(edges)) {
<a name="l00563"></a>00563                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Route replacement failed for &quot;</span> + v-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#a42cdd9b7723e52037bbc5d76bacf266f" title="Get the vehicle&amp;#39;s ID.">getID</a>(), outputStorage);
<a name="l00564"></a>00564                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00565"></a>00565             }
<a name="l00566"></a>00566         }
<a name="l00567"></a>00567         <span class="keywordflow">break</span>;
<a name="l00568"></a>00568         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#aa03c145ea3d6ed1039ee650ad0599452">VAR_EDGE_TRAVELTIME</a>: {
<a name="l00569"></a>00569             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>) {
<a name="l00570"></a>00570                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting travel time requires a compound object.&quot;</span>, outputStorage);
<a name="l00571"></a>00571                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00572"></a>00572             }
<a name="l00573"></a>00573             <span class="keywordtype">int</span> parameterCount = inputStorage.readInt();
<a name="l00574"></a>00574             <span class="keywordflow">if</span> (parameterCount == 4) {
<a name="l00575"></a>00575                 <span class="comment">// begin time</span>
<a name="l00576"></a>00576                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>) {
<a name="l00577"></a>00577                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting travel time using 4 parameters requires the begin time as first parameter.&quot;</span>, outputStorage);
<a name="l00578"></a>00578                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00579"></a>00579                 }
<a name="l00580"></a>00580                 <a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a> begTime = inputStorage.readInt();
<a name="l00581"></a>00581                 <span class="comment">// begin time</span>
<a name="l00582"></a>00582                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>) {
<a name="l00583"></a>00583                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting travel time using 4 parameters requires the end time as second parameter.&quot;</span>, outputStorage);
<a name="l00584"></a>00584                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00585"></a>00585                 }
<a name="l00586"></a>00586                 <a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a> endTime = inputStorage.readInt();
<a name="l00587"></a>00587                 <span class="comment">// edge</span>
<a name="l00588"></a>00588                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00589"></a>00589                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting travel time using 4 parameters requires the referenced edge as third parameter.&quot;</span>, outputStorage);
<a name="l00590"></a>00590                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00591"></a>00591                 }
<a name="l00592"></a>00592                 std::string edgeID = inputStorage.readString();
<a name="l00593"></a>00593                 <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>* edge = <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(edgeID);
<a name="l00594"></a>00594                 <span class="keywordflow">if</span> (edge == 0) {
<a name="l00595"></a>00595                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Referenced edge &#39;&quot;</span> + edgeID + <span class="stringliteral">&quot;&#39; is not known.&quot;</span>, outputStorage);
<a name="l00596"></a>00596                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00597"></a>00597                 }
<a name="l00598"></a>00598                 <span class="comment">// value</span>
<a name="l00599"></a>00599                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>) {
<a name="l00600"></a>00600                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting travel time using 4 parameters requires the travel time as fourth parameter.&quot;</span>, outputStorage);
<a name="l00601"></a>00601                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00602"></a>00602                 }
<a name="l00603"></a>00603                 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> value = inputStorage.readDouble();
<a name="l00604"></a>00604                 <span class="comment">// retrieve</span>
<a name="l00605"></a>00605                 <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getWeightsStorage().addTravelTime(edge, begTime, endTime, value);
<a name="l00606"></a>00606             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (parameterCount == 2) {
<a name="l00607"></a>00607                 <span class="comment">// edge</span>
<a name="l00608"></a>00608                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00609"></a>00609                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting travel time using 2 parameters requires the referenced edge as first parameter.&quot;</span>, outputStorage);
<a name="l00610"></a>00610                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00611"></a>00611                 }
<a name="l00612"></a>00612                 std::string edgeID = inputStorage.readString();
<a name="l00613"></a>00613                 <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>* edge = <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(edgeID);
<a name="l00614"></a>00614                 <span class="keywordflow">if</span> (edge == 0) {
<a name="l00615"></a>00615                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Referenced edge &#39;&quot;</span> + edgeID + <span class="stringliteral">&quot;&#39; is not known.&quot;</span>, outputStorage);
<a name="l00616"></a>00616                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00617"></a>00617                 }
<a name="l00618"></a>00618                 <span class="comment">// value</span>
<a name="l00619"></a>00619                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>) {
<a name="l00620"></a>00620                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting travel time using 2 parameters requires the travel time as second parameter.&quot;</span>, outputStorage);
<a name="l00621"></a>00621                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00622"></a>00622                 }
<a name="l00623"></a>00623                 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> value = inputStorage.readDouble();
<a name="l00624"></a>00624                 <span class="comment">// retrieve</span>
<a name="l00625"></a>00625                 <span class="keywordflow">while</span> (static_cast&lt;MSVehicle*&gt;(v)-&gt;getWeightsStorage().knowsTravelTime(edge)) {
<a name="l00626"></a>00626                     <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getWeightsStorage().removeTravelTime(edge);
<a name="l00627"></a>00627                 }
<a name="l00628"></a>00628                 <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getWeightsStorage().addTravelTime(edge, 0, <a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#a5ba532efbf218127137edc651cf24e36">SUMOTime_MAX</a>, value);
<a name="l00629"></a>00629             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (parameterCount == 1) {
<a name="l00630"></a>00630                 <span class="comment">// edge</span>
<a name="l00631"></a>00631                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00632"></a>00632                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting travel time using 1 parameter requires the referenced edge as first parameter.&quot;</span>, outputStorage);
<a name="l00633"></a>00633                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00634"></a>00634                 }
<a name="l00635"></a>00635                 std::string edgeID = inputStorage.readString();
<a name="l00636"></a>00636                 <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>* edge = <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(edgeID);
<a name="l00637"></a>00637                 <span class="keywordflow">if</span> (edge == 0) {
<a name="l00638"></a>00638                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Referenced edge &#39;&quot;</span> + edgeID + <span class="stringliteral">&quot;&#39; is not known.&quot;</span>, outputStorage);
<a name="l00639"></a>00639                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00640"></a>00640                 }
<a name="l00641"></a>00641                 <span class="comment">// retrieve</span>
<a name="l00642"></a>00642                 <span class="keywordflow">while</span> (static_cast&lt;MSVehicle*&gt;(v)-&gt;getWeightsStorage().knowsTravelTime(edge)) {
<a name="l00643"></a>00643                     <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getWeightsStorage().removeTravelTime(edge);
<a name="l00644"></a>00644                 }
<a name="l00645"></a>00645             } <span class="keywordflow">else</span> {
<a name="l00646"></a>00646                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting travel time requires 1, 2, or 4 parameters.&quot;</span>, outputStorage);
<a name="l00647"></a>00647                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00648"></a>00648             }
<a name="l00649"></a>00649         }
<a name="l00650"></a>00650         <span class="keywordflow">break</span>;
<a name="l00651"></a>00651         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a82afe862545ade0192be2788e5b29f82">VAR_EDGE_EFFORT</a>: {
<a name="l00652"></a>00652             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>) {
<a name="l00653"></a>00653                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting effort requires a compound object.&quot;</span>, outputStorage);
<a name="l00654"></a>00654                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00655"></a>00655             }
<a name="l00656"></a>00656             <span class="keywordtype">int</span> parameterCount = inputStorage.readInt();
<a name="l00657"></a>00657             <span class="keywordflow">if</span> (parameterCount == 4) {
<a name="l00658"></a>00658                 <span class="comment">// begin time</span>
<a name="l00659"></a>00659                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>) {
<a name="l00660"></a>00660                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting effort using 4 parameters requires the begin time as first parameter.&quot;</span>, outputStorage);
<a name="l00661"></a>00661                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00662"></a>00662                 }
<a name="l00663"></a>00663                 <a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a> begTime = inputStorage.readInt();
<a name="l00664"></a>00664                 <span class="comment">// begin time</span>
<a name="l00665"></a>00665                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>) {
<a name="l00666"></a>00666                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting effort using 4 parameters requires the end time as second parameter.&quot;</span>, outputStorage);
<a name="l00667"></a>00667                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00668"></a>00668                 }
<a name="l00669"></a>00669                 <a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#ae665eda71d2654ce49eea540f154a3c7">SUMOTime</a> endTime = inputStorage.readInt();
<a name="l00670"></a>00670                 <span class="comment">// edge</span>
<a name="l00671"></a>00671                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00672"></a>00672                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting effort using 4 parameters requires the referenced edge as third parameter.&quot;</span>, outputStorage);
<a name="l00673"></a>00673                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00674"></a>00674                 }
<a name="l00675"></a>00675                 std::string edgeID = inputStorage.readString();
<a name="l00676"></a>00676                 <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>* edge = <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(edgeID);
<a name="l00677"></a>00677                 <span class="keywordflow">if</span> (edge == 0) {
<a name="l00678"></a>00678                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Referenced edge &#39;&quot;</span> + edgeID + <span class="stringliteral">&quot;&#39; is not known.&quot;</span>, outputStorage);
<a name="l00679"></a>00679                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00680"></a>00680                 }
<a name="l00681"></a>00681                 <span class="comment">// value</span>
<a name="l00682"></a>00682                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>) {
<a name="l00683"></a>00683                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting effort using 4 parameters requires the travel time as fourth parameter.&quot;</span>, outputStorage);
<a name="l00684"></a>00684                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00685"></a>00685                 }
<a name="l00686"></a>00686                 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> value = inputStorage.readDouble();
<a name="l00687"></a>00687                 <span class="comment">// retrieve</span>
<a name="l00688"></a>00688                 <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getWeightsStorage().addEffort(edge, begTime, endTime, value);
<a name="l00689"></a>00689             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (parameterCount == 2) {
<a name="l00690"></a>00690                 <span class="comment">// edge</span>
<a name="l00691"></a>00691                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00692"></a>00692                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting effort using 2 parameters requires the referenced edge as first parameter.&quot;</span>, outputStorage);
<a name="l00693"></a>00693                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00694"></a>00694                 }
<a name="l00695"></a>00695                 std::string edgeID = inputStorage.readString();
<a name="l00696"></a>00696                 <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>* edge = <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(edgeID);
<a name="l00697"></a>00697                 <span class="keywordflow">if</span> (edge == 0) {
<a name="l00698"></a>00698                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Referenced edge &#39;&quot;</span> + edgeID + <span class="stringliteral">&quot;&#39; is not known.&quot;</span>, outputStorage);
<a name="l00699"></a>00699                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00700"></a>00700                 }
<a name="l00701"></a>00701                 <span class="comment">// value</span>
<a name="l00702"></a>00702                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>) {
<a name="l00703"></a>00703                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting effort using 2 parameters requires the travel time as second parameter.&quot;</span>, outputStorage);
<a name="l00704"></a>00704                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00705"></a>00705                 }
<a name="l00706"></a>00706                 <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> value = inputStorage.readDouble();
<a name="l00707"></a>00707                 <span class="comment">// retrieve</span>
<a name="l00708"></a>00708                 <span class="keywordflow">while</span> (static_cast&lt;MSVehicle*&gt;(v)-&gt;getWeightsStorage().knowsEffort(edge)) {
<a name="l00709"></a>00709                     <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getWeightsStorage().removeEffort(edge);
<a name="l00710"></a>00710                 }
<a name="l00711"></a>00711                 <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getWeightsStorage().addEffort(edge, 0, <a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#a5ba532efbf218127137edc651cf24e36">SUMOTime_MAX</a>, value);
<a name="l00712"></a>00712             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (parameterCount == 1) {
<a name="l00713"></a>00713                 <span class="comment">// edge</span>
<a name="l00714"></a>00714                 <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00715"></a>00715                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting effort using 1 parameter requires the referenced edge as first parameter.&quot;</span>, outputStorage);
<a name="l00716"></a>00716                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00717"></a>00717                 }
<a name="l00718"></a>00718                 std::string edgeID = inputStorage.readString();
<a name="l00719"></a>00719                 <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>* edge = <a class="code" href="../../d7/d27/class_m_s_edge.html#ab193f7a67f12ca616305c36964e5aa00" title="Inserts edge into the static dictionary Returns true if the key id isn&amp;#39;t already...">MSEdge::dictionary</a>(edgeID);
<a name="l00720"></a>00720                 <span class="keywordflow">if</span> (edge == 0) {
<a name="l00721"></a>00721                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Referenced edge &#39;&quot;</span> + edgeID + <span class="stringliteral">&quot;&#39; is not known.&quot;</span>, outputStorage);
<a name="l00722"></a>00722                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00723"></a>00723                 }
<a name="l00724"></a>00724                 <span class="comment">// retrieve</span>
<a name="l00725"></a>00725                 <span class="keywordflow">while</span> (static_cast&lt;MSVehicle*&gt;(v)-&gt;getWeightsStorage().knowsEffort(edge)) {
<a name="l00726"></a>00726                     <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getWeightsStorage().removeEffort(edge);
<a name="l00727"></a>00727                 }
<a name="l00728"></a>00728             } <span class="keywordflow">else</span> {
<a name="l00729"></a>00729                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting effort requires 1, 2, or 4 parameters.&quot;</span>, outputStorage);
<a name="l00730"></a>00730                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00731"></a>00731             }
<a name="l00732"></a>00732         }
<a name="l00733"></a>00733         <span class="keywordflow">break</span>;
<a name="l00734"></a>00734         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a9cf2d3b5926694eca9a290606153dbb6">CMD_REROUTE_TRAVELTIME</a>: {
<a name="l00735"></a>00735             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>) {
<a name="l00736"></a>00736                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Rerouting requires a compound object.&quot;</span>, outputStorage);
<a name="l00737"></a>00737                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00738"></a>00738             }
<a name="l00739"></a>00739             <span class="keywordflow">if</span> (inputStorage.readInt() != 0) {
<a name="l00740"></a>00740                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Rerouting should obtain an empty compound object.&quot;</span>, outputStorage);
<a name="l00741"></a>00741                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00742"></a>00742             }
<a name="l00743"></a>00743             <a class="code" href="../../d2/d35/class_m_s_net_1_1_edge_weights_proxi.html" title="A proxi for edge weights known by a vehicle/known globally.">MSNet::EdgeWeightsProxi</a> proxi(static_cast&lt;MSVehicle*&gt;(v)-&gt;getWeightsStorage(), <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;getWeightsStorage());
<a name="l00744"></a>00744             <a class="code" href="../../db/df3/class_dijkstra_router_t_t___by_proxi.html">DijkstraRouterTT_ByProxi&lt;MSEdge, SUMOVehicle, prohibited_withRestrictions&lt;MSEdge, SUMOVehicle&gt;</a>, <a class="code" href="../../d2/d35/class_m_s_net_1_1_edge_weights_proxi.html" title="A proxi for edge weights known by a vehicle/known globally.">MSNet::EdgeWeightsProxi</a>&gt; router(<a class="code" href="../../d7/d27/class_m_s_edge.html#a54b8eb3a4358e69944b8cbd77d94ceaf" title="Returns the number of edges.">MSEdge::dictSize</a>(), <span class="keyword">true</span>, &amp;proxi, &amp;<a class="code" href="../../d2/d35/class_m_s_net_1_1_edge_weights_proxi.html#aa407ea973d857ea6f62a3a10d73c0de9" title="Returns the travel time to pass an edge.">MSNet::EdgeWeightsProxi::getTravelTime</a>);
<a name="l00745"></a>00745             v-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#aa1e7c0df48756bd41655748e7f822b62" title="Performs a rerouting using the given router.">reroute</a>(<a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;getCurrentTimeStep(), router);
<a name="l00746"></a>00746         }
<a name="l00747"></a>00747         <span class="keywordflow">break</span>;
<a name="l00748"></a>00748         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a27d763793c3a43050ece9e76caa0f697">CMD_REROUTE_EFFORT</a>: {
<a name="l00749"></a>00749             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>) {
<a name="l00750"></a>00750                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Rerouting requires a compound object.&quot;</span>, outputStorage);
<a name="l00751"></a>00751                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00752"></a>00752             }
<a name="l00753"></a>00753             <span class="keywordflow">if</span> (inputStorage.readInt() != 0) {
<a name="l00754"></a>00754                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Rerouting should obtain an empty compound object.&quot;</span>, outputStorage);
<a name="l00755"></a>00755                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00756"></a>00756             }
<a name="l00757"></a>00757             <a class="code" href="../../d2/d35/class_m_s_net_1_1_edge_weights_proxi.html" title="A proxi for edge weights known by a vehicle/known globally.">MSNet::EdgeWeightsProxi</a> proxi(static_cast&lt;MSVehicle*&gt;(v)-&gt;getWeightsStorage(), <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;getWeightsStorage());
<a name="l00758"></a>00758             <a class="code" href="../../d3/daf/class_dijkstra_router_effort___by_proxi.html">DijkstraRouterEffort_ByProxi&lt;MSEdge, SUMOVehicle, prohibited_withRestrictions&lt;MSEdge, SUMOVehicle&gt;</a>, <a class="code" href="../../d2/d35/class_m_s_net_1_1_edge_weights_proxi.html" title="A proxi for edge weights known by a vehicle/known globally.">MSNet::EdgeWeightsProxi</a>&gt; router(<a class="code" href="../../d7/d27/class_m_s_edge.html#a54b8eb3a4358e69944b8cbd77d94ceaf" title="Returns the number of edges.">MSEdge::dictSize</a>(), <span class="keyword">true</span>, &amp;proxi, &amp;<a class="code" href="../../d2/d35/class_m_s_net_1_1_edge_weights_proxi.html#a3898cc0ec65fcd284a1ae1f390d5374c" title="Returns the effort to pass an edge.">MSNet::EdgeWeightsProxi::getEffort</a>, &amp;<a class="code" href="../../d2/d35/class_m_s_net_1_1_edge_weights_proxi.html#aa407ea973d857ea6f62a3a10d73c0de9" title="Returns the travel time to pass an edge.">MSNet::EdgeWeightsProxi::getTravelTime</a>);
<a name="l00759"></a>00759             v-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#aa1e7c0df48756bd41655748e7f822b62" title="Performs a rerouting using the given router.">reroute</a>(<a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;getCurrentTimeStep(), router);
<a name="l00760"></a>00760         }
<a name="l00761"></a>00761         <span class="keywordflow">break</span>;
<a name="l00762"></a>00762         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a7378a076f1ed4fb133d04d474ec36110">VAR_SIGNALS</a>:
<a name="l00763"></a>00763             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>) {
<a name="l00764"></a>00764                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting signals requires an integer.&quot;</span>, outputStorage);
<a name="l00765"></a>00765                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00766"></a>00766             }
<a name="l00767"></a>00767             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;switchOffSignal(0x0fffffff);
<a name="l00768"></a>00768             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;switchOnSignal(inputStorage.readInt());
<a name="l00769"></a>00769             <span class="keywordflow">break</span>;
<a name="l00770"></a>00770         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ad18db3a6f2be838f3ea6d75bb1784b5e">VAR_MOVE_TO</a>: {
<a name="l00771"></a>00771             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>) {
<a name="l00772"></a>00772                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting position requires a compound object.&quot;</span>, outputStorage);
<a name="l00773"></a>00773                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00774"></a>00774             }
<a name="l00775"></a>00775             <span class="keywordflow">if</span> (inputStorage.readInt() != 2) {
<a name="l00776"></a>00776                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting position should obtain the lane id and the position.&quot;</span>, outputStorage);
<a name="l00777"></a>00777                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00778"></a>00778             }
<a name="l00779"></a>00779             <span class="comment">// lane ID</span>
<a name="l00780"></a>00780             <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00781"></a>00781                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The first parameter for setting a position must be the lane ID given as a string.&quot;</span>, outputStorage);
<a name="l00782"></a>00782                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00783"></a>00783             }
<a name="l00784"></a>00784             std::string laneID = inputStorage.readString();
<a name="l00785"></a>00785             <span class="comment">// position on lane</span>
<a name="l00786"></a>00786             <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>) {
<a name="l00787"></a>00787                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The second parameter for setting a position must be the position given as a double.&quot;</span>, outputStorage);
<a name="l00788"></a>00788                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00789"></a>00789             }
<a name="l00790"></a>00790             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> position = inputStorage.readDouble();
<a name="l00791"></a>00791             <span class="comment">// process</span>
<a name="l00792"></a>00792             <a class="code" href="../../d9/d16/class_m_s_lane.html" title="Representation of a lane in the micro simulation.">MSLane</a>* l = <a class="code" href="../../d9/d16/class_m_s_lane.html#a965f4a235ad88d59aa404c1054dafe75" title="Inserts a MSLane into the static dictionary Returns true if the key id isn&amp;#39;t...">MSLane::dictionary</a>(laneID);
<a name="l00793"></a>00793             <span class="keywordflow">if</span> (l == 0) {
<a name="l00794"></a>00794                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Unknown lane &#39;&quot;</span> + laneID + <span class="stringliteral">&quot;&#39;.&quot;</span>, outputStorage);
<a name="l00795"></a>00795                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00796"></a>00796             }
<a name="l00797"></a>00797             <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>&amp; destinationEdge = l-&gt;<a class="code" href="../../d9/d16/class_m_s_lane.html#ad689e4b858799c088f315442527a814f" title="Returns the lane&amp;#39;s edge.">getEdge</a>();
<a name="l00798"></a>00798             <span class="keywordflow">if</span> (!static_cast&lt;MSVehicle*&gt;(v)-&gt;willPass(&amp;destinationEdge)) {
<a name="l00799"></a>00799                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Vehicle &#39;&quot;</span> + laneID + <span class="stringliteral">&quot;&#39; may be set onto an edge to pass only.&quot;</span>, outputStorage);
<a name="l00800"></a>00800                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00801"></a>00801             }
<a name="l00802"></a>00802             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;onRemovalFromNet(<a class="code" href="../../d2/da5/class_m_s_move_reminder.html#a9bb933702facf0323c2541dfb8d5c208ad93ce3d4d37f62438fda41cd6b54ea1c" title="The vehicle is being teleported.">MSMoveReminder::NOTIFICATION_TELEPORT</a>);
<a name="l00803"></a>00803             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getLane()-&gt;removeVehicle(static_cast&lt;MSVehicle*&gt;(v));
<a name="l00804"></a>00804             <span class="keywordflow">while</span> (v-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#ae0bbeab1f4e41bce8cf615383efd3605" title="Returns the edge the vehicle is currently at.">getEdge</a>() != &amp;destinationEdge) {
<a name="l00805"></a>00805                 <span class="keyword">const</span> <a class="code" href="../../d7/d27/class_m_s_edge.html" title="A road/street connecting two junctions.">MSEdge</a>* nextEdge = v-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#ad830643d8b2588f2a225bd56fbf34232" title="Returns the nSuccs&amp;#39;th successor of edge the vehicle is currently at.">succEdge</a>(1);
<a name="l00806"></a>00806                 <span class="comment">// let the vehicle move to the next edge</span>
<a name="l00807"></a>00807                 <span class="keywordflow">if</span> (static_cast&lt;MSVehicle*&gt;(v)-&gt;enterLaneAtMove(nextEdge-&gt;<a class="code" href="../../d7/d27/class_m_s_edge.html#ac6454be7984c840da4fa48808cf22833" title="Returns this edge&amp;#39;s lanes.">getLanes</a>()[0], <span class="keyword">true</span>)) {
<a name="l00808"></a>00808                     <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;<a class="code" href="../../dc/d5d/class_m_s_net.html#a5e74ee833cafefa74b84e2091ef135a3" title="Returns the vehicle control.">getVehicleControl</a>().<a class="code" href="../../db/d2f/class_m_s_vehicle_control.html#a6e4e7c40a22f899b7f114d0d74aa6db3" title="Removes a vehicle after it has ended.">scheduleVehicleRemoval</a>(v);
<a name="l00809"></a>00809                     <span class="keywordflow">continue</span>;
<a name="l00810"></a>00810                 }
<a name="l00811"></a>00811             }
<a name="l00812"></a>00812             l-&gt;<a class="code" href="../../d9/d16/class_m_s_lane.html#a472c487de40e4471a65dc0ac1edc9696" title="Inserts the given vehicle at the given position.">forceVehicleInsertion</a>(static_cast&lt;MSVehicle*&gt;(v), position);
<a name="l00813"></a>00813         }
<a name="l00814"></a>00814         <span class="keywordflow">break</span>;
<a name="l00815"></a>00815         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a803f3a1743aef11a357e838e50d80f6a">VAR_SPEED</a>: {
<a name="l00816"></a>00816             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>) {
<a name="l00817"></a>00817                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting speed requires a double.&quot;</span>, outputStorage);
<a name="l00818"></a>00818                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00819"></a>00819             }
<a name="l00820"></a>00820             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> speed = inputStorage.readDouble();
<a name="l00821"></a>00821             std::vector&lt;std::pair&lt;SUMOTime, SUMOReal&gt; &gt; speedTimeLine;
<a name="l00822"></a>00822             <span class="keywordflow">if</span> (speed &gt;= 0) {
<a name="l00823"></a>00823                 speedTimeLine.push_back(std::make_pair(<a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;getCurrentTimeStep(), speed));
<a name="l00824"></a>00824                 speedTimeLine.push_back(std::make_pair(<a class="code" href="../../d4/d64/_s_u_m_o_time_8h.html#a5ba532efbf218127137edc651cf24e36">SUMOTime_MAX</a>, speed));
<a name="l00825"></a>00825             }
<a name="l00826"></a>00826             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getInfluencer().setSpeedTimeLine(speedTimeLine);
<a name="l00827"></a>00827         }
<a name="l00828"></a>00828         <span class="keywordflow">break</span>;
<a name="l00829"></a>00829         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5c4f611616810959183c7b4e1d6e1b88">VAR_SPEEDSETMODE</a>: {
<a name="l00830"></a>00830             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>) {
<a name="l00831"></a>00831                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Setting speed requires a double.&quot;</span>, outputStorage);
<a name="l00832"></a>00832                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00833"></a>00833             }
<a name="l00834"></a>00834             <span class="keywordtype">int</span> speedMode = inputStorage.readInt();
<a name="l00835"></a>00835             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getInfluencer().setConsiderSafeVelocity((speedMode &amp; 1) != 0);
<a name="l00836"></a>00836             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getInfluencer().setConsiderMaxAcceleration((speedMode &amp; 2) != 0);
<a name="l00837"></a>00837             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getInfluencer().setConsiderMaxDeceleration((speedMode &amp; 4) != 0);
<a name="l00838"></a>00838         }
<a name="l00839"></a>00839         <span class="keywordflow">break</span>;
<a name="l00840"></a>00840         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#adcc89457ed75668afd992c756fc58549">VAR_COLOR</a>: {
<a name="l00841"></a>00841             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4a2941e13cc0bd28c847984e7f573850">TYPE_COLOR</a>) {
<a name="l00842"></a>00842                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The color must be given using the according type.&quot;</span>, outputStorage);
<a name="l00843"></a>00843                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00844"></a>00844             }
<a name="l00845"></a>00845             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> r = (<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>) inputStorage.readUnsignedByte() / 255.;
<a name="l00846"></a>00846             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> g = (<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>) inputStorage.readUnsignedByte() / 255.;
<a name="l00847"></a>00847             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> b = (<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>) inputStorage.readUnsignedByte() / 255.;
<a name="l00848"></a>00848             inputStorage.readUnsignedByte(); <span class="comment">// skip alpha level</span>
<a name="l00849"></a>00849             v-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#aefc68ae53dd26cdb0f174e36d9c91a2c" title="Returns the vehicle&amp;#39;s parameter (including departure definition).">getParameter</a>().<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a9f2aaf24a7bd52568405319ebc2283b3" title="The vehicle&amp;#39;s color.">color</a>.<a class="code" href="../../da/da9/class_r_g_b_color.html#a965c83447d51f468e408518f79c0e992" title="assigns new values">set</a>(r, g, b);
<a name="l00850"></a>00850         }
<a name="l00851"></a>00851         <span class="keywordflow">break</span>;
<a name="l00852"></a>00852         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a97fe5470fb1ac167c713671655ff3e52">ADD</a>: {
<a name="l00853"></a>00853             <span class="keywordflow">if</span> (v != 0) {
<a name="l00854"></a>00854                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;The vehicle &quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot; to add already exists.&quot;</span>, outputStorage);
<a name="l00855"></a>00855                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00856"></a>00856             }
<a name="l00857"></a>00857             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>) {
<a name="l00858"></a>00858                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Adding a vehicle requires a compound object.&quot;</span>, outputStorage);
<a name="l00859"></a>00859                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00860"></a>00860             }
<a name="l00861"></a>00861             <span class="keywordflow">if</span> (inputStorage.readInt() != 6) {
<a name="l00862"></a>00862                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Adding a vehicle needs six parameters.&quot;</span>, outputStorage);
<a name="l00863"></a>00863                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00864"></a>00864             }
<a name="l00865"></a>00865             <a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html" title="Structure representing possible vehicle parameter.">SUMOVehicleParameter</a> vehicleParams;
<a name="l00866"></a>00866             vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#ab39b1071f7e8b20fc560b30685069601" title="The vehicle&amp;#39;s id.">id</a> = id;
<a name="l00867"></a>00867 
<a name="l00868"></a>00868             <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00869"></a>00869                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;First parameter (type) requires a string.&quot;</span>, outputStorage);
<a name="l00870"></a>00870                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00871"></a>00871             }
<a name="l00872"></a>00872             <a class="code" href="../../de/da2/class_m_s_vehicle_type.html" title="The car-following model and parameter.">MSVehicleType</a>* vehicleType = <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;<a class="code" href="../../dc/d5d/class_m_s_net.html#a5e74ee833cafefa74b84e2091ef135a3" title="Returns the vehicle control.">getVehicleControl</a>().<a class="code" href="../../db/d2f/class_m_s_vehicle_control.html#a95ddc958055c59d379d373aeb39621b5" title="Returns the named vehicle type or a sample from the named distribution.">getVType</a>(inputStorage.readString());
<a name="l00873"></a>00873             <span class="keywordflow">if</span> (!vehicleType) {
<a name="l00874"></a>00874                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Invalid type for vehicle: &#39;&quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot;&#39;&quot;</span>);
<a name="l00875"></a>00875                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00876"></a>00876             }
<a name="l00877"></a>00877 
<a name="l00878"></a>00878             <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4e4e428e3a6a191834e3ff63bd301866">TYPE_STRING</a>) {
<a name="l00879"></a>00879                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Second parameter (route) requires a string.&quot;</span>, outputStorage);
<a name="l00880"></a>00880                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00881"></a>00881             }
<a name="l00882"></a>00882             <span class="keyword">const</span> std::string routeID = inputStorage.readString();
<a name="l00883"></a>00883             <span class="keyword">const</span> <a class="code" href="../../de/dd8/class_m_s_route.html">MSRoute</a>* route = <a class="code" href="../../de/dd8/class_m_s_route.html#a379e71c30ffbb0c2366b47f32014980f" title="Adds a route to the dictionary.">MSRoute::dictionary</a>(routeID);
<a name="l00884"></a>00884             <span class="keywordflow">if</span> (!route) {
<a name="l00885"></a>00885                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Invalid route &#39;&quot;</span> + routeID + <span class="stringliteral">&quot;&#39; for vehicle: &#39;&quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot;&#39;&quot;</span>);
<a name="l00886"></a>00886                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00887"></a>00887             }
<a name="l00888"></a>00888 
<a name="l00889"></a>00889             <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a929147425bf7969fe1d0e33716d02bc8">TYPE_INTEGER</a>) {
<a name="l00890"></a>00890                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Third parameter (depart) requires an integer.&quot;</span>, outputStorage);
<a name="l00891"></a>00891                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00892"></a>00892             }
<a name="l00893"></a>00893             vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#aded3ab5fa08e689297b7db36b24c3cf8" title="The vehicle&amp;#39;s departure time.">depart</a> = inputStorage.readInt();
<a name="l00894"></a>00894             <span class="keywordflow">if</span> (vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#aded3ab5fa08e689297b7db36b24c3cf8" title="The vehicle&amp;#39;s departure time.">depart</a> &lt; 0) {
<a name="l00895"></a>00895                 <span class="keyword">const</span> <span class="keywordtype">int</span> proc = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(-vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#aded3ab5fa08e689297b7db36b24c3cf8" title="The vehicle&amp;#39;s departure time.">depart</a>);
<a name="l00896"></a>00896                 <span class="keywordflow">if</span> (proc &gt;= static_cast&lt;int&gt;(<a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#afcfaa02b708ce30f5cf9bd455ed00db9ad05eddfe68bdf833ee8442c5dc1eccfa" title="Tag for the last element in the enum for safe int casting.">DEPART_DEF_MAX</a>)) {
<a name="l00897"></a>00897                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Invalid departure time.&quot;</span>, outputStorage);
<a name="l00898"></a>00898                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00899"></a>00899                 }
<a name="l00900"></a>00900                 vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#ae42a14e21b5d040f3058ef5194e50c35" title="Information how the vehicle shall choose the depart time.">departProcedure</a> = (<a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#afcfaa02b708ce30f5cf9bd455ed00db9" title="Possible ways to depart.">DepartDefinition</a>)proc;
<a name="l00901"></a>00901             }
<a name="l00902"></a>00902 
<a name="l00903"></a>00903             <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>) {
<a name="l00904"></a>00904                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Fourth parameter (position) requires a double.&quot;</span>, outputStorage);
<a name="l00905"></a>00905                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00906"></a>00906             }
<a name="l00907"></a>00907             vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a195725a608fcb67146bcf17a514364d8" title="(optional) The position the vehicle shall depart from">departPos</a> = inputStorage.readDouble();
<a name="l00908"></a>00908             <span class="keywordflow">if</span> (vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a195725a608fcb67146bcf17a514364d8" title="(optional) The position the vehicle shall depart from">departPos</a> &lt; 0) {
<a name="l00909"></a>00909                 <span class="keyword">const</span> <span class="keywordtype">int</span> proc = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(-vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a195725a608fcb67146bcf17a514364d8" title="(optional) The position the vehicle shall depart from">departPos</a>);
<a name="l00910"></a>00910                 <span class="keywordflow">if</span> (proc &gt;= static_cast&lt;int&gt;(<a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#a45be79475e1bebb6597a900ede9696eba7ff580c1a6bc7e8ed7697cbafcc84320" title="Tag for the last element in the enum for safe int casting.">DEPART_POS_DEF_MAX</a>)) {
<a name="l00911"></a>00911                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Invalid departure position.&quot;</span>, outputStorage);
<a name="l00912"></a>00912                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00913"></a>00913                 }
<a name="l00914"></a>00914                 vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#aed532f20afe62f5230142f41abfc33c6" title="Information how the vehicle shall choose the departure position.">departPosProcedure</a> = (<a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#a45be79475e1bebb6597a900ede9696eb" title="Possible ways to choose the departure position.">DepartPosDefinition</a>)proc;
<a name="l00915"></a>00915             } <span class="keywordflow">else</span> {
<a name="l00916"></a>00916                 vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#aed532f20afe62f5230142f41abfc33c6" title="Information how the vehicle shall choose the departure position.">departPosProcedure</a> = <a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#a45be79475e1bebb6597a900ede9696eba346157eda9517e9bf6ffd50690624c34" title="The position is given.">DEPART_POS_GIVEN</a>;
<a name="l00917"></a>00917             }
<a name="l00918"></a>00918 
<a name="l00919"></a>00919             <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>) {
<a name="l00920"></a>00920                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Fifth parameter (speed) requires a double.&quot;</span>, outputStorage);
<a name="l00921"></a>00921                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00922"></a>00922             }
<a name="l00923"></a>00923             vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a5c03f2409490073343459a4b966e7c7a" title="(optional) The initial speed of the vehicle">departSpeed</a> = inputStorage.readDouble();
<a name="l00924"></a>00924             <span class="keywordflow">if</span> (vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a5c03f2409490073343459a4b966e7c7a" title="(optional) The initial speed of the vehicle">departSpeed</a> &lt; 0) {
<a name="l00925"></a>00925                 <span class="keyword">const</span> <span class="keywordtype">int</span> proc = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(-vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a5c03f2409490073343459a4b966e7c7a" title="(optional) The initial speed of the vehicle">departSpeed</a>);
<a name="l00926"></a>00926                 <span class="keywordflow">if</span> (proc &gt;= static_cast&lt;int&gt;(<a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#a829433da329e7fac85ffd83d20d60346ae92ad48e77e8b0cbb14c864d75354992" title="Tag for the last element in the enum for safe int casting.">DEPART_SPEED_DEF_MAX</a>)) {
<a name="l00927"></a>00927                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Invalid departure speed.&quot;</span>, outputStorage);
<a name="l00928"></a>00928                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00929"></a>00929                 }
<a name="l00930"></a>00930                 vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a9d5b4256e9937eae3c6b549961736e42" title="Information how the vehicle&amp;#39;s initial speed shall be chosen.">departSpeedProcedure</a> = (<a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#a829433da329e7fac85ffd83d20d60346" title="Possible ways to choose the departure speed.">DepartSpeedDefinition</a>)proc;
<a name="l00931"></a>00931             } <span class="keywordflow">else</span> {
<a name="l00932"></a>00932                 vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a9d5b4256e9937eae3c6b549961736e42" title="Information how the vehicle&amp;#39;s initial speed shall be chosen.">departSpeedProcedure</a> = <a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#a829433da329e7fac85ffd83d20d60346a7f48b5a378840a1589ac3c2126013603" title="The speed is given.">DEPART_SPEED_GIVEN</a>;
<a name="l00933"></a>00933             }
<a name="l00934"></a>00934 
<a name="l00935"></a>00935             <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ad62574650f26d2392ab55729769948b8">TYPE_BYTE</a>) {
<a name="l00936"></a>00936                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Sixth parameter (lane) requires a byte.&quot;</span>, outputStorage);
<a name="l00937"></a>00937                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00938"></a>00938             }
<a name="l00939"></a>00939             vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a19d5d48f0b96c41d517b33a314877f06" title="(optional) The lane the vehicle shall depart from (index in edge)">departLane</a> = inputStorage.readByte();
<a name="l00940"></a>00940             <span class="keywordflow">if</span> (vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a19d5d48f0b96c41d517b33a314877f06" title="(optional) The lane the vehicle shall depart from (index in edge)">departLane</a> &lt; 0) {
<a name="l00941"></a>00941                 <span class="keyword">const</span> <span class="keywordtype">int</span> proc = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(-vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a19d5d48f0b96c41d517b33a314877f06" title="(optional) The lane the vehicle shall depart from (index in edge)">departLane</a>);
<a name="l00942"></a>00942                 <span class="keywordflow">if</span> (proc &gt;= static_cast&lt;int&gt;(<a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#a3d90729fd1f1391848d8574e28ead6b4a6327efce28a7f388e996ad67b6aacf80" title="Tag for the last element in the enum for safe int casting.">DEPART_LANE_DEF_MAX</a>)) {
<a name="l00943"></a>00943                     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Invalid departure lane.&quot;</span>, outputStorage);
<a name="l00944"></a>00944                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00945"></a>00945                 }
<a name="l00946"></a>00946                 vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a53d0c26882af309339a23a96883e3399" title="Information how the vehicle shall choose the lane to depart from.">departLaneProcedure</a> = (<a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#a3d90729fd1f1391848d8574e28ead6b4" title="Possible ways to choose a lane on depart.">DepartLaneDefinition</a>)proc;
<a name="l00947"></a>00947             } <span class="keywordflow">else</span> {
<a name="l00948"></a>00948                 vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#a53d0c26882af309339a23a96883e3399" title="Information how the vehicle shall choose the lane to depart from.">departLaneProcedure</a> = <a class="code" href="../../d0/d7a/_s_u_m_o_vehicle_parameter_8h.html#a3d90729fd1f1391848d8574e28ead6b4af4ac10ebb7f8d36edbcf79a597ef2525" title="The lane is given.">DEPART_LANE_GIVEN</a>;
<a name="l00949"></a>00949             }
<a name="l00950"></a>00950 
<a name="l00951"></a>00951             <a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html" title="Structure representing possible vehicle parameter.">SUMOVehicleParameter</a>* params = <span class="keyword">new</span> <a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html" title="Structure representing possible vehicle parameter.">SUMOVehicleParameter</a>();
<a name="l00952"></a>00952             *params = vehicleParams;
<a name="l00953"></a>00953             <span class="keywordflow">try</span> {
<a name="l00954"></a>00954                 <a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html" title="Representation of a vehicle.">SUMOVehicle</a>* vehicle = <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;<a class="code" href="../../dc/d5d/class_m_s_net.html#a5e74ee833cafefa74b84e2091ef135a3" title="Returns the vehicle control.">getVehicleControl</a>().<a class="code" href="../../db/d2f/class_m_s_vehicle_control.html#a03be9f9e122e132fcc440afe5e324f1a" title="Builds a vehicle, increases the number of built vehicles.">buildVehicle</a>(params, route, vehicleType);
<a name="l00955"></a>00955                 <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;<a class="code" href="../../dc/d5d/class_m_s_net.html#a5e74ee833cafefa74b84e2091ef135a3" title="Returns the vehicle control.">getVehicleControl</a>().<a class="code" href="../../db/d2f/class_m_s_vehicle_control.html#a4a596b620fe88ac471ea9e905762ee44" title="Tries to insert the vehicle into the internal vehicle container.">addVehicle</a>(vehicleParams.<a class="code" href="../../d8/d51/class_s_u_m_o_vehicle_parameter.html#ab39b1071f7e8b20fc560b30685069601" title="The vehicle&amp;#39;s id.">id</a>, vehicle);
<a name="l00956"></a>00956                 <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;<a class="code" href="../../dc/d5d/class_m_s_net.html#ab1fb4671cf35fef2b2cee49c3cdcc906" title="Returns the insertion control.">getInsertionControl</a>().<a class="code" href="../../d6/d7e/class_m_s_insertion_control.html#a92efb4bf39c635132f0ff821b939ead3" title="Adds a single vehicle for departure.">add</a>(vehicle);
<a name="l00957"></a>00957             } <span class="keywordflow">catch</span> (<a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>&amp; e) {
<a name="l00958"></a>00958                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, e.what(), outputStorage);
<a name="l00959"></a>00959                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00960"></a>00960             }
<a name="l00961"></a>00961         }
<a name="l00962"></a>00962         <span class="keywordflow">break</span>;
<a name="l00963"></a>00963         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ab9959e75e26bc66b3733ddc04de6b4cf">REMOVE</a>: {
<a name="l00964"></a>00964             <span class="keywordflow">if</span> (valueDataType != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ad62574650f26d2392ab55729769948b8">TYPE_BYTE</a>) {
<a name="l00965"></a>00965                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Removing a vehicle requires an int.&quot;</span>, outputStorage);
<a name="l00966"></a>00966                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00967"></a>00967             }
<a name="l00968"></a>00968             <span class="keywordtype">int</span> why = (int) inputStorage.readByte();
<a name="l00969"></a>00969             <a class="code" href="../../d2/da5/class_m_s_move_reminder.html#a9bb933702facf0323c2541dfb8d5c208" title="Definition of a vehicle state.">MSMoveReminder::Notification</a> n = <a class="code" href="../../d2/da5/class_m_s_move_reminder.html#a9bb933702facf0323c2541dfb8d5c208a05f89e60442b524353e3880948a2ebd6" title="The vehicle arrived at its destination (is deleted).">MSMoveReminder::NOTIFICATION_ARRIVED</a>;
<a name="l00970"></a>00970             <span class="keywordflow">switch</span> (why) {
<a name="l00971"></a>00971                 <span class="keywordflow">case</span> 0:
<a name="l00972"></a>00972                     n = <a class="code" href="../../d2/da5/class_m_s_move_reminder.html#a9bb933702facf0323c2541dfb8d5c208ad93ce3d4d37f62438fda41cd6b54ea1c" title="The vehicle is being teleported.">MSMoveReminder::NOTIFICATION_TELEPORT</a>;
<a name="l00973"></a>00973                     <span class="keywordflow">break</span>;
<a name="l00974"></a>00974                 <span class="keywordflow">case</span> 1:
<a name="l00975"></a>00975                     n = <a class="code" href="../../d2/da5/class_m_s_move_reminder.html#a9bb933702facf0323c2541dfb8d5c208aa355dac25cb1e199a405cdc3c9e8015d" title="The vehicle starts or ends parking.">MSMoveReminder::NOTIFICATION_PARKING</a>;
<a name="l00976"></a>00976                     <span class="keywordflow">break</span>;
<a name="l00977"></a>00977                 <span class="keywordflow">case</span> 2:
<a name="l00978"></a>00978                     n = <a class="code" href="../../d2/da5/class_m_s_move_reminder.html#a9bb933702facf0323c2541dfb8d5c208a05f89e60442b524353e3880948a2ebd6" title="The vehicle arrived at its destination (is deleted).">MSMoveReminder::NOTIFICATION_ARRIVED</a>;
<a name="l00979"></a>00979                     <span class="keywordflow">break</span>;
<a name="l00980"></a>00980                 <span class="keywordflow">case</span> 3:
<a name="l00981"></a>00981                     n = <a class="code" href="../../d2/da5/class_m_s_move_reminder.html#a9bb933702facf0323c2541dfb8d5c208ab2752186a83e9f779223861bbba3f719" title="The vehicle got vaporized.">MSMoveReminder::NOTIFICATION_VAPORIZED</a>;
<a name="l00982"></a>00982                     <span class="keywordflow">break</span>;
<a name="l00983"></a>00983                 <span class="keywordflow">case</span> 4:
<a name="l00984"></a>00984                 <span class="keywordflow">default</span>:
<a name="l00985"></a>00985                     n = <a class="code" href="../../d2/da5/class_m_s_move_reminder.html#a9bb933702facf0323c2541dfb8d5c208a1729714e5f72792de0eab204a06b384f" title="The vehicle was teleported out of the net.">MSMoveReminder::NOTIFICATION_TELEPORT_ARRIVED</a>;
<a name="l00986"></a>00986                     <span class="keywordflow">break</span>;
<a name="l00987"></a>00987             }
<a name="l00988"></a>00988             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;onRemovalFromNet(n);
<a name="l00989"></a>00989             <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(v)-&gt;getLane()-&gt;removeVehicle(static_cast&lt;MSVehicle*&gt;(v));
<a name="l00990"></a>00990             <a class="code" href="../../dc/d5d/class_m_s_net.html#a2024ec4396b66fd698bb581fc5cc3408" title="Returns the pointer to the unique instance of MSNet (singleton).">MSNet::getInstance</a>()-&gt;<a class="code" href="../../dc/d5d/class_m_s_net.html#a5e74ee833cafefa74b84e2091ef135a3" title="Returns the vehicle control.">getVehicleControl</a>().<a class="code" href="../../db/d2f/class_m_s_vehicle_control.html#a6e4e7c40a22f899b7f114d0d74aa6db3" title="Removes a vehicle after it has ended.">scheduleVehicleRemoval</a>(static_cast&lt;MSVehicle*&gt;(v));
<a name="l00991"></a>00991         }
<a name="l00992"></a>00992         <span class="keywordflow">break</span>;
<a name="l00993"></a>00993         <span class="keywordflow">default</span>:
<a name="l00994"></a>00994             <span class="keywordflow">try</span> {
<a name="l00995"></a>00995                 <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d89/class_tra_c_i_server_a_p_i___vehicle_type.html#a3b74fb83ddfcc6b6a6e736fb03ffa7fd" title="Processes a set value for the given type.">TraCIServerAPI_VehicleType::setVariable</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, variable, valueDataType,
<a name="l00996"></a>00996                         <a class="code" href="../../d9/d85/class_tra_c_i_server_a_p_i___vehicle.html#a03021b6c8434ce6849371ea43c9eef2d">getSingularType</a>(v), server, inputStorage, outputStorage)) {
<a name="l00997"></a>00997                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00998"></a>00998                 }
<a name="l00999"></a>00999             } <span class="keywordflow">catch</span> (<a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>&amp; e) {
<a name="l01000"></a>01000                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, e.what(), outputStorage);
<a name="l01001"></a>01001                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01002"></a>01002             }
<a name="l01003"></a>01003             <span class="keywordflow">break</span>;
<a name="l01004"></a>01004     }
<a name="l01005"></a>01005     server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a4daee312282fa61ce2b2c9e19dc71fab">CMD_SET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a541fc8755958a227fe412e2df7fa31fa">RTYPE_OK</a>, warning, outputStorage);
<a name="l01006"></a>01006     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01007"></a>01007 }
<a name="l01008"></a>01008 
<a name="l01009"></a>01009 
<a name="l01010"></a>01010 <span class="keywordtype">bool</span>
<a name="l01011"></a><a class="code" href="../../d9/d85/class_tra_c_i_server_a_p_i___vehicle.html#a9f69b8fce5841ce4e84111b9b01e6747">01011</a> <a class="code" href="../../d9/d85/class_tra_c_i_server_a_p_i___vehicle.html#a9f69b8fce5841ce4e84111b9b01e6747">TraCIServerAPI_Vehicle::commandDistanceRequest</a>(<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html">traci::TraCIServer</a>&amp; server, tcpip::Storage&amp; inputStorage,
<a name="l01012"></a>01012         tcpip::Storage&amp; outputStorage, <span class="keyword">const</span> <a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>* v) {
<a name="l01013"></a>01013     <span class="keywordflow">if</span> (inputStorage.readUnsignedByte() != <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a5af12da4378875209e0b79bbe6b70e48">TYPE_COMPOUND</a>) {
<a name="l01014"></a>01014         server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Retrieval of distance requires a compound object.&quot;</span>, outputStorage);
<a name="l01015"></a>01015         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01016"></a>01016     }
<a name="l01017"></a>01017     <span class="keywordflow">if</span> (inputStorage.readInt() != 2) {
<a name="l01018"></a>01018         server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Retrieval of distance requires position and distance type as parameter.&quot;</span>, outputStorage);
<a name="l01019"></a>01019         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01020"></a>01020     }
<a name="l01021"></a>01021 
<a name="l01022"></a>01022     <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a> pos;
<a name="l01023"></a>01023     std::pair&lt;const MSLane*, SUMOReal&gt; roadPos;
<a name="l01024"></a>01024 
<a name="l01025"></a>01025     <span class="comment">// read position</span>
<a name="l01026"></a>01026     <span class="keywordtype">int</span> posType = inputStorage.readUnsignedByte();
<a name="l01027"></a>01027     <span class="keywordflow">switch</span> (posType) {
<a name="l01028"></a>01028         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a82812c142e13bbb144d26ac69b291cec">POSITION_ROADMAP</a>:
<a name="l01029"></a>01029             <span class="keywordflow">try</span> {
<a name="l01030"></a>01030                 std::string roadID = inputStorage.readString();
<a name="l01031"></a>01031                 roadPos.second = inputStorage.readDouble();
<a name="l01032"></a>01032                 roadPos.first = <a class="code" href="../../dd/d18/class_tra_c_i_server_a_p_i___simulation.html#a64cef3416ec98c08ee4b997777c99fcd">TraCIServerAPI_Simulation::getLaneChecking</a>(roadID, inputStorage.readUnsignedByte(), roadPos.second);
<a name="l01033"></a>01033                 pos = roadPos.first-&gt;getShape().positionAtLengthPosition(roadPos.second);
<a name="l01034"></a>01034             } <span class="keywordflow">catch</span> (<a class="code" href="../../d0/d48/classtraci_1_1_tra_c_i_exception.html">TraCIException</a>&amp; e) {
<a name="l01035"></a>01035                 server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, e.what());
<a name="l01036"></a>01036                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01037"></a>01037             }
<a name="l01038"></a>01038             <span class="keywordflow">break</span>;
<a name="l01039"></a>01039         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a9fc3eb37a8ae494084b863c411cf8c17">POSITION_2D</a>:
<a name="l01040"></a>01040         <span class="keywordflow">case</span> <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a2e4e2d4459c881109b0b40d723d5ba8b">POSITION_3D</a>: {
<a name="l01041"></a>01041             <span class="keyword">const</span> <span class="keywordtype">double</span> p1x = inputStorage.readDouble();
<a name="l01042"></a>01042             <span class="keyword">const</span> <span class="keywordtype">double</span> p1y = inputStorage.readDouble();
<a name="l01043"></a>01043             pos.<a class="code" href="../../d7/d3b/class_position.html#a9e95806c9ddc681993f7a6a09d0d838b">set</a>(p1x, p1y);
<a name="l01044"></a>01044         }
<a name="l01045"></a>01045         <span class="keywordflow">if</span> (posType == <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a2e4e2d4459c881109b0b40d723d5ba8b">POSITION_3D</a>) {
<a name="l01046"></a>01046             inputStorage.readDouble();      <span class="comment">// z value is ignored</span>
<a name="l01047"></a>01047         }
<a name="l01048"></a>01048         roadPos = <a class="code" href="../../dd/d18/class_tra_c_i_server_a_p_i___simulation.html#a54ce7b9e0490d7195c83e896d99aa6ed">TraCIServerAPI_Simulation::convertCartesianToRoadMap</a>(pos);
<a name="l01049"></a>01049         <span class="keywordflow">break</span>;
<a name="l01050"></a>01050         <span class="keywordflow">default</span>:
<a name="l01051"></a>01051             server.<a class="code" href="../../dc/d48/classtraci_1_1_tra_c_i_server.html#a5c45d0ac74428278b8620033422dfbd6">writeStatusCmd</a>(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a8327578e1d375be0cda35067c23d0542">CMD_GET_VEHICLE_VARIABLE</a>, <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a43465ba21de31f9ae2573e7ac5f24919">RTYPE_ERR</a>, <span class="stringliteral">&quot;Unknown position format used for distance request&quot;</span>);
<a name="l01052"></a>01052             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01053"></a>01053     }
<a name="l01054"></a>01054 
<a name="l01055"></a>01055     <span class="comment">// read distance type</span>
<a name="l01056"></a>01056     <span class="keywordtype">int</span> distType = inputStorage.readUnsignedByte();
<a name="l01057"></a>01057 
<a name="l01058"></a>01058     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> distance = <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>;
<a name="l01059"></a>01059     <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a9c57b7d54c70b1d5c7b2db6434c2c7e0" title="Returns the information whether the vehicle is on a road (is simulated).">isOnRoad</a>()) {
<a name="l01060"></a>01060         <span class="keywordflow">if</span> (distType == <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#a0876dbae8eb3fb92b20b2568d71eaf32">REQUEST_DRIVINGDIST</a>) {
<a name="l01061"></a>01061             distance = v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#ad54c9a2eeea444f4538ac5c405844d46" title="Returns the current route.">getRoute</a>().<a class="code" href="../../de/dd8/class_m_s_route.html#aefccac628f32cd320a56332c95abfd7f" title="Compute the distance between 2 given edges on this route, including the length of...">getDistanceBetween</a>(v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a9730b019bfc264e955b4af196619f72d" title="Get the vehicle&amp;#39;s position along the lane.">getPositionOnLane</a>(), roadPos.second,
<a name="l01062"></a>01062                        v-&gt;<a class="code" href="../../d9/dd6/class_m_s_base_vehicle.html#a5c164acad4d5151687a2b551ad57fb17" title="Returns the edge the vehicle is currently at.">getEdge</a>(), &amp;roadPos.first-&gt;getEdge());
<a name="l01063"></a>01063             <span class="keywordflow">if</span> (distance == <a class="code" href="../../d1/dc9/polyfonts_8c.html#affe776513b24d84b39af8ab0930fef7f">std::numeric_limits&lt;SUMOReal&gt;::max</a>()) {
<a name="l01064"></a>01064                 distance = <a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#abd665a03a6204505716245362eeca1b2">INVALID_DOUBLE_VALUE</a>;
<a name="l01065"></a>01065             }
<a name="l01066"></a>01066         } <span class="keywordflow">else</span> {
<a name="l01067"></a>01067             <span class="comment">// compute air distance (default)</span>
<a name="l01068"></a>01068             distance = v-&gt;<a class="code" href="../../d7/d90/class_m_s_vehicle.html#a0e464e17d48501f4515b5ede67306a73" title="Return current position (x/y, cartesian).">getPosition</a>().<a class="code" href="../../d7/d3b/class_position.html#aaa1d5d9e58bc203fceee0002563c3bc2" title="returns the euclidean distance in 3 dimension">distanceTo</a>(pos);
<a name="l01069"></a>01069         }
<a name="l01070"></a>01070     }
<a name="l01071"></a>01071     <span class="comment">// write response command</span>
<a name="l01072"></a>01072     outputStorage.writeUnsignedByte(<a class="code" href="../../dd/dba/_tra_c_i_constants_8h.html#ac87fa650bc0dcd101b39e15ecdb57477">TYPE_DOUBLE</a>);
<a name="l01073"></a>01073     outputStorage.writeDouble(distance);
<a name="l01074"></a>01074     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01075"></a>01075 }
<a name="l01076"></a>01076 
<a name="l01077"></a>01077 <span class="comment">// ------ helper functions ------</span>
<a name="l01078"></a>01078 <a class="code" href="../../de/da2/class_m_s_vehicle_type.html" title="The car-following model and parameter.">MSVehicleType</a>&amp;
<a name="l01079"></a><a class="code" href="../../d9/d85/class_tra_c_i_server_a_p_i___vehicle.html#a03021b6c8434ce6849371ea43c9eef2d">01079</a> <a class="code" href="../../d9/d85/class_tra_c_i_server_a_p_i___vehicle.html#a03021b6c8434ce6849371ea43c9eef2d">TraCIServerAPI_Vehicle::getSingularType</a>(<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html" title="Representation of a vehicle.">SUMOVehicle</a>* <span class="keyword">const</span> veh) {
<a name="l01080"></a>01080     <span class="keyword">const</span> <a class="code" href="../../de/da2/class_m_s_vehicle_type.html" title="The car-following model and parameter.">MSVehicleType</a>&amp; oType = veh-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#a663d5e56851bc802c8cb7067c03691f4" title="Returns the vehicle&amp;#39;s type.">getVehicleType</a>();
<a name="l01081"></a>01081     std::string newID = oType.<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#ad6dc1278af1ab98cbbc19d924739f766" title="Returns the name of the vehicle type.">getID</a>().find(<span class="charliteral">&#39;@&#39;</span>) == std::string::npos ? oType.<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#ad6dc1278af1ab98cbbc19d924739f766" title="Returns the name of the vehicle type.">getID</a>() + <span class="stringliteral">&quot;@&quot;</span> + veh-&gt;<a class="code" href="../../db/d61/class_s_u_m_o_vehicle.html#a42cdd9b7723e52037bbc5d76bacf266f" title="Get the vehicle&amp;#39;s ID.">getID</a>() : oType.<a class="code" href="../../de/da2/class_m_s_vehicle_type.html#ad6dc1278af1ab98cbbc19d924739f766" title="Returns the name of the vehicle type.">getID</a>();
<a name="l01082"></a>01082     <a class="code" href="../../de/da2/class_m_s_vehicle_type.html" title="The car-following model and parameter.">MSVehicleType</a>* type = <a class="code" href="../../de/da2/class_m_s_vehicle_type.html#a1aa0ce2fe75fa298372489a259bad7a5" title="Builds the microsim vehicle type described by the given parameter.">MSVehicleType::build</a>(newID, &amp;oType);
<a name="l01083"></a>01083     <span class="keyword">static_cast&lt;</span><a class="code" href="../../d7/d90/class_m_s_vehicle.html" title="Representation of a vehicle in the micro simulation.">MSVehicle</a>*<span class="keyword">&gt;</span>(veh)-&gt;replaceVehicleType(type);
<a name="l01084"></a>01084     <span class="keywordflow">return</span> *type;
<a name="l01085"></a>01085 }
<a name="l01086"></a>01086 
<a name="l01087"></a>01087 
<a name="l01088"></a>01088 <span class="comment">/****************************************************************************/</span>
<a name="l01089"></a>01089 
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Jul 17 12:16:13 2012 for SUMO - Simulation of Urban MObility by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
