<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SUMO - Simulation of Urban MObility: NIImporter_OpenDrive.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="../../dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_46b8f36974b309f038ffc35aa047a32b.html">boni</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_52e5be8ca53cec2b5437a8ba83e8e4f0.html">Desktop</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_7de3ce0f65e0314f747915173f89e60e.html">DanielTouched</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_a0096e276045b3ff0719c75e0b3c59bf.html">sumo-0.14.0</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_e9b8d709919855cd07b0394009af2578.html">src</a>&nbsp;&raquo;&nbsp;<a class="el" href="../../dir_941ad1c9f6979a737b8a94dcef837464.html">netimport</a>
  </div>
</div>
<div class="contents">
<h1>NIImporter_OpenDrive.cpp</h1><a href="../../dc/d0a/_n_i_importer___open_drive_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************/</span>
<a name="l00010"></a>00010 <span class="comment">// Importer for networks stored in openDrive format</span>
<a name="l00011"></a>00011 <span class="comment">/****************************************************************************/</span>
<a name="l00012"></a>00012 <span class="comment">// SUMO, Simulation of Urban MObility; see http://sumo.sourceforge.net/</span>
<a name="l00013"></a>00013 <span class="comment">// Copyright (C) 2001-2012 DLR (http://www.dlr.de/) and contributors</span>
<a name="l00014"></a>00014 <span class="comment">/****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">//   This file is part of SUMO.</span>
<a name="l00017"></a>00017 <span class="comment">//   SUMO is free software: you can redistribute it and/or modify</span>
<a name="l00018"></a>00018 <span class="comment">//   it under the terms of the GNU General Public License as published by</span>
<a name="l00019"></a>00019 <span class="comment">//   the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00020"></a>00020 <span class="comment">//   (at your option) any later version.</span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 <span class="comment">/****************************************************************************/</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="comment">// ===========================================================================</span>
<a name="l00026"></a>00026 <span class="comment">// included modules</span>
<a name="l00027"></a>00027 <span class="comment">// ===========================================================================</span>
<a name="l00028"></a>00028 <span class="preprocessor">#ifdef _MSC_VER</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d3/d99/windows__config_8h.html">windows_config.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#else</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../db/d16/config_8h.html">config.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#endif</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span><span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="../../d2/d70/_s_u_m_o_s_a_x_handler_8h.html">utils/xml/SUMOSAXHandler.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="../../d7/db4/_util_exceptions_8h.html">utils/common/UtilExceptions.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="../../de/d4a/_tpl_convert_8h.html">utils/common/TplConvert.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="../../d8/d08/_to_string_8h.html">utils/common/ToString.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="../../d4/df7/_msg_handler_8h.html">utils/common/MsgHandler.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="../../d8/d0b/_n_b_edge_8h.html">netbuild/NBEdge.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="../../d7/db4/_n_b_edge_cont_8h.html">netbuild/NBEdgeCont.h</a>&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;<a class="code" href="../../d4/da0/_n_b_node_8h.html">netbuild/NBNode.h</a>&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="../../da/d09/_n_b_node_cont_8h.html">netbuild/NBNodeCont.h</a>&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;<a class="code" href="../../dd/df1/_n_b_net_builder_8h.html">netbuild/NBNetBuilder.h</a>&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;<a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html">utils/xml/SUMOXMLDefinitions.h</a>&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/d6d/_geo_conv_helper_8h.html">utils/geom/GeoConvHelper.h</a>&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;<a class="code" href="../../db/dec/_geom_conv_helper_8h.html">utils/geom/GeomConvHelper.h</a>&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;<a class="code" href="../../d2/df8/euler_8h.html">foreign/eulerspiral/euler.h</a>&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/d5c/_options_cont_8h.html">utils/options/OptionsCont.h</a>&gt;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;<a class="code" href="../../d0/da2/_file_helpers_8h.html">utils/common/FileHelpers.h</a>&gt;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;<a class="code" href="../../d5/de9/_x_m_l_sub_sys_8h.html">utils/xml/XMLSubSys.h</a>&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;<a class="code" href="../../d9/df9/_boundary_8h.html">utils/geom/Boundary.h</a>&gt;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/d16/_n_i_loader_8h.html">NILoader.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d80/_n_i_importer___open_drive_8h.html">NIImporter_OpenDrive.h</a>&quot;</span>
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="preprocessor">#ifdef CHECK_MEMORY_LEAKS</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d7/d8d/debug__new_8h.html">foreign/nvwa/debug_new.h</a>&gt;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#endif // CHECK_MEMORY_LEAKS</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="comment">// ===========================================================================</span>
<a name="l00062"></a>00062 <span class="comment">// definitions</span>
<a name="l00063"></a>00063 <span class="comment">// ===========================================================================</span>
<a name="l00064"></a><a class="code" href="../../dc/d0a/_n_i_importer___open_drive_8cpp.html#a0d306bfae8005487a9e4ebeedc65e287">00064</a> <span class="preprocessor">#define C_LENGTH 10.</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="comment">// ===========================================================================</span>
<a name="l00068"></a>00068 <span class="comment">// static variables</span>
<a name="l00069"></a>00069 <span class="comment">// ===========================================================================</span>
<a name="l00070"></a>00070 <a class="code" href="../../d5/d41/class_string_bijection.html">StringBijection&lt;int&gt;::Entry</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ac9efbea12c715c0f6bfc9235551f8dd0" title="The names of openDrive-XML elements (for passing to GenericSAXHandler).">NIImporter_OpenDrive::openDriveTags</a>[] = {
<a name="l00071"></a>00071     { <span class="stringliteral">&quot;header&quot;</span>,           <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a0f50bbb0aebfd56f36ecd711662f6fc5">NIImporter_OpenDrive::OPENDRIVE_TAG_HEADER</a> },
<a name="l00072"></a>00072     { <span class="stringliteral">&quot;road&quot;</span>,             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a3dd9c68b96a9de981266b4ea0b615657">NIImporter_OpenDrive::OPENDRIVE_TAG_ROAD</a> },
<a name="l00073"></a>00073     { <span class="stringliteral">&quot;predecessor&quot;</span>,      <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14ae2524919b79c3f0970d33c275b9a618f">NIImporter_OpenDrive::OPENDRIVE_TAG_PREDECESSOR</a> },
<a name="l00074"></a>00074     { <span class="stringliteral">&quot;successor&quot;</span>,        <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14add56981f7e1ef0e77ba4884ae61a595a">NIImporter_OpenDrive::OPENDRIVE_TAG_SUCCESSOR</a> },
<a name="l00075"></a>00075     { <span class="stringliteral">&quot;geometry&quot;</span>,         <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a8f4f6e0bd0e1b12372b5c30a5b13b327">NIImporter_OpenDrive::OPENDRIVE_TAG_GEOMETRY</a> },
<a name="l00076"></a>00076     { <span class="stringliteral">&quot;line&quot;</span>,             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14ac864d49f51d0980da4683f3c76e10994">NIImporter_OpenDrive::OPENDRIVE_TAG_LINE</a> },
<a name="l00077"></a>00077     { <span class="stringliteral">&quot;spiral&quot;</span>,           <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a245f5746eb7b8e3b4f4c297dbf104f52">NIImporter_OpenDrive::OPENDRIVE_TAG_SPIRAL</a> },
<a name="l00078"></a>00078     { <span class="stringliteral">&quot;arc&quot;</span>,              <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14ac7b34de297393dd8cea85329958831e5">NIImporter_OpenDrive::OPENDRIVE_TAG_ARC</a> },
<a name="l00079"></a>00079     { <span class="stringliteral">&quot;poly3&quot;</span>,            <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a47d8f8ea8e7cdcd8b74cb3fef114e1fa">NIImporter_OpenDrive::OPENDRIVE_TAG_POLY3</a> },
<a name="l00080"></a>00080     { <span class="stringliteral">&quot;laneSection&quot;</span>,      <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14ae3b0b1205ae7890f2736b13563cb9867">NIImporter_OpenDrive::OPENDRIVE_TAG_LANESECTION</a> },
<a name="l00081"></a>00081     { <span class="stringliteral">&quot;left&quot;</span>,             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">NIImporter_OpenDrive::OPENDRIVE_TAG_LEFT</a> },
<a name="l00082"></a>00082     { <span class="stringliteral">&quot;center&quot;</span>,           <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a1011a10789624a1655ada99bfa1bab57">NIImporter_OpenDrive::OPENDRIVE_TAG_CENTER</a> },
<a name="l00083"></a>00083     { <span class="stringliteral">&quot;right&quot;</span>,            <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">NIImporter_OpenDrive::OPENDRIVE_TAG_RIGHT</a> },
<a name="l00084"></a>00084     { <span class="stringliteral">&quot;lane&quot;</span>,             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a042509043dc8fa3c76fbcde78b8288d8">NIImporter_OpenDrive::OPENDRIVE_TAG_LANE</a> },
<a name="l00085"></a>00085 
<a name="l00086"></a>00086     { <span class="stringliteral">&quot;&quot;</span>,                 <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a762b253d5b7f613d8d9f5235389a7d13">NIImporter_OpenDrive::OPENDRIVE_TAG_NOTHING</a> }
<a name="l00087"></a>00087 };
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <a class="code" href="../../d5/d41/class_string_bijection.html">StringBijection&lt;int&gt;::Entry</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3b03a0a11c03f88bc3a94d95e143dced" title="The names of openDrive-XML attributes (for passing to GenericSAXHandler).">NIImporter_OpenDrive::openDriveAttrs</a>[] = {
<a name="l00091"></a>00091     { <span class="stringliteral">&quot;revMajor&quot;</span>,       <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa1f1b81957a5befc71829fd88aa56eec1">NIImporter_OpenDrive::OPENDRIVE_ATTR_REVMAJOR</a> },
<a name="l00092"></a>00092     { <span class="stringliteral">&quot;revMinor&quot;</span>,       <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa55715db23d89b38b84c6719eb221f11a">NIImporter_OpenDrive::OPENDRIVE_ATTR_REVMINOR</a> },
<a name="l00093"></a>00093     { <span class="stringliteral">&quot;id&quot;</span>,             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa34e8f53105030aa1964108ee8874c537">NIImporter_OpenDrive::OPENDRIVE_ATTR_ID</a> },
<a name="l00094"></a>00094     { <span class="stringliteral">&quot;length&quot;</span>,         <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa8fca927b8dda4f7a3ebafc4b1195ad41">NIImporter_OpenDrive::OPENDRIVE_ATTR_LENGTH</a> },
<a name="l00095"></a>00095     { <span class="stringliteral">&quot;junction&quot;</span>,       <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa796d1b8ded775ebb9a01929a0d3ce4d7">NIImporter_OpenDrive::OPENDRIVE_ATTR_JUNCTION</a> },
<a name="l00096"></a>00096     { <span class="stringliteral">&quot;elementType&quot;</span>,    <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa699ee0bf7260cd178eca060cc0d170b5">NIImporter_OpenDrive::OPENDRIVE_ATTR_ELEMENTTYPE</a> },
<a name="l00097"></a>00097     { <span class="stringliteral">&quot;elementId&quot;</span>,      <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03faccb0e3a63f132ae37b0cda14e18b8803">NIImporter_OpenDrive::OPENDRIVE_ATTR_ELEMENTID</a> },
<a name="l00098"></a>00098     { <span class="stringliteral">&quot;contactPoint&quot;</span>,   <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa3b82de75fa66fdaab6f475d5df467cdd">NIImporter_OpenDrive::OPENDRIVE_ATTR_CONTACTPOINT</a> },
<a name="l00099"></a>00099     { <span class="stringliteral">&quot;s&quot;</span>,              <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa8e6a5154c0fccfb61d8b5337b0e74239">NIImporter_OpenDrive::OPENDRIVE_ATTR_S</a> },
<a name="l00100"></a>00100     { <span class="stringliteral">&quot;x&quot;</span>,              <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa345eb6c9a72e5645c9cede23ec518ee3">NIImporter_OpenDrive::OPENDRIVE_ATTR_X</a> },
<a name="l00101"></a>00101     { <span class="stringliteral">&quot;y&quot;</span>,              <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa26439c77995dc13c76a20f3840d08d68">NIImporter_OpenDrive::OPENDRIVE_ATTR_Y</a> },
<a name="l00102"></a>00102     { <span class="stringliteral">&quot;hdg&quot;</span>,            <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa56b3fe0fb418303b2e7c63d1bd4c36a1">NIImporter_OpenDrive::OPENDRIVE_ATTR_HDG</a> },
<a name="l00103"></a>00103     { <span class="stringliteral">&quot;curvStart&quot;</span>,      <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa25d8ab872e54b8acdcf49971da0feef5">NIImporter_OpenDrive::OPENDRIVE_ATTR_CURVSTART</a> },
<a name="l00104"></a>00104     { <span class="stringliteral">&quot;curvEnd&quot;</span>,        <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03faa106f1e5a6bf5013a82311669e39d9d9">NIImporter_OpenDrive::OPENDRIVE_ATTR_CURVEND</a> },
<a name="l00105"></a>00105     { <span class="stringliteral">&quot;curvature&quot;</span>,      <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa61b82baf2dc060febb47802558f2459b">NIImporter_OpenDrive::OPENDRIVE_ATTR_CURVATURE</a> },
<a name="l00106"></a>00106     { <span class="stringliteral">&quot;a&quot;</span>,              <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fab3aec237cbb25fe73f9732fb73465663">NIImporter_OpenDrive::OPENDRIVE_ATTR_A</a> },
<a name="l00107"></a>00107     { <span class="stringliteral">&quot;b&quot;</span>,              <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa7da911dcefd85125a556b36cc4e7d6d1">NIImporter_OpenDrive::OPENDRIVE_ATTR_B</a> },
<a name="l00108"></a>00108     { <span class="stringliteral">&quot;c&quot;</span>,              <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa3b0df2eb6319a88fb79adfd7bb6f66b5">NIImporter_OpenDrive::OPENDRIVE_ATTR_C</a> },
<a name="l00109"></a>00109     { <span class="stringliteral">&quot;d&quot;</span>,              <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03faab4e01166834c4865e2c6ebfe1b4b752">NIImporter_OpenDrive::OPENDRIVE_ATTR_D</a> },
<a name="l00110"></a>00110     { <span class="stringliteral">&quot;type&quot;</span>,           <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fafc3d6edf502b42ce9377971148c5bf3f">NIImporter_OpenDrive::OPENDRIVE_ATTR_TYPE</a> },
<a name="l00111"></a>00111     { <span class="stringliteral">&quot;level&quot;</span>,          <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa8ddbc1fca36306301c92d3df6cdb96fd">NIImporter_OpenDrive::OPENDRIVE_ATTR_LEVEL</a> },
<a name="l00112"></a>00112 
<a name="l00113"></a>00113     { <span class="stringliteral">&quot;&quot;</span>,               <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fac4731270eb5162dbf884f085ab42fb1f">NIImporter_OpenDrive::OPENDRIVE_ATTR_NOTHING</a> }
<a name="l00114"></a>00114 };
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 
<a name="l00117"></a>00117 <span class="comment">// ===========================================================================</span>
<a name="l00118"></a>00118 <span class="comment">// method definitions</span>
<a name="l00119"></a>00119 <span class="comment">// ===========================================================================</span>
<a name="l00120"></a>00120 <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00121"></a>00121 <span class="comment">// static methods (interface in this case)</span>
<a name="l00122"></a>00122 <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00123"></a>00123 <span class="keywordtype">void</span>
<a name="l00124"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a02a6b8012d2559a99a9d81bc47a903f9">00124</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a02a6b8012d2559a99a9d81bc47a903f9" title="Loads content of the optionally given SUMO file.">NIImporter_OpenDrive::loadNetwork</a>(<span class="keyword">const</span> <a class="code" href="../../db/d31/class_options_cont.html" title="A storage for options typed value containers).">OptionsCont</a>&amp; oc, <a class="code" href="../../d3/df6/class_n_b_net_builder.html" title="Instance responsible for building networks.">NBNetBuilder</a>&amp; nb) {
<a name="l00125"></a>00125     <span class="comment">// check whether the option is set (properly)</span>
<a name="l00126"></a>00126     <span class="keywordflow">if</span> (!oc.<a class="code" href="../../db/d31/class_options_cont.html#a0017782b90eb8137482855fbc1fd3695" title="Checks whether the named option is usable as a file list (with at least a single...">isUsableFileList</a>(<span class="stringliteral">&quot;opendrive-files&quot;</span>)) {
<a name="l00127"></a>00127         <span class="keywordflow">return</span>;
<a name="l00128"></a>00128     }
<a name="l00129"></a>00129     <span class="comment">// build the handler</span>
<a name="l00130"></a>00130     std::vector&lt;OpenDriveEdge&gt; innerEdges, outerEdges;
<a name="l00131"></a>00131     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html" title="Importer for networks stored in openDrive format.">NIImporter_OpenDrive</a> handler(innerEdges, outerEdges);
<a name="l00132"></a>00132     <span class="comment">// parse file(s)</span>
<a name="l00133"></a>00133     std::vector&lt;std::string&gt; files = oc.<a class="code" href="../../db/d31/class_options_cont.html#a6713cebc23d2e3a88f8a00942e4fee32" title="Returns the list of string-vector-value of the named option (only for Option_String)...">getStringVector</a>(<span class="stringliteral">&quot;opendrive-files&quot;</span>);
<a name="l00134"></a>00134     <span class="keywordflow">for</span> (std::vector&lt;std::string&gt;::const_iterator file = files.begin(); file != files.end(); ++file) {
<a name="l00135"></a>00135         <span class="keywordflow">if</span> (!<a class="code" href="../../de/d41/class_file_helpers.html#a7f457b757712c42c00f1917f98579e98" title="Checks whether the given file exists.">FileHelpers::exists</a>(*file)) {
<a name="l00136"></a>00136             <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Could not open opendrive file &#39;&quot;</span> + *file + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00137"></a>00137             <span class="keywordflow">return</span>;
<a name="l00138"></a>00138         }
<a name="l00139"></a>00139         handler.<a class="code" href="../../da/da8/class_generic_s_a_x_handler.html#aa16678c95ae836a53ade17ec5923effd" title="Sets the current file name.">setFileName</a>(*file);
<a name="l00140"></a>00140         <a class="code" href="../../d4/df7/_msg_handler_8h.html#afa3f7d0673e0a81062288662416bca15">PROGRESS_BEGIN_MESSAGE</a>(<span class="stringliteral">&quot;Parsing opendrive from &#39;&quot;</span> + *file + <span class="stringliteral">&quot;&#39;&quot;</span>);
<a name="l00141"></a>00141         <a class="code" href="../../d7/db5/class_x_m_l_sub_sys.html#a76efc123ca1ac726bfa84fff454d47ec" title="Runs the given handler on the given file; returns if everything&amp;#39;s ok.">XMLSubSys::runParser</a>(handler, *file);
<a name="l00142"></a>00142         <a class="code" href="../../d4/df7/_msg_handler_8h.html#ab1885dedc6abc417e920e02f58531924">PROGRESS_DONE_MESSAGE</a>();
<a name="l00143"></a>00143     }
<a name="l00144"></a>00144     <span class="comment">// convert geometries into a discretised representation</span>
<a name="l00145"></a>00145     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a97872c6a192689d27676dc288d14c908">computeShapes</a>(innerEdges);
<a name="l00146"></a>00146     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a97872c6a192689d27676dc288d14c908">computeShapes</a>(outerEdges);
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     <span class="comment">// -------------------------</span>
<a name="l00149"></a>00149     <span class="comment">// node building</span>
<a name="l00150"></a>00150     <span class="comment">// -------------------------</span>
<a name="l00151"></a>00151     <span class="comment">// build nodes#1</span>
<a name="l00152"></a>00152     <span class="comment">//  look at all links which belong to a node, collect their bounding boxes</span>
<a name="l00153"></a>00153     <span class="comment">//  and place the node in the middle of this bounding box</span>
<a name="l00154"></a>00154     std::map&lt;std::string, Boundary&gt; posMap;
<a name="l00155"></a>00155     std::map&lt;std::string, std::string&gt; edge2junction;
<a name="l00156"></a>00156     <span class="comment">//   compute node positions</span>
<a name="l00157"></a>00157     <span class="keywordflow">for</span> (std::vector&lt;OpenDriveEdge&gt;::iterator i = innerEdges.begin(); i != innerEdges.end(); ++i) {
<a name="l00158"></a>00158         <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e = *i;
<a name="l00159"></a>00159         assert(e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a518ac8c3e12309a93d85d4f3d1c51a2b" title="The id of the junction the edge belongs to.">junction</a> != <span class="stringliteral">&quot;-1&quot;</span> &amp;&amp; e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a518ac8c3e12309a93d85d4f3d1c51a2b" title="The id of the junction the edge belongs to.">junction</a> != <span class="stringliteral">&quot;&quot;</span>);
<a name="l00160"></a>00160         edge2junction[e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>] = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a518ac8c3e12309a93d85d4f3d1c51a2b" title="The id of the junction the edge belongs to.">junction</a>;
<a name="l00161"></a>00161         <span class="keywordflow">if</span> (posMap.find(e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a518ac8c3e12309a93d85d4f3d1c51a2b" title="The id of the junction the edge belongs to.">junction</a>) == posMap.end()) {
<a name="l00162"></a>00162             posMap[e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a518ac8c3e12309a93d85d4f3d1c51a2b" title="The id of the junction the edge belongs to.">junction</a>] = <a class="code" href="../../d5/dda/class_boundary.html" title="A class that stores a 2D geometrical boundary.">Boundary</a>();
<a name="l00163"></a>00163         }
<a name="l00164"></a>00164         posMap[e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a518ac8c3e12309a93d85d4f3d1c51a2b" title="The id of the junction the edge belongs to.">junction</a>].add(e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae45a625f55e68964364308c6cc46cc13">geom</a>.<a class="code" href="../../da/d56/class_position_vector.html#a9914da937acd7c7d15e536159f9736e2" title="Returns a boundary enclosing this list of lines.">getBoxBoundary</a>());
<a name="l00165"></a>00165     }
<a name="l00166"></a>00166     <span class="comment">//   build nodes</span>
<a name="l00167"></a>00167     <span class="keywordflow">for</span> (std::map&lt;std::string, Boundary&gt;::iterator i = posMap.begin(); i != posMap.end(); ++i) {
<a name="l00168"></a>00168         <span class="keywordflow">if</span> (!nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>().<a class="code" href="../../db/d8c/class_n_b_node_cont.html#ab70c3a2678e411a0b1e3edd41d2dd177" title="Inserts a node into the map.">insert</a>((*i).first, (*i).second.getCenter())) {
<a name="l00169"></a>00169             <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Could not add node &#39;&quot;</span> + (*i).first + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00170"></a>00170         }
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172     <span class="comment">//  assign built nodes</span>
<a name="l00173"></a>00173     <span class="keywordflow">for</span> (std::vector&lt;OpenDriveEdge&gt;::iterator i = outerEdges.begin(); i != outerEdges.end(); ++i) {
<a name="l00174"></a>00174         <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e = *i;
<a name="l00175"></a>00175         <span class="keywordflow">for</span> (std::vector&lt;OpenDriveLink&gt;::iterator j = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a896f5170482231e86985a2d25753c989">links</a>.begin(); j != e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a896f5170482231e86985a2d25753c989">links</a>.end(); ++j) {
<a name="l00176"></a>00176             <a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html" title="Representation of an openDrive connection.">OpenDriveLink</a>&amp; l = *j;
<a name="l00177"></a>00177             <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a505427ece8a203068870e2f6324da822">elementType</a> != <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a35ac7077f55a8b19c6a7ab928d737835a30c65f222d2f4a2b676084cf0389660d">OPENDRIVE_ET_ROAD</a>) {
<a name="l00178"></a>00178                 <span class="comment">// set node information</span>
<a name="l00179"></a>00179                 <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6f164c6ea11d35c8f100682973bdfd0b">setNodeSecure</a>(nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>(), e, l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a>, l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a5f7b60f49af322c48ffcc3f7a2dbed8d">linkType</a>);
<a name="l00180"></a>00180                 <span class="keywordflow">continue</span>;
<a name="l00181"></a>00181             }
<a name="l00182"></a>00182             <span class="keywordflow">if</span> (edge2junction.find(l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a>) != edge2junction.end()) {
<a name="l00183"></a>00183                 <span class="comment">// set node information of an internal road</span>
<a name="l00184"></a>00184                 <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6f164c6ea11d35c8f100682973bdfd0b">setNodeSecure</a>(nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>(), e, edge2junction[l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a>], l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a5f7b60f49af322c48ffcc3f7a2dbed8d">linkType</a>);
<a name="l00185"></a>00185                 <span class="keywordflow">continue</span>;
<a name="l00186"></a>00186             }
<a name="l00187"></a>00187         }
<a name="l00188"></a>00188     }
<a name="l00189"></a>00189     <span class="comment">//  we should now have all nodes set for links which are not outer edge-to-outer edge links</span>
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 
<a name="l00192"></a>00192     <span class="comment">// build nodes#2</span>
<a name="l00193"></a>00193     <span class="comment">//  build nodes for all outer edge-to-outer edge connections</span>
<a name="l00194"></a>00194     <span class="keywordflow">for</span> (std::vector&lt;OpenDriveEdge&gt;::iterator i = outerEdges.begin(); i != outerEdges.end(); ++i) {
<a name="l00195"></a>00195         <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e = *i;
<a name="l00196"></a>00196         <span class="keywordflow">for</span> (std::vector&lt;OpenDriveLink&gt;::iterator j = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a896f5170482231e86985a2d25753c989">links</a>.begin(); j != e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a896f5170482231e86985a2d25753c989">links</a>.end(); ++j) {
<a name="l00197"></a>00197             <a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html" title="Representation of an openDrive connection.">OpenDriveLink</a>&amp; l = *j;
<a name="l00198"></a>00198             <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a505427ece8a203068870e2f6324da822">elementType</a> != <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a35ac7077f55a8b19c6a7ab928d737835a30c65f222d2f4a2b676084cf0389660d">OPENDRIVE_ET_ROAD</a> || edge2junction.find(l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a>) != edge2junction.end()) {
<a name="l00199"></a>00199                 <span class="comment">// is a connection to an internal edge, or a node, skip</span>
<a name="l00200"></a>00200                 <span class="keywordflow">continue</span>;
<a name="l00201"></a>00201             }
<a name="l00202"></a>00202             <span class="comment">// we have a direct connection between to external edges</span>
<a name="l00203"></a>00203             std::string id1 = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>;
<a name="l00204"></a>00204             std::string id2 = l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a>;
<a name="l00205"></a>00205             <span class="keywordflow">if</span> (id1 &lt; id2) {
<a name="l00206"></a>00206                 std::swap(id1, id2);
<a name="l00207"></a>00207             }
<a name="l00208"></a>00208             std::string nid = id1 + <span class="stringliteral">&quot;.&quot;</span> + id2;
<a name="l00209"></a>00209             <span class="keywordflow">if</span> (nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>().<a class="code" href="../../db/d8c/class_n_b_node_cont.html#a0e2ce1b9413a0c11728ac63344c62039" title="Returns the node with the given name.">retrieve</a>(nid) == 0) {
<a name="l00210"></a>00210                 <span class="comment">// not yet seen, build</span>
<a name="l00211"></a>00211                 <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a> pos = l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a5f7b60f49af322c48ffcc3f7a2dbed8d">linkType</a> == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07a1193f5a48dbe095884b4c429122564ed">OPENDRIVE_LT_SUCCESSOR</a> ? e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae45a625f55e68964364308c6cc46cc13">geom</a>[(int)e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae45a625f55e68964364308c6cc46cc13">geom</a>.<a class="code" href="../../da/d56/class_position_vector.html#a4f728d62950004e143aa921c5f64de2f" title="returns the number of points making up the line vector">size</a>() - 1] : e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae45a625f55e68964364308c6cc46cc13">geom</a>[0];
<a name="l00212"></a>00212                 <span class="keywordflow">if</span> (!nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>().<a class="code" href="../../db/d8c/class_n_b_node_cont.html#ab70c3a2678e411a0b1e3edd41d2dd177" title="Inserts a node into the map.">insert</a>(nid, pos)) {
<a name="l00213"></a>00213                     <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Could not build node &#39;&quot;</span> + nid + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00214"></a>00214                 }
<a name="l00215"></a>00215             }
<a name="l00216"></a>00216             <span class="comment">/* debug-stuff</span>
<a name="l00217"></a>00217 <span class="comment">            else {</span>
<a name="l00218"></a>00218 <span class="comment">                Position pos = l.linkType==OPENDRIVE_LT_SUCCESSOR ? e.geom[e.geom.size()-1] : e.geom[0];</span>
<a name="l00219"></a>00219 <span class="comment">                cout &lt;&lt; nid &lt;&lt; &quot; &quot; &lt;&lt; pos &lt;&lt; &quot; &quot; &lt;&lt; nb.getNodeCont().retrieve(nid)-&gt;getPosition() &lt;&lt; endl;</span>
<a name="l00220"></a>00220 <span class="comment">            }</span>
<a name="l00221"></a>00221 <span class="comment">            */</span>
<a name="l00222"></a>00222             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6f164c6ea11d35c8f100682973bdfd0b">setNodeSecure</a>(nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>(), e, nid, l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a5f7b60f49af322c48ffcc3f7a2dbed8d">linkType</a>);
<a name="l00223"></a>00223         }
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225     <span class="comment">// we should now have start/end nodes for all outer edge-to-outer edge connections</span>
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 
<a name="l00228"></a>00228     <span class="comment">// build nodes#3</span>
<a name="l00229"></a>00229     <span class="comment">//  assign further nodes generated from inner-edges</span>
<a name="l00230"></a>00230     <span class="comment">//  these nodes have not been assigned earlier, because the connectiosn are referenced in inner-edges</span>
<a name="l00231"></a>00231     <span class="keywordflow">for</span> (std::vector&lt;OpenDriveEdge&gt;::iterator i = outerEdges.begin(); i != outerEdges.end(); ++i) {
<a name="l00232"></a>00232         <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e = *i;
<a name="l00233"></a>00233         <span class="keywordflow">if</span> (e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a91119a70d8f3361f20960b0db3ade200">to</a> != 0 &amp;&amp; e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#aba5685ab6e4d7c7da2a9123d942d3d97">from</a> != 0) {
<a name="l00234"></a>00234             <span class="keywordflow">continue</span>;
<a name="l00235"></a>00235         }
<a name="l00236"></a>00236         <span class="keywordflow">for</span> (std::vector&lt;OpenDriveEdge&gt;::iterator j = innerEdges.begin(); j != innerEdges.end(); ++j) {
<a name="l00237"></a>00237             <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; ie = *j;
<a name="l00238"></a>00238             <span class="keywordflow">for</span> (std::vector&lt;OpenDriveLink&gt;::iterator k = ie.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a896f5170482231e86985a2d25753c989">links</a>.begin(); k != ie.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a896f5170482231e86985a2d25753c989">links</a>.end(); ++k) {
<a name="l00239"></a>00239                 <a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html" title="Representation of an openDrive connection.">OpenDriveLink</a>&amp; il = *k;
<a name="l00240"></a>00240                 <span class="keywordflow">if</span> (il.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a505427ece8a203068870e2f6324da822">elementType</a> != <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a35ac7077f55a8b19c6a7ab928d737835a30c65f222d2f4a2b676084cf0389660d">OPENDRIVE_ET_ROAD</a> || il.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a> != e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>) {
<a name="l00241"></a>00241                     <span class="comment">// not conneted to the currently investigated outer edge</span>
<a name="l00242"></a>00242                     <span class="keywordflow">continue</span>;
<a name="l00243"></a>00243                 }
<a name="l00244"></a>00244                 std::string nid = edge2junction[ie.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>];
<a name="l00245"></a>00245                 <span class="keywordflow">if</span> (il.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a8f28e39325e14094708f1b0f1773a67e">contactPoint</a> == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ad0c9b5bb37efe9f5cc4dd70a5cb6107eab77e17c32fec54df2d360fa279ba4497">OPENDRIVE_CP_START</a>) {
<a name="l00246"></a>00246                     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6f164c6ea11d35c8f100682973bdfd0b">setNodeSecure</a>(nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>(), e, nid, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07ae7688ceef1eb3024d2753cee8ae7ab21">OPENDRIVE_LT_PREDECESSOR</a>);
<a name="l00247"></a>00247                 } <span class="keywordflow">else</span> {
<a name="l00248"></a>00248                     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6f164c6ea11d35c8f100682973bdfd0b">setNodeSecure</a>(nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>(), e, nid, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07a1193f5a48dbe095884b4c429122564ed">OPENDRIVE_LT_SUCCESSOR</a>);
<a name="l00249"></a>00249                 }
<a name="l00250"></a>00250             }
<a name="l00251"></a>00251         }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253     }
<a name="l00254"></a>00254     <span class="comment">//</span>
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     <span class="comment">// build start/end nodes which were not defined previously</span>
<a name="l00258"></a>00258     <span class="keywordflow">for</span> (std::vector&lt;OpenDriveEdge&gt;::iterator i = outerEdges.begin(); i != outerEdges.end(); ++i) {
<a name="l00259"></a>00259         <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e = *i;
<a name="l00260"></a>00260         <span class="keywordflow">if</span> (e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#aba5685ab6e4d7c7da2a9123d942d3d97">from</a> == 0) {
<a name="l00261"></a>00261             std::string nid = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a> + <span class="stringliteral">&quot;.begin&quot;</span>;
<a name="l00262"></a>00262             <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a> pos(e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae4c771fff9ddb0ad3d530a855907d0d6">geometries</a>[0].x, e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae4c771fff9ddb0ad3d530a855907d0d6">geometries</a>[0].y);
<a name="l00263"></a>00263             e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#aba5685ab6e4d7c7da2a9123d942d3d97">from</a> = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a5b5767379dfb702af5f2c15f396186fa" title="Builds a node or returns the already built.">getOrBuildNode</a>(nid, e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae45a625f55e68964364308c6cc46cc13">geom</a>[0], nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>());
<a name="l00264"></a>00264         }
<a name="l00265"></a>00265         <span class="keywordflow">if</span> (e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a91119a70d8f3361f20960b0db3ade200">to</a> == 0) {
<a name="l00266"></a>00266             std::string nid = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a> + <span class="stringliteral">&quot;.end&quot;</span>;
<a name="l00267"></a>00267             <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a> pos(e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae4c771fff9ddb0ad3d530a855907d0d6">geometries</a>[e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae4c771fff9ddb0ad3d530a855907d0d6">geometries</a>.size() - 1].x, e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae4c771fff9ddb0ad3d530a855907d0d6">geometries</a>[e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae4c771fff9ddb0ad3d530a855907d0d6">geometries</a>.size() - 1].y);
<a name="l00268"></a>00268             e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a91119a70d8f3361f20960b0db3ade200">to</a> = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a5b5767379dfb702af5f2c15f396186fa" title="Builds a node or returns the already built.">getOrBuildNode</a>(nid, e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae45a625f55e68964364308c6cc46cc13">geom</a>[(<span class="keywordtype">int</span>)e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae45a625f55e68964364308c6cc46cc13">geom</a>.<a class="code" href="../../da/d56/class_position_vector.html#a4f728d62950004e143aa921c5f64de2f" title="returns the number of points making up the line vector">size</a>() - 1], nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>());
<a name="l00269"></a>00269         }
<a name="l00270"></a>00270     }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272 
<a name="l00273"></a>00273     <span class="comment">// -------------------------</span>
<a name="l00274"></a>00274     <span class="comment">// edge building</span>
<a name="l00275"></a>00275     <span class="comment">// -------------------------</span>
<a name="l00276"></a>00276     std::map&lt;NBEdge*, std::map&lt;int, int&gt; &gt; fromLaneMap;
<a name="l00277"></a>00277     std::map&lt;NBEdge*, std::map&lt;int, int&gt; &gt; toLaneMap;
<a name="l00278"></a>00278     <span class="comment">// build edges</span>
<a name="l00279"></a>00279     <span class="keywordflow">for</span> (std::vector&lt;OpenDriveEdge&gt;::iterator i = outerEdges.begin(); i != outerEdges.end(); ++i) {
<a name="l00280"></a>00280         <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e = *i;
<a name="l00281"></a>00281         <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> speed = nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#a5c4fed8889dde5383bed0d68137cfede" title="Returns the type container.">getTypeCont</a>().<a class="code" href="../../db/d57/class_n_b_type_cont.html#ac5e013789fea67b88b8ba113980a7555" title="Returns the maximal velocity for the given type [m/s].">getSpeed</a>(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00282"></a>00282         <span class="keywordtype">int</span> priority = nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#a5c4fed8889dde5383bed0d68137cfede" title="Returns the type container.">getTypeCont</a>().<a class="code" href="../../db/d57/class_n_b_type_cont.html#a4827ea02d078ac4cea43cd52ff551cc8" title="Returns the priority for the given type.">getPriority</a>(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00283"></a>00283         <a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511" title="Numbers representing special SUMO-XML-attribute values Information how the edge&amp;#39;s...">LaneSpreadFunction</a> lsf = <a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511a55d244ddc2721841db383d43bb60c01d">LANESPREAD_CENTER</a>;
<a name="l00284"></a>00284         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> noLanesRight = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a3f337d7c62cab39903ff9891e28a3f8d">getMaxLaneNumber</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a>);
<a name="l00285"></a>00285         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> noLanesLeft = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a3f337d7c62cab39903ff9891e28a3f8d">getMaxLaneNumber</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>);
<a name="l00286"></a>00286         <span class="keywordflow">if</span> (noLanesRight != 0 || noLanesLeft != 0) {
<a name="l00287"></a>00287             lsf = <a class="code" href="../../d6/d7a/_s_u_m_o_x_m_l_definitions_8h.html#a9266afbd0b47dea3e4a46c3ea8e9b511ae7e3b88514c3c8ec96b3be33ff58944b">LANESPREAD_RIGHT</a>;
<a name="l00288"></a>00288         } <span class="keywordflow">else</span> {
<a name="l00289"></a>00289             <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(<span class="stringliteral">&quot;Edge &#39;&quot;</span> + e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a> + <span class="stringliteral">&quot;&#39; has no lanes.&quot;</span>);
<a name="l00290"></a>00290         }
<a name="l00291"></a>00291         <span class="keywordflow">if</span> (noLanesRight &gt; 0) {
<a name="l00292"></a>00292             <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* nbe = <span class="keyword">new</span> <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>(<span class="stringliteral">&quot;-&quot;</span> + e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>, e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#aba5685ab6e4d7c7da2a9123d942d3d97">from</a>, e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a91119a70d8f3361f20960b0db3ade200">to</a>, <span class="stringliteral">&quot;&quot;</span>, speed, noLanesRight, priority, -1, -1, e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae45a625f55e68964364308c6cc46cc13">geom</a>, <span class="stringliteral">&quot;&quot;</span>, lsf, <span class="keyword">true</span>);
<a name="l00293"></a>00293             <span class="keywordflow">if</span> (!nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#addde5ff7cfc01b1ca492fe9120646a73" title="Adds an edge to the dictionary.">insert</a>(nbe)) {
<a name="l00294"></a>00294                 <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Could not add edge &#39;&quot;</span> + std::string(<span class="stringliteral">&quot;-&quot;</span>) + e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a> + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00295"></a>00295             }
<a name="l00296"></a>00296             fromLaneMap[nbe] = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>.back().buildLaneMapping(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a>);
<a name="l00297"></a>00297             toLaneMap[nbe] = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>[0].buildLaneMapping(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a>);
<a name="l00298"></a>00298         }
<a name="l00299"></a>00299         <span class="keywordflow">if</span> (noLanesLeft &gt; 0) {
<a name="l00300"></a>00300             <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* nbe = <span class="keyword">new</span> <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>(e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>, e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a91119a70d8f3361f20960b0db3ade200">to</a>, e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#aba5685ab6e4d7c7da2a9123d942d3d97">from</a>, <span class="stringliteral">&quot;&quot;</span>, speed, noLanesLeft, priority, -1, -1, e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae45a625f55e68964364308c6cc46cc13">geom</a>.<a class="code" href="../../da/d56/class_position_vector.html#a0dec24e1521994cbf1d60195f87dc09d">reverse</a>(), <span class="stringliteral">&quot;&quot;</span>, lsf, <span class="keyword">true</span>);
<a name="l00301"></a>00301             <span class="keywordflow">if</span> (!nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#addde5ff7cfc01b1ca492fe9120646a73" title="Adds an edge to the dictionary.">insert</a>(nbe)) {
<a name="l00302"></a>00302                 <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Could not add edge &#39;&quot;</span> + e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a> + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00303"></a>00303             }
<a name="l00304"></a>00304             fromLaneMap[nbe] = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>[0].buildLaneMapping(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>);
<a name="l00305"></a>00305             toLaneMap[nbe] = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>.back().buildLaneMapping(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>);
<a name="l00306"></a>00306         }
<a name="l00307"></a>00307     }
<a name="l00308"></a>00308 
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <span class="comment">// -------------------------</span>
<a name="l00311"></a>00311     <span class="comment">// connections building</span>
<a name="l00312"></a>00312     <span class="comment">// -------------------------</span>
<a name="l00313"></a>00313     std::vector&lt;Connection&gt; connections;
<a name="l00314"></a>00314     <span class="comment">// connections#1</span>
<a name="l00315"></a>00315     <span class="comment">//  build connections between outer-edges</span>
<a name="l00316"></a>00316     <span class="keywordflow">for</span> (std::vector&lt;OpenDriveEdge&gt;::iterator i = outerEdges.begin(); i != outerEdges.end(); ++i) {
<a name="l00317"></a>00317         <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e = *i;
<a name="l00318"></a>00318         <span class="keywordflow">for</span> (std::vector&lt;OpenDriveLink&gt;::iterator j = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a896f5170482231e86985a2d25753c989">links</a>.begin(); j != e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a896f5170482231e86985a2d25753c989">links</a>.end(); ++j) {
<a name="l00319"></a>00319             <a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html" title="Representation of an openDrive connection.">OpenDriveLink</a>&amp; l = *j;
<a name="l00320"></a>00320             <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a505427ece8a203068870e2f6324da822">elementType</a> != <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a35ac7077f55a8b19c6a7ab928d737835a30c65f222d2f4a2b676084cf0389660d">OPENDRIVE_ET_ROAD</a>) {
<a name="l00321"></a>00321                 <span class="comment">// we are not interested in connections to nodes</span>
<a name="l00322"></a>00322                 <span class="keywordflow">continue</span>;
<a name="l00323"></a>00323             }
<a name="l00324"></a>00324             <span class="keywordflow">if</span> (edge2junction.find(l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a>) != edge2junction.end()) {
<a name="l00325"></a>00325                 <span class="comment">// connection via an inner-road</span>
<a name="l00326"></a>00326                 <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a9bd14470d9395669a5f152ffecd6ef65">addViaConnectionSecure</a>(nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>(),
<a name="l00327"></a>00327                                        nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>().<a class="code" href="../../db/d8c/class_n_b_node_cont.html#a0e2ce1b9413a0c11728ac63344c62039" title="Returns the node with the given name.">retrieve</a>(edge2junction[l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a>]),
<a name="l00328"></a>00328                                        e, l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a5f7b60f49af322c48ffcc3f7a2dbed8d">linkType</a>, l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a>, connections);
<a name="l00329"></a>00329             } <span class="keywordflow">else</span> {
<a name="l00330"></a>00330                 <span class="comment">// connection between two outer-edges; can be used directly</span>
<a name="l00331"></a>00331                 std::vector&lt;OpenDriveEdge&gt;::iterator p = std::find_if(outerEdges.begin(), outerEdges.end(), <a class="code" href="../../d7/d47/class_n_i_importer___open_drive_1_1edge__by__id__finder.html">edge_by_id_finder</a>(l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a>));
<a name="l00332"></a>00332                 <span class="keywordflow">if</span> (p == outerEdges.end()) {
<a name="l00333"></a>00333                     <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Could not find connection edge.&quot;</span>);
<a name="l00334"></a>00334                 }
<a name="l00335"></a>00335                 std::string id1 = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>;
<a name="l00336"></a>00336                 std::string id2 = (*p).id;
<a name="l00337"></a>00337                 <span class="keywordflow">if</span> (id1 &lt; id2) {
<a name="l00338"></a>00338                     std::swap(id1, id2);
<a name="l00339"></a>00339                 }
<a name="l00340"></a>00340                 std::string nid = id1 + <span class="stringliteral">&quot;.&quot;</span> + id2;
<a name="l00341"></a>00341                 <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a5f7b60f49af322c48ffcc3f7a2dbed8d">linkType</a> == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07ae7688ceef1eb3024d2753cee8ae7ab21">OPENDRIVE_LT_PREDECESSOR</a>) {
<a name="l00342"></a>00342                     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a68273eb280862dca21820ad9d0db21d6">addE2EConnectionsSecure</a>(nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>(), nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>().<a class="code" href="../../db/d8c/class_n_b_node_cont.html#a0e2ce1b9413a0c11728ac63344c62039" title="Returns the node with the given name.">retrieve</a>(nid), *p, e, connections);
<a name="l00343"></a>00343                 } <span class="keywordflow">else</span> {
<a name="l00344"></a>00344                     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a68273eb280862dca21820ad9d0db21d6">addE2EConnectionsSecure</a>(nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>(), nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>().<a class="code" href="../../db/d8c/class_n_b_node_cont.html#a0e2ce1b9413a0c11728ac63344c62039" title="Returns the node with the given name.">retrieve</a>(nid), e, *p, connections);
<a name="l00345"></a>00345                 }
<a name="l00346"></a>00346             }
<a name="l00347"></a>00347         }
<a name="l00348"></a>00348     }
<a name="l00349"></a>00349 
<a name="l00350"></a>00350     <span class="comment">// build inner-edge connections</span>
<a name="l00351"></a>00351     <span class="keywordflow">for</span> (std::vector&lt;OpenDriveEdge&gt;::iterator i = innerEdges.begin(); i != innerEdges.end(); ++i) {
<a name="l00352"></a>00352         <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e = *i;
<a name="l00353"></a>00353         std::string pred, succ;
<a name="l00354"></a>00354         <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ad0c9b5bb37efe9f5cc4dd70a5cb6107e">ContactPoint</a> predC, succC;
<a name="l00355"></a>00355         <span class="keywordflow">for</span> (std::vector&lt;OpenDriveLink&gt;::iterator j = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a896f5170482231e86985a2d25753c989">links</a>.begin(); j != e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a896f5170482231e86985a2d25753c989">links</a>.end(); ++j) {
<a name="l00356"></a>00356             <a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html" title="Representation of an openDrive connection.">OpenDriveLink</a>&amp; l = *j;
<a name="l00357"></a>00357             <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a505427ece8a203068870e2f6324da822">elementType</a> != <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a35ac7077f55a8b19c6a7ab928d737835a30c65f222d2f4a2b676084cf0389660d">OPENDRIVE_ET_ROAD</a>) {
<a name="l00358"></a>00358                 <span class="comment">// we are not interested in connections to nodes</span>
<a name="l00359"></a>00359                 std::cout &lt;&lt; <span class="stringliteral">&quot;unsupported&quot;</span> &lt;&lt; std::endl;
<a name="l00360"></a>00360                 <span class="keywordflow">continue</span>;
<a name="l00361"></a>00361             }
<a name="l00362"></a>00362             <span class="keywordflow">if</span> (edge2junction.find(l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a>) != edge2junction.end()) {
<a name="l00363"></a>00363                 <span class="comment">// not supported</span>
<a name="l00364"></a>00364                 std::cout &lt;&lt; <span class="stringliteral">&quot;unsupported&quot;</span> &lt;&lt; std::endl;
<a name="l00365"></a>00365                 <span class="keywordflow">continue</span>;
<a name="l00366"></a>00366             }
<a name="l00367"></a>00367             <span class="keywordflow">if</span> (l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a5f7b60f49af322c48ffcc3f7a2dbed8d">linkType</a> == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07a1193f5a48dbe095884b4c429122564ed">OPENDRIVE_LT_SUCCESSOR</a>) {
<a name="l00368"></a>00368                 <span class="keywordflow">if</span> (succ != <span class="stringliteral">&quot;&quot;</span>) {
<a name="l00369"></a>00369                     std::cout &lt;&lt; <span class="stringliteral">&quot;double succ&quot;</span> &lt;&lt; std::endl;
<a name="l00370"></a>00370                 }
<a name="l00371"></a>00371                 succ = l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a>;
<a name="l00372"></a>00372                 succC = l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a8f28e39325e14094708f1b0f1773a67e">contactPoint</a>;
<a name="l00373"></a>00373             } <span class="keywordflow">else</span> {
<a name="l00374"></a>00374                 <span class="keywordflow">if</span> (pred != <span class="stringliteral">&quot;&quot;</span>) {
<a name="l00375"></a>00375                     std::cout &lt;&lt; <span class="stringliteral">&quot;double pred&quot;</span> &lt;&lt; std::endl;
<a name="l00376"></a>00376                 }
<a name="l00377"></a>00377                 pred = l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a6ef9bfa5e1cb54bfd54d2795b4fdb209">elementID</a>;
<a name="l00378"></a>00378                 predC = l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a8f28e39325e14094708f1b0f1773a67e">contactPoint</a>;
<a name="l00379"></a>00379             }
<a name="l00380"></a>00380         }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382         <span class="keywordflow">if</span> (e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a3f337d7c62cab39903ff9891e28a3f8d">getMaxLaneNumber</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>) != 0 &amp;&amp; e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a3f337d7c62cab39903ff9891e28a3f8d">getMaxLaneNumber</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a>) != 0) {
<a name="l00383"></a>00383             std::cout &lt;&lt; <span class="stringliteral">&quot;Both dirs given!&quot;</span> &lt;&lt; std::endl;
<a name="l00384"></a>00384         }
<a name="l00385"></a>00385 
<a name="l00386"></a>00386         <span class="keywordtype">bool</span> isReversed = <span class="keyword">false</span>;
<a name="l00387"></a>00387         <span class="keywordflow">if</span> (e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a3f337d7c62cab39903ff9891e28a3f8d">getMaxLaneNumber</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>) != 0) {
<a name="l00388"></a>00388             <span class="comment">//            std::swap(pred, succ);</span>
<a name="l00389"></a>00389             <span class="comment">//std::swap(predC, succC);</span>
<a name="l00390"></a>00390             isReversed = <span class="keyword">true</span>;
<a name="l00391"></a>00391         }
<a name="l00392"></a>00392 
<a name="l00393"></a>00393         <span class="keywordflow">if</span> (succ == <span class="stringliteral">&quot;&quot;</span> || pred == <span class="stringliteral">&quot;&quot;</span>) {
<a name="l00394"></a>00394             std::cout &lt;&lt; <span class="stringliteral">&quot;Missing edge.&quot;</span> &lt;&lt; std::endl;
<a name="l00395"></a>00395             <span class="keywordflow">continue</span>; <span class="comment">// yes, occurs</span>
<a name="l00396"></a>00396         }
<a name="l00397"></a>00397         <span class="comment">// !!!why edge2junction; e already has the junction...</span>
<a name="l00398"></a>00398         <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* n = nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#ad979a4393f11213c4628c2fdb1dedc21" title="Returns the node container.">getNodeCont</a>().<a class="code" href="../../db/d8c/class_n_b_node_cont.html#a0e2ce1b9413a0c11728ac63344c62039" title="Returns the node with the given name.">retrieve</a>(edge2junction[e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>]);
<a name="l00399"></a>00399         std::vector&lt;OpenDriveEdge&gt;::iterator predEdge = std::find_if(outerEdges.begin(), outerEdges.end(), <a class="code" href="../../d7/d47/class_n_i_importer___open_drive_1_1edge__by__id__finder.html">edge_by_id_finder</a>(pred));
<a name="l00400"></a>00400         <span class="keywordflow">if</span> (predEdge == outerEdges.end()) {
<a name="l00401"></a>00401             <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Could not find connection edge.&quot;</span>);
<a name="l00402"></a>00402         }
<a name="l00403"></a>00403         std::vector&lt;OpenDriveEdge&gt;::iterator succEdge = std::find_if(outerEdges.begin(), outerEdges.end(), <a class="code" href="../../d7/d47/class_n_i_importer___open_drive_1_1edge__by__id__finder.html">edge_by_id_finder</a>(succ));
<a name="l00404"></a>00404         <span class="keywordflow">if</span> (succEdge == outerEdges.end()) {
<a name="l00405"></a>00405             <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Could not find connection edge.&quot;</span>);
<a name="l00406"></a>00406         }
<a name="l00407"></a>00407         <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* fromEdge, *toEdge;
<a name="l00408"></a>00408         <span class="keywordflow">if</span> (!isReversed) {
<a name="l00409"></a>00409             fromEdge = predC == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ad0c9b5bb37efe9f5cc4dd70a5cb6107ead0b89e97aa05133e825ecd4a1262ce7d">OPENDRIVE_CP_END</a> ? nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="stringliteral">&quot;-&quot;</span> + pred) : nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(pred);
<a name="l00410"></a>00410             toEdge = succC == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ad0c9b5bb37efe9f5cc4dd70a5cb6107eab77e17c32fec54df2d360fa279ba4497">OPENDRIVE_CP_START</a> ? nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="stringliteral">&quot;-&quot;</span> + succ) : nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(succ);
<a name="l00411"></a>00411         } <span class="keywordflow">else</span> {
<a name="l00412"></a>00412             fromEdge = predC != <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ad0c9b5bb37efe9f5cc4dd70a5cb6107ead0b89e97aa05133e825ecd4a1262ce7d">OPENDRIVE_CP_END</a> ? nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="stringliteral">&quot;-&quot;</span> + pred) : nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(pred);
<a name="l00413"></a>00413             toEdge = succC != <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ad0c9b5bb37efe9f5cc4dd70a5cb6107eab77e17c32fec54df2d360fa279ba4497">OPENDRIVE_CP_START</a> ? nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="stringliteral">&quot;-&quot;</span> + succ) : nb.<a class="code" href="../../d3/df6/class_n_b_net_builder.html#abee895b64ec934e4a4dea81e0d6cab1b" title="Returns the edge container.">getEdgeCont</a>().<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(succ);
<a name="l00414"></a>00414         }
<a name="l00415"></a>00415         <span class="comment">/*</span>
<a name="l00416"></a>00416 <span class="comment">        Connection c(</span>
<a name="l00417"></a>00417 <span class="comment">            n-&gt;hasIncoming(nb.getEdgeCont().retrieve(&quot;-&quot; + pred)) ? nb.getEdgeCont().retrieve(&quot;-&quot; + pred) : nb.getEdgeCont().retrieve(pred),</span>
<a name="l00418"></a>00418 <span class="comment">            e.id,</span>
<a name="l00419"></a>00419 <span class="comment">            n-&gt;hasOutgoing(nb.getEdgeCont().retrieve(&quot;-&quot; + succ)) ? nb.getEdgeCont().retrieve(&quot;-&quot; + succ) : nb.getEdgeCont().retrieve(succ));</span>
<a name="l00420"></a>00420 <span class="comment">            */</span>
<a name="l00421"></a>00421         <a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html">Connection</a> c(fromEdge, e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>, toEdge);
<a name="l00422"></a>00422         <span class="keywordflow">if</span> (c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a77dcc21d4e8085ea47e7545b3af4c75a">from</a> == 0 || c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a455e8c759c5a64ae872a43e33b8c4be5">to</a> == 0 || c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a77dcc21d4e8085ea47e7545b3af4c75a">from</a> == c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a455e8c759c5a64ae872a43e33b8c4be5">to</a>) {
<a name="l00423"></a>00423             <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Something&#39;s false&quot;</span>);
<a name="l00424"></a>00424         }
<a name="l00425"></a>00425         <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae2a93f72de64361627535a50e5c3c02e">setLaneConnections</a>(c,
<a name="l00426"></a>00426                            *predEdge, c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a77dcc21d4e8085ea47e7545b3af4c75a">from</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] != <span class="charliteral">&#39;-&#39;</span>, c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a77dcc21d4e8085ea47e7545b3af4c75a">from</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] == <span class="charliteral">&#39;-&#39;</span> ? <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a> : <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>,
<a name="l00427"></a>00427                            e, isReversed, !isReversed ? <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a> : <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>,
<a name="l00428"></a>00428                            *succEdge, c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a455e8c759c5a64ae872a43e33b8c4be5">to</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] != <span class="charliteral">&#39;-&#39;</span>, c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a455e8c759c5a64ae872a43e33b8c4be5">to</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] == <span class="charliteral">&#39;-&#39;</span> ? <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a> : <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>);
<a name="l00429"></a>00429         connections.push_back(c);
<a name="l00430"></a>00430     }
<a name="l00431"></a>00431     <span class="keywordflow">for</span> (std::vector&lt;Connection&gt;::const_iterator i = connections.begin(); i != connections.end(); ++i) {
<a name="l00432"></a>00432         <span class="keywordflow">if</span> ((*i).from == 0 || (*i).to == 0) {
<a name="l00433"></a>00433             std::cout &lt;&lt; <span class="stringliteral">&quot;Nope.&quot;</span> &lt;&lt; std::endl;
<a name="l00434"></a>00434             <span class="keywordflow">continue</span>;
<a name="l00435"></a>00435         }
<a name="l00436"></a>00436         (*i).from-&gt;addEdge2EdgeConnection((*i).to);
<a name="l00437"></a>00437         std::map&lt;int, int&gt; fromMap = fromLaneMap[(*i).from];
<a name="l00438"></a>00438         std::map&lt;int, int&gt; toMap = fromLaneMap[(*i).to];
<a name="l00439"></a>00439         <span class="keywordflow">for</span> (std::vector&lt;std::pair&lt;int, int&gt; &gt;::const_iterator j = (*i).lanes.begin(); j != (*i).lanes.end(); ++j) {
<a name="l00440"></a>00440             <span class="keywordtype">int</span> fromLane = fromMap[(*j).first];
<a name="l00441"></a>00441             <span class="keywordtype">int</span> toLane = toMap[(*j).second];
<a name="l00442"></a>00442             <span class="keywordflow">if</span> (static_cast&lt;unsigned int&gt;(fromLane) &gt;= (*i).from-&gt;getNumLanes() || fromLane &lt; 0) {
<a name="l00443"></a>00443                 std::cout &lt;&lt; <span class="stringliteral">&quot;False &quot;</span> &lt;&lt; std::endl;
<a name="l00444"></a>00444             }
<a name="l00445"></a>00445             <span class="keywordflow">if</span> (static_cast&lt;unsigned int&gt;(toLane) &gt;= (*i).to-&gt;getNumLanes() || toLane &lt; 0) {
<a name="l00446"></a>00446                 std::cout &lt;&lt; <span class="stringliteral">&quot;False &quot;</span> &lt;&lt; std::endl;
<a name="l00447"></a>00447             }
<a name="l00448"></a>00448 
<a name="l00449"></a>00449             (*i).from-&gt;addLane2LaneConnection(fromLane, (*i).to, toLane, <a class="code" href="../../d7/d41/class_n_b_edge.html#aa1576d07471ecc008d626cdbfb3302f2aba63868f28825735eb91856ff5ae804c" title="The connection was computed and validated.">NBEdge::L2L_VALIDATED</a>, <span class="keyword">true</span>);
<a name="l00450"></a>00450         }
<a name="l00451"></a>00451     }
<a name="l00452"></a>00452 }
<a name="l00453"></a>00453 
<a name="l00454"></a>00454 
<a name="l00455"></a>00455 <span class="keywordtype">void</span>
<a name="l00456"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a9bd14470d9395669a5f152ffecd6ef65">00456</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a9bd14470d9395669a5f152ffecd6ef65">NIImporter_OpenDrive::addViaConnectionSecure</a>(<span class="keyword">const</span> <a class="code" href="../../da/ded/class_n_b_edge_cont.html" title="Storage for edges, including some functionality operating on multiple edges.">NBEdgeCont</a>&amp; ec,
<a name="l00457"></a>00457         <span class="keyword">const</span> <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* <span class="keyword">const</span> node, <span class="keyword">const</span> <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e,
<a name="l00458"></a>00458         <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07">LinkType</a> lt, <span class="keyword">const</span> std::string&amp; via,
<a name="l00459"></a>00459         std::vector&lt;NIImporter_OpenDrive::Connection&gt; &amp;connections) {
<a name="l00460"></a>00460     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* from = 0;
<a name="l00461"></a>00461     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* to = 0;
<a name="l00462"></a>00462     <span class="keywordflow">if</span> (node == e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a91119a70d8f3361f20960b0db3ade200">to</a>) {
<a name="l00463"></a>00463         <span class="comment">// the connection is at the end of the &quot;positive&quot; direction</span>
<a name="l00464"></a>00464         <span class="keywordflow">if</span> (lt == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07ae7688ceef1eb3024d2753cee8ae7ab21">OPENDRIVE_LT_PREDECESSOR</a>) {
<a name="l00465"></a>00465             <span class="comment">// via -&gt; edge</span>
<a name="l00466"></a>00466             to = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>);
<a name="l00467"></a>00467         } <span class="keywordflow">else</span> {
<a name="l00468"></a>00468             <span class="comment">// -edge -&gt; via</span>
<a name="l00469"></a>00469             <span class="comment">//  &quot;ambigous?&quot;</span>
<a name="l00470"></a>00470             from = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="stringliteral">&quot;-&quot;</span> + e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>);
<a name="l00471"></a>00471         }
<a name="l00472"></a>00472     } <span class="keywordflow">else</span> {
<a name="l00473"></a>00473         <span class="comment">// the connection is at the begin of the &quot;positive&quot; direction</span>
<a name="l00474"></a>00474         <span class="keywordflow">if</span> (lt == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07ae7688ceef1eb3024d2753cee8ae7ab21">OPENDRIVE_LT_PREDECESSOR</a>) {
<a name="l00475"></a>00475             <span class="comment">// via -&gt; -edge</span>
<a name="l00476"></a>00476             to = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="stringliteral">&quot;-&quot;</span> + e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>);
<a name="l00477"></a>00477         } <span class="keywordflow">else</span> {
<a name="l00478"></a>00478             <span class="comment">// edge -&gt; via</span>
<a name="l00479"></a>00479             <span class="comment">//  &quot;ambigous?&quot;</span>
<a name="l00480"></a>00480             from = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>);
<a name="l00481"></a>00481         }
<a name="l00482"></a>00482     }
<a name="l00483"></a>00483     <span class="keywordflow">if</span> (from == 0 &amp;&amp; to == 0) {
<a name="l00484"></a>00484         <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Missing edge&quot;</span>);
<a name="l00485"></a>00485     }
<a name="l00486"></a>00486     <a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html">Connection</a> c(from, via, to);
<a name="l00487"></a>00487     connections.push_back(c);
<a name="l00488"></a>00488 }
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 <span class="keywordtype">void</span>
<a name="l00492"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a68273eb280862dca21820ad9d0db21d6">00492</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a68273eb280862dca21820ad9d0db21d6">NIImporter_OpenDrive::addE2EConnectionsSecure</a>(<span class="keyword">const</span> <a class="code" href="../../da/ded/class_n_b_edge_cont.html" title="Storage for edges, including some functionality operating on multiple edges.">NBEdgeCont</a>&amp; ec, <span class="keyword">const</span> <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* <span class="keyword">const</span> node,
<a name="l00493"></a>00493         <span class="keyword">const</span> <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">NIImporter_OpenDrive::OpenDriveEdge</a>&amp; from, <span class="keyword">const</span> <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">NIImporter_OpenDrive::OpenDriveEdge</a>&amp; to,
<a name="l00494"></a>00494         std::vector&lt;NIImporter_OpenDrive::Connection&gt; &amp;connections) {
<a name="l00495"></a>00495     <span class="comment">// positive direction (from is incoming, to is outgoing)</span>
<a name="l00496"></a>00496     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* fromEdge = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="stringliteral">&quot;-&quot;</span> + from.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>);
<a name="l00497"></a>00497     <span class="keywordflow">if</span> (fromEdge == 0 || !node-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a386dcd34fa654a46a77992b1291fe66f" title="Returns whether the given edge ends at this node.">hasIncoming</a>(fromEdge)) {
<a name="l00498"></a>00498         fromEdge = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(from.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>);
<a name="l00499"></a>00499     }
<a name="l00500"></a>00500     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* toEdge = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="stringliteral">&quot;-&quot;</span> + to.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>);
<a name="l00501"></a>00501     <span class="keywordflow">if</span> (toEdge == 0 || !node-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a082d27c0dcdc09d2de15a04ccc0489d5" title="Returns whether the given edge starts at this node.">hasOutgoing</a>(toEdge)) {
<a name="l00502"></a>00502         toEdge = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(to.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>);
<a name="l00503"></a>00503     }
<a name="l00504"></a>00504     <span class="keywordflow">if</span> (fromEdge != 0 &amp;&amp; toEdge != 0) {
<a name="l00505"></a>00505         <a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html">Connection</a> c(fromEdge, <span class="stringliteral">&quot;&quot;</span>, toEdge);
<a name="l00506"></a>00506         <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae2a93f72de64361627535a50e5c3c02e">setLaneConnections</a>(c,
<a name="l00507"></a>00507                            from, c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a77dcc21d4e8085ea47e7545b3af4c75a">from</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] != <span class="charliteral">&#39;-&#39;</span>, c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a77dcc21d4e8085ea47e7545b3af4c75a">from</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] == <span class="charliteral">&#39;-&#39;</span> ? <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a> : <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>,
<a name="l00508"></a>00508                            to, c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a455e8c759c5a64ae872a43e33b8c4be5">to</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] != <span class="charliteral">&#39;-&#39;</span>, c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a455e8c759c5a64ae872a43e33b8c4be5">to</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] == <span class="charliteral">&#39;-&#39;</span> ? <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a> : <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>);
<a name="l00509"></a>00509         connections.push_back(c);
<a name="l00510"></a>00510     }
<a name="l00511"></a>00511     <span class="comment">// negative direction (to is incoming, from is outgoing)</span>
<a name="l00512"></a>00512     fromEdge = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="stringliteral">&quot;-&quot;</span> + from.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>);
<a name="l00513"></a>00513     <span class="keywordflow">if</span> (fromEdge == 0 || !node-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a082d27c0dcdc09d2de15a04ccc0489d5" title="Returns whether the given edge starts at this node.">hasOutgoing</a>(fromEdge)) {
<a name="l00514"></a>00514         fromEdge = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(from.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>);
<a name="l00515"></a>00515     }
<a name="l00516"></a>00516     toEdge = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="stringliteral">&quot;-&quot;</span> + to.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>);
<a name="l00517"></a>00517     <span class="keywordflow">if</span> (toEdge == 0 || !node-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a386dcd34fa654a46a77992b1291fe66f" title="Returns whether the given edge ends at this node.">hasIncoming</a>(toEdge)) {
<a name="l00518"></a>00518         toEdge = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(to.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>);
<a name="l00519"></a>00519     }
<a name="l00520"></a>00520     <span class="keywordflow">if</span> (fromEdge != 0 &amp;&amp; toEdge != 0) {
<a name="l00521"></a>00521         <a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html">Connection</a> c(toEdge, <span class="stringliteral">&quot;&quot;</span>, fromEdge);
<a name="l00522"></a>00522         <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae2a93f72de64361627535a50e5c3c02e">setLaneConnections</a>(c,
<a name="l00523"></a>00523                            to, c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a455e8c759c5a64ae872a43e33b8c4be5">to</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] != <span class="charliteral">&#39;-&#39;</span>, c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a455e8c759c5a64ae872a43e33b8c4be5">to</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] == <span class="charliteral">&#39;-&#39;</span> ? <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a> : <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>,
<a name="l00524"></a>00524                            from, c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a77dcc21d4e8085ea47e7545b3af4c75a">from</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] != <span class="charliteral">&#39;-&#39;</span>, c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#a77dcc21d4e8085ea47e7545b3af4c75a">from</a>-&gt;<a class="code" href="../../d5/dbf/class_named.html#a20fd12b55c213fd79eae9fdd47b14eb1" title="Returns the id.">getID</a>()[0] == <span class="charliteral">&#39;-&#39;</span> ? <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a> : <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>);
<a name="l00525"></a>00525         connections.push_back(c);
<a name="l00526"></a>00526     }
<a name="l00527"></a>00527 }
<a name="l00528"></a>00528 
<a name="l00529"></a>00529 
<a name="l00530"></a>00530 <span class="keywordtype">void</span>
<a name="l00531"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae2a93f72de64361627535a50e5c3c02e">00531</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae2a93f72de64361627535a50e5c3c02e">NIImporter_OpenDrive::setLaneConnections</a>(<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html">NIImporter_OpenDrive::Connection</a>&amp; c,
<a name="l00532"></a>00532         <span class="keyword">const</span> <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; from, <span class="keywordtype">bool</span> fromAtBegin, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14" title="Numbers representing openDrive-XML - element names.">OpenDriveXMLTag</a> fromLaneDir,
<a name="l00533"></a>00533         <span class="keyword">const</span> <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; to, <span class="keywordtype">bool</span> toAtEnd, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14" title="Numbers representing openDrive-XML - element names.">OpenDriveXMLTag</a> toLaneDir) {
<a name="l00534"></a>00534     <span class="keyword">const</span> <a class="code" href="../../dc/dd7/struct_n_i_importer___open_drive_1_1_open_drive_lane_section.html" title="Representation of a lane section.">OpenDriveLaneSection</a>&amp; fromLS = fromAtBegin ? from.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>[0] : from.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>.back();
<a name="l00535"></a>00535     <span class="keyword">const</span> std::vector&lt;OpenDriveLane&gt; &amp;fromLanes = fromLS.<a class="code" href="../../dc/dd7/struct_n_i_importer___open_drive_1_1_open_drive_lane_section.html#a5eb1a91b0fab162adbddfc33ed289437">lanesByDir</a>.find(fromLaneDir)-&gt;second;
<a name="l00536"></a>00536     <span class="keyword">const</span> <a class="code" href="../../dc/dd7/struct_n_i_importer___open_drive_1_1_open_drive_lane_section.html" title="Representation of a lane section.">OpenDriveLaneSection</a>&amp; toLS = toAtEnd ? to.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>.back() : to.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>[0];
<a name="l00537"></a>00537     <span class="keyword">const</span> std::vector&lt;OpenDriveLane&gt; &amp;toLanes = toLS.<a class="code" href="../../dc/dd7/struct_n_i_importer___open_drive_1_1_open_drive_lane_section.html#a5eb1a91b0fab162adbddfc33ed289437">lanesByDir</a>.find(toLaneDir)-&gt;second;
<a name="l00538"></a>00538     <span class="comment">// in the following, we are probably using the same information twice, stored once</span>
<a name="l00539"></a>00539     <span class="comment">//  in the from-edge&#39;s successor field and in the to-edge&#39;s precessor field.</span>
<a name="l00540"></a>00540     <span class="comment">// though, we have no proof or information that this is always redundant</span>
<a name="l00541"></a>00541     <span class="keywordflow">for</span> (std::vector&lt;OpenDriveLane&gt;::const_iterator i = fromLanes.begin(); i != fromLanes.end(); ++i) {
<a name="l00542"></a>00542         <span class="keywordflow">if</span> ((*i).type != <span class="stringliteral">&quot;driving&quot;</span>) {
<a name="l00543"></a>00543             <span class="keywordflow">continue</span>;
<a name="l00544"></a>00544         }
<a name="l00545"></a>00545         <span class="keywordflow">if</span> (!fromAtBegin &amp;&amp; (*i).successor != <a class="code" href="../../d6/d80/_n_i_importer___open_drive_8h.html#a8e2611f7f2cfa5f282b6332a4812eeab">UNSET_CONNECTION</a>) {
<a name="l00546"></a>00546             c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#ac19a82e449cffebb08ce734365b97037">lanes</a>.push_back(std::make_pair((*i).id, (*i).successor));
<a name="l00547"></a>00547         }
<a name="l00548"></a>00548         <span class="keywordflow">if</span> (fromAtBegin &amp;&amp; (*i).predecessor != <a class="code" href="../../d6/d80/_n_i_importer___open_drive_8h.html#a8e2611f7f2cfa5f282b6332a4812eeab">UNSET_CONNECTION</a>) {
<a name="l00549"></a>00549             c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#ac19a82e449cffebb08ce734365b97037">lanes</a>.push_back(std::make_pair((*i).id, (*i).predecessor));
<a name="l00550"></a>00550         }
<a name="l00551"></a>00551     }
<a name="l00552"></a>00552     <span class="keywordflow">for</span> (std::vector&lt;OpenDriveLane&gt;::const_iterator i = toLanes.begin(); i != toLanes.end(); ++i) {
<a name="l00553"></a>00553         <span class="keywordflow">if</span> ((*i).type != <span class="stringliteral">&quot;driving&quot;</span>) {
<a name="l00554"></a>00554             <span class="keywordflow">continue</span>;
<a name="l00555"></a>00555         }
<a name="l00556"></a>00556         <span class="keywordflow">if</span> (!toAtEnd &amp;&amp; (*i).predecessor != <a class="code" href="../../d6/d80/_n_i_importer___open_drive_8h.html#a8e2611f7f2cfa5f282b6332a4812eeab">UNSET_CONNECTION</a>) {
<a name="l00557"></a>00557             c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#ac19a82e449cffebb08ce734365b97037">lanes</a>.push_back(std::make_pair((*i).predecessor, (*i).id));
<a name="l00558"></a>00558         }
<a name="l00559"></a>00559         <span class="keywordflow">if</span> (toAtEnd &amp;&amp; (*i).successor != <a class="code" href="../../d6/d80/_n_i_importer___open_drive_8h.html#a8e2611f7f2cfa5f282b6332a4812eeab">UNSET_CONNECTION</a>) {
<a name="l00560"></a>00560             c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#ac19a82e449cffebb08ce734365b97037">lanes</a>.push_back(std::make_pair((*i).successor, (*i).id));
<a name="l00561"></a>00561         }
<a name="l00562"></a>00562     }
<a name="l00563"></a>00563 }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 
<a name="l00566"></a>00566 <span class="keywordtype">void</span>
<a name="l00567"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a777f4fa96afacc5f4342e248890de64c">00567</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae2a93f72de64361627535a50e5c3c02e">NIImporter_OpenDrive::setLaneConnections</a>(<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html">NIImporter_OpenDrive::Connection</a>&amp; c,
<a name="l00568"></a>00568         <span class="keyword">const</span> <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; from, <span class="keywordtype">bool</span> fromAtBegin, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14" title="Numbers representing openDrive-XML - element names.">OpenDriveXMLTag</a> fromLaneDir,
<a name="l00569"></a>00569         <span class="keyword">const</span> <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; via, <span class="keywordtype">bool</span> viaIsReversed, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14" title="Numbers representing openDrive-XML - element names.">OpenDriveXMLTag</a> viaLaneDir,
<a name="l00570"></a>00570         <span class="keyword">const</span> <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; to, <span class="keywordtype">bool</span> toAtEnd, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14" title="Numbers representing openDrive-XML - element names.">OpenDriveXMLTag</a> toLaneDir) {
<a name="l00571"></a>00571     <a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html">Connection</a> from2via(0, <span class="stringliteral">&quot;&quot;</span>, 0);
<a name="l00572"></a>00572     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae2a93f72de64361627535a50e5c3c02e">setLaneConnections</a>(from2via, from, fromAtBegin, fromLaneDir, via, viaIsReversed, viaLaneDir);
<a name="l00573"></a>00573     <a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html">Connection</a> via2to(0, <span class="stringliteral">&quot;&quot;</span>, 0);
<a name="l00574"></a>00574     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae2a93f72de64361627535a50e5c3c02e">setLaneConnections</a>(via2to, via, viaIsReversed, viaLaneDir, to, toAtEnd, toLaneDir);
<a name="l00575"></a>00575     <span class="keywordflow">for</span> (std::vector&lt;std::pair&lt;int, int&gt; &gt;::const_iterator i = from2via.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#ac19a82e449cffebb08ce734365b97037">lanes</a>.begin(); i != from2via.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#ac19a82e449cffebb08ce734365b97037">lanes</a>.end(); ++i) {
<a name="l00576"></a>00576         <span class="keywordtype">int</span> fromLane = (*i).first;
<a name="l00577"></a>00577         <span class="keywordtype">int</span> viaLane = (*i).second;
<a name="l00578"></a>00578         <span class="keywordflow">for</span> (std::vector&lt;std::pair&lt;int, int&gt; &gt;::const_iterator j = via2to.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#ac19a82e449cffebb08ce734365b97037">lanes</a>.begin(); j != via2to.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#ac19a82e449cffebb08ce734365b97037">lanes</a>.end(); ++j) {
<a name="l00579"></a>00579             <span class="keywordflow">if</span> ((*j).first == viaLane) {
<a name="l00580"></a>00580                 c.<a class="code" href="../../d6/d9e/struct_n_i_importer___open_drive_1_1_connection.html#ac19a82e449cffebb08ce734365b97037">lanes</a>.push_back(std::make_pair(fromLane, (*j).second));
<a name="l00581"></a>00581                 <span class="keywordflow">break</span>;
<a name="l00582"></a>00582             }
<a name="l00583"></a>00583         }
<a name="l00584"></a>00584     }
<a name="l00585"></a>00585 }
<a name="l00586"></a>00586 
<a name="l00587"></a>00587 
<a name="l00588"></a>00588 <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>*
<a name="l00589"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a5b5767379dfb702af5f2c15f396186fa">00589</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a5b5767379dfb702af5f2c15f396186fa" title="Builds a node or returns the already built.">NIImporter_OpenDrive::getOrBuildNode</a>(<span class="keyword">const</span> std::string&amp; <span class="keywordtype">id</span>, <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a>&amp; pos,
<a name="l00590"></a>00590                                      <a class="code" href="../../db/d8c/class_n_b_node_cont.html" title="Container for nodes during the netbuilding process.">NBNodeCont</a>&amp; nc) {
<a name="l00591"></a>00591     <span class="keywordflow">if</span> (nc.<a class="code" href="../../db/d8c/class_n_b_node_cont.html#a0e2ce1b9413a0c11728ac63344c62039" title="Returns the node with the given name.">retrieve</a>(<span class="keywordtype">id</span>) == 0) {
<a name="l00592"></a>00592         <span class="comment">// not yet built; build now</span>
<a name="l00593"></a>00593         <span class="keywordflow">if</span> (!nc.<a class="code" href="../../db/d8c/class_n_b_node_cont.html#ab70c3a2678e411a0b1e3edd41d2dd177" title="Inserts a node into the map.">insert</a>(<span class="keywordtype">id</span>, pos)) {
<a name="l00594"></a>00594             <span class="comment">// !!! clean up</span>
<a name="l00595"></a>00595             <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Could not add node &#39;&quot;</span> + <span class="keywordtype">id</span> + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00596"></a>00596         }
<a name="l00597"></a>00597     }
<a name="l00598"></a>00598     <span class="keywordflow">return</span> nc.<a class="code" href="../../db/d8c/class_n_b_node_cont.html#a0e2ce1b9413a0c11728ac63344c62039" title="Returns the node with the given name.">retrieve</a>(<span class="keywordtype">id</span>);
<a name="l00599"></a>00599 }
<a name="l00600"></a>00600 
<a name="l00601"></a>00601 
<a name="l00602"></a>00602 <span class="keywordtype">void</span>
<a name="l00603"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6f164c6ea11d35c8f100682973bdfd0b">00603</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6f164c6ea11d35c8f100682973bdfd0b">NIImporter_OpenDrive::setNodeSecure</a>(<a class="code" href="../../db/d8c/class_n_b_node_cont.html" title="Container for nodes during the netbuilding process.">NBNodeCont</a>&amp; nc, <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e,
<a name="l00604"></a>00604                                     <span class="keyword">const</span> std::string&amp; nodeID, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07">NIImporter_OpenDrive::LinkType</a> lt) {
<a name="l00605"></a>00605     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* n = nc.<a class="code" href="../../db/d8c/class_n_b_node_cont.html#a0e2ce1b9413a0c11728ac63344c62039" title="Returns the node with the given name.">retrieve</a>(nodeID);
<a name="l00606"></a>00606     <span class="keywordflow">if</span> (n == 0) {
<a name="l00607"></a>00607         <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Could not find node &#39;&quot;</span> + nodeID + <span class="stringliteral">&quot;&#39;.&quot;</span>);
<a name="l00608"></a>00608     }
<a name="l00609"></a>00609     <span class="keywordflow">if</span> (lt == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07a1193f5a48dbe095884b4c429122564ed">OPENDRIVE_LT_SUCCESSOR</a>) {
<a name="l00610"></a>00610         <span class="keywordflow">if</span> (e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a91119a70d8f3361f20960b0db3ade200">to</a> != 0 &amp;&amp; e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a91119a70d8f3361f20960b0db3ade200">to</a> != n) {
<a name="l00611"></a>00611             <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Edge &#39;&quot;</span> + e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a> + <span class="stringliteral">&quot;&#39; has two end nodes.&quot;</span>);
<a name="l00612"></a>00612         }
<a name="l00613"></a>00613         e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a91119a70d8f3361f20960b0db3ade200">to</a> = n;
<a name="l00614"></a>00614     } <span class="keywordflow">else</span> {
<a name="l00615"></a>00615         <span class="keywordflow">if</span> (e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#aba5685ab6e4d7c7da2a9123d942d3d97">from</a> != 0 &amp;&amp; e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#aba5685ab6e4d7c7da2a9123d942d3d97">from</a> != n) {
<a name="l00616"></a>00616             <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Edge &#39;&quot;</span> + e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a> + <span class="stringliteral">&quot;&#39; has two start nodes.&quot;</span>);
<a name="l00617"></a>00617         }
<a name="l00618"></a>00618         e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#aba5685ab6e4d7c7da2a9123d942d3d97">from</a> = n;
<a name="l00619"></a>00619     }
<a name="l00620"></a>00620 }
<a name="l00621"></a>00621 
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 
<a name="l00626"></a>00626 <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>*
<a name="l00627"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a97683e955328bf1b4aaeb0b0f7b834d4">00627</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a97683e955328bf1b4aaeb0b0f7b834d4">NIImporter_OpenDrive::getOutgoingDirectionalEdge</a>(<span class="keyword">const</span> <a class="code" href="../../da/ded/class_n_b_edge_cont.html" title="Storage for edges, including some functionality operating on multiple edges.">NBEdgeCont</a>&amp; ec,
<a name="l00628"></a>00628         <span class="keyword">const</span> <a class="code" href="../../db/d8c/class_n_b_node_cont.html" title="Container for nodes during the netbuilding process.">NBNodeCont</a>&amp; nc,
<a name="l00629"></a>00629         <span class="keyword">const</span> std::string&amp; edgeID,
<a name="l00630"></a>00630         <span class="keyword">const</span> std::string&amp; nodeID) {
<a name="l00631"></a>00631     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* node = nc.<a class="code" href="../../db/d8c/class_n_b_node_cont.html#a0e2ce1b9413a0c11728ac63344c62039" title="Returns the node with the given name.">retrieve</a>(nodeID);
<a name="l00632"></a>00632     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* e = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(edgeID);
<a name="l00633"></a>00633     <span class="keywordflow">if</span> (e != 0 &amp;&amp; node-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a082d27c0dcdc09d2de15a04ccc0489d5" title="Returns whether the given edge starts at this node.">hasOutgoing</a>(e)) {
<a name="l00634"></a>00634         <span class="keywordflow">return</span> e;
<a name="l00635"></a>00635     }
<a name="l00636"></a>00636     e = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="stringliteral">&quot;-&quot;</span> + edgeID);
<a name="l00637"></a>00637     <span class="keywordflow">if</span> (e != 0 &amp;&amp; node-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a082d27c0dcdc09d2de15a04ccc0489d5" title="Returns whether the given edge starts at this node.">hasOutgoing</a>(e)) {
<a name="l00638"></a>00638         <span class="keywordflow">return</span> e;
<a name="l00639"></a>00639     }
<a name="l00640"></a>00640     <span class="keywordflow">return</span> 0;
<a name="l00641"></a>00641 }
<a name="l00642"></a>00642 
<a name="l00643"></a>00643 
<a name="l00644"></a>00644 <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>*
<a name="l00645"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ab8b0856e87bd40d68533a4bcf3b2804b">00645</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ab8b0856e87bd40d68533a4bcf3b2804b">NIImporter_OpenDrive::getIncomingDirectionalEdge</a>(<span class="keyword">const</span> <a class="code" href="../../da/ded/class_n_b_edge_cont.html" title="Storage for edges, including some functionality operating on multiple edges.">NBEdgeCont</a>&amp; ec,
<a name="l00646"></a>00646         <span class="keyword">const</span> <a class="code" href="../../db/d8c/class_n_b_node_cont.html" title="Container for nodes during the netbuilding process.">NBNodeCont</a>&amp; nc,
<a name="l00647"></a>00647         <span class="keyword">const</span> std::string&amp; edgeID,
<a name="l00648"></a>00648         <span class="keyword">const</span> std::string&amp; nodeID) {
<a name="l00649"></a>00649     <a class="code" href="../../d3/dd1/class_n_b_node.html" title="Represents a single node (junction) during network building.">NBNode</a>* node = nc.<a class="code" href="../../db/d8c/class_n_b_node_cont.html#a0e2ce1b9413a0c11728ac63344c62039" title="Returns the node with the given name.">retrieve</a>(nodeID);
<a name="l00650"></a>00650     <a class="code" href="../../d7/d41/class_n_b_edge.html" title="The representation of a single edge during network building.">NBEdge</a>* e = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(edgeID);
<a name="l00651"></a>00651     <span class="keywordflow">if</span> (e != 0 &amp;&amp; node-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a386dcd34fa654a46a77992b1291fe66f" title="Returns whether the given edge ends at this node.">hasIncoming</a>(e)) {
<a name="l00652"></a>00652         <span class="keywordflow">return</span> e;
<a name="l00653"></a>00653     }
<a name="l00654"></a>00654     e = ec.<a class="code" href="../../da/ded/class_n_b_edge_cont.html#a6f3edcea491ac076689edc6d1b8ba289" title="Returns the edge that has the given id.">retrieve</a>(<span class="stringliteral">&quot;-&quot;</span> + edgeID);
<a name="l00655"></a>00655     <span class="keywordflow">if</span> (e != 0 &amp;&amp; node-&gt;<a class="code" href="../../d3/dd1/class_n_b_node.html#a386dcd34fa654a46a77992b1291fe66f" title="Returns whether the given edge ends at this node.">hasIncoming</a>(e)) {
<a name="l00656"></a>00656         <span class="keywordflow">return</span> e;
<a name="l00657"></a>00657     }
<a name="l00658"></a>00658     <span class="keywordflow">return</span> 0;
<a name="l00659"></a>00659 }
<a name="l00660"></a>00660 
<a name="l00661"></a>00661 
<a name="l00662"></a>00662 <span class="keywordtype">void</span>
<a name="l00663"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a97872c6a192689d27676dc288d14c908">00663</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a97872c6a192689d27676dc288d14c908">NIImporter_OpenDrive::computeShapes</a>(std::vector&lt;OpenDriveEdge&gt; &amp;edges) {
<a name="l00664"></a>00664     <span class="keywordflow">for</span> (std::vector&lt;OpenDriveEdge&gt;::iterator i = edges.begin(); i != edges.end(); ++i) {
<a name="l00665"></a>00665         <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e = *i;
<a name="l00666"></a>00666         <span class="keywordflow">for</span> (std::vector&lt;OpenDriveGeometry&gt;::iterator j = e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae4c771fff9ddb0ad3d530a855907d0d6">geometries</a>.begin(); j != e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae4c771fff9ddb0ad3d530a855907d0d6">geometries</a>.end(); ++j) {
<a name="l00667"></a>00667             <a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html" title="Representation of an openDrive geometry part.">OpenDriveGeometry</a>&amp; g = *j;
<a name="l00668"></a>00668             std::vector&lt;Position&gt; geom;
<a name="l00669"></a>00669             <span class="keywordflow">switch</span> (g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a1e1eef4175f65d8731791951330693f8">type</a>) {
<a name="l00670"></a>00670                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ffad572af38ec5f0c4ce1052d4bbf34a53d0ebf6f428913486b39575085d8bfd">OPENDRIVE_GT_UNKNOWN</a>:
<a name="l00671"></a>00671                     <span class="keywordflow">break</span>;
<a name="l00672"></a>00672                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ffad572af38ec5f0c4ce1052d4bbf34a7516ba7e8a2a6b45d1170e31a57a84e9">OPENDRIVE_GT_LINE</a>:
<a name="l00673"></a>00673                     geom = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6a1e7494342bf27685772bd6effe7d06">geomFromLine</a>(e, g);
<a name="l00674"></a>00674                     <span class="keywordflow">break</span>;
<a name="l00675"></a>00675                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ffad572af38ec5f0c4ce1052d4bbf34ac92aa3ba1401822d079f34517a90f758">OPENDRIVE_GT_SPIRAL</a>:
<a name="l00676"></a>00676                     geom = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1d4e759f0df2b3b1c155ff0035264a7a">geomFromSpiral</a>(e, g);
<a name="l00677"></a>00677                     <span class="keywordflow">break</span>;
<a name="l00678"></a>00678                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ffad572af38ec5f0c4ce1052d4bbf34a24d0b7378aaafa017dbbc7abca79f1a9">OPENDRIVE_GT_ARC</a>:
<a name="l00679"></a>00679                     geom = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a2b2108a1d73550dffc4f5b1b69535c7f">geomFromArc</a>(e, g);
<a name="l00680"></a>00680                     <span class="keywordflow">break</span>;
<a name="l00681"></a>00681                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ffad572af38ec5f0c4ce1052d4bbf34a46d82de4b115a5e925d3ecc8fcbd52a6">OPENDRIVE_GT_POLY3</a>:
<a name="l00682"></a>00682                     geom = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a68761fcca2bc1d8798b20c2901f5f8d6">geomFromPoly</a>(e, g);
<a name="l00683"></a>00683                     <span class="keywordflow">break</span>;
<a name="l00684"></a>00684                 <span class="keywordflow">default</span>:
<a name="l00685"></a>00685                     <span class="keywordflow">break</span>;
<a name="l00686"></a>00686             }
<a name="l00687"></a>00687             <span class="keywordflow">for</span> (std::vector&lt;Position&gt;::iterator k = geom.begin(); k != geom.end(); ++k) {
<a name="l00688"></a>00688                 e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae45a625f55e68964364308c6cc46cc13">geom</a>.<a class="code" href="../../da/d56/class_position_vector.html#ab86064177ddffd3981afb3ce95e4a52e">push_back_noDoublePos</a>(*k);
<a name="l00689"></a>00689             }
<a name="l00690"></a>00690         }
<a name="l00691"></a>00691         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae45a625f55e68964364308c6cc46cc13">geom</a>.<a class="code" href="../../da/d56/class_position_vector.html#a4f728d62950004e143aa921c5f64de2f" title="returns the number of points making up the line vector">size</a>(); ++j) {
<a name="l00692"></a>00692             <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d26/class_n_i_loader.html#aff54c5ec457af6836a76d6745276f477" title="transforms loaded coordinates handles projections, offsets (using GeoConvHelper)...">NILoader::transformCoordinates</a>(e.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae45a625f55e68964364308c6cc46cc13">geom</a>[j])) {
<a name="l00693"></a>00693                 <a class="code" href="../../d4/df7/_msg_handler_8h.html#a55c513aa2d151eee464020081d6688c2">WRITE_ERROR</a>(<span class="stringliteral">&quot;Unable to project coordinates for.&quot;</span>);
<a name="l00694"></a>00694             }
<a name="l00695"></a>00695         }
<a name="l00696"></a>00696     }
<a name="l00697"></a>00697 }
<a name="l00698"></a>00698 
<a name="l00699"></a>00699 std::vector&lt;Position&gt;
<a name="l00700"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6a1e7494342bf27685772bd6effe7d06">00700</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6a1e7494342bf27685772bd6effe7d06">NIImporter_OpenDrive::geomFromLine</a>(<span class="keyword">const</span> <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e, <span class="keyword">const</span> <a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html" title="Representation of an openDrive geometry part.">OpenDriveGeometry</a>&amp; g) {
<a name="l00701"></a>00701     <a class="code" href="../../da/dbd/_std_defs_8h.html#a3c95a90e7806e4b0d21edfae15b73465">UNUSED_PARAMETER</a>(e);
<a name="l00702"></a>00702     std::vector&lt;Position&gt; ret;
<a name="l00703"></a>00703     ret.push_back(<a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a>(g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a41588df4bb08994d2f3981884e27718d">x</a>, g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a6ab2a2992025d87ab254267cc1c78012">y</a>));
<a name="l00704"></a>00704     ret.push_back(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a61e5d63f6bd3c55198be4843a0e94cd4">calculateStraightEndPoint</a>(g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a8cd1583bf00d645f1a153ce2243034db">hdg</a>, g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#ab38ab2800ab06cfb78822e2aff581118">length</a>, <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a>(g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a41588df4bb08994d2f3981884e27718d">x</a>, g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a6ab2a2992025d87ab254267cc1c78012">y</a>)));
<a name="l00705"></a>00705     <span class="keywordflow">return</span> ret;
<a name="l00706"></a>00706 }
<a name="l00707"></a>00707 
<a name="l00708"></a>00708 
<a name="l00709"></a>00709 std::vector&lt;Position&gt;
<a name="l00710"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1d4e759f0df2b3b1c155ff0035264a7a">00710</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1d4e759f0df2b3b1c155ff0035264a7a">NIImporter_OpenDrive::geomFromSpiral</a>(<span class="keyword">const</span> <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e, <span class="keyword">const</span> <a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html" title="Representation of an openDrive geometry part.">OpenDriveGeometry</a>&amp; g) {
<a name="l00711"></a>00711     <a class="code" href="../../da/dbd/_std_defs_8h.html#a3c95a90e7806e4b0d21edfae15b73465">UNUSED_PARAMETER</a>(e);
<a name="l00712"></a>00712     std::vector&lt;Position&gt; ret;
<a name="l00713"></a>00713     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> curveStart = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a63ec5c38890b91338c1071fca1f352bf">params</a>[0];
<a name="l00714"></a>00714     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> curveEnd = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a63ec5c38890b91338c1071fca1f352bf">params</a>[1];
<a name="l00715"></a>00715     <a class="code" href="../../d1/d1d/class_point2_d.html">Point2D&lt;double&gt;</a> end;
<a name="l00716"></a>00716     <a class="code" href="../../dd/d02/class_euler_spiral.html">EulerSpiral</a> s(<a class="code" href="../../d1/d1d/class_point2_d.html">Point2D&lt;double&gt;</a>(g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a41588df4bb08994d2f3981884e27718d">x</a>, g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a6ab2a2992025d87ab254267cc1c78012">y</a>), g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a8cd1583bf00d645f1a153ce2243034db">hdg</a>, curveStart, (curveEnd - curveStart) / g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#ab38ab2800ab06cfb78822e2aff581118">length</a>, g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#ab38ab2800ab06cfb78822e2aff581118">length</a>);
<a name="l00717"></a>00717     std::vector&lt;Point2D&lt;double&gt; &gt; into;
<a name="l00718"></a>00718     s.<a class="code" href="../../dd/d02/class_euler_spiral.html#ad9ac04805181f276de4c17050ab7dc7b">computeSpiral</a>(into, 1.);
<a name="l00719"></a>00719     <span class="keywordflow">for</span> (std::vector&lt;<a class="code" href="../../d1/d1d/class_point2_d.html">Point2D&lt;double&gt;</a> &gt;::iterator i = into.begin(); i != into.end(); ++i) {
<a name="l00720"></a>00720         ret.push_back(<a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a>((*i).getX(), (*i).getY()));
<a name="l00721"></a>00721     }
<a name="l00722"></a>00722     <span class="keywordflow">return</span> ret;
<a name="l00723"></a>00723 }
<a name="l00724"></a>00724 
<a name="l00725"></a>00725 
<a name="l00726"></a>00726 std::vector&lt;Position&gt;
<a name="l00727"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a2b2108a1d73550dffc4f5b1b69535c7f">00727</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a2b2108a1d73550dffc4f5b1b69535c7f">NIImporter_OpenDrive::geomFromArc</a>(<span class="keyword">const</span> <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e, <span class="keyword">const</span> <a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html" title="Representation of an openDrive geometry part.">OpenDriveGeometry</a>&amp; g) {
<a name="l00728"></a>00728     <a class="code" href="../../da/dbd/_std_defs_8h.html#a3c95a90e7806e4b0d21edfae15b73465">UNUSED_PARAMETER</a>(e);
<a name="l00729"></a>00729     std::vector&lt;Position&gt; ret;
<a name="l00730"></a>00730     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> dist = 0.0;
<a name="l00731"></a>00731     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> centerX = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a41588df4bb08994d2f3981884e27718d">x</a>;
<a name="l00732"></a>00732     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> centerY = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a6ab2a2992025d87ab254267cc1c78012">y</a>;
<a name="l00733"></a>00733     <span class="comment">// left: positive value</span>
<a name="l00734"></a>00734     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> curvature = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a63ec5c38890b91338c1071fca1f352bf">params</a>[0];
<a name="l00735"></a>00735     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> radius = 1. / curvature;
<a name="l00736"></a>00736     <span class="comment">// center point</span>
<a name="l00737"></a>00737     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#af9db7c1322359dd9bfd375cbf9f55a5c">calculateCurveCenter</a>(&amp;centerX, &amp;centerY, radius, g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a8cd1583bf00d645f1a153ce2243034db">hdg</a>);
<a name="l00738"></a>00738     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> endX = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a41588df4bb08994d2f3981884e27718d">x</a>;
<a name="l00739"></a>00739     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> endY = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a6ab2a2992025d87ab254267cc1c78012">y</a>;
<a name="l00740"></a>00740     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> startX = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a41588df4bb08994d2f3981884e27718d">x</a>;
<a name="l00741"></a>00741     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> startY = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a6ab2a2992025d87ab254267cc1c78012">y</a>;
<a name="l00742"></a>00742     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> hdgS = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a8cd1583bf00d645f1a153ce2243034db">hdg</a>;
<a name="l00743"></a>00743     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> hdgE;
<a name="l00744"></a>00744     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> geo_posS = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#afc1f3fc40bbb8976cdd6983cd17447ae">s</a>;
<a name="l00745"></a>00745     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> geo_posE = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#afc1f3fc40bbb8976cdd6983cd17447ae">s</a>;
<a name="l00746"></a>00746     <span class="keywordtype">bool</span> end = <span class="keyword">false</span>;
<a name="l00747"></a>00747     <span class="keywordflow">do</span> {
<a name="l00748"></a>00748         geo_posE += <a class="code" href="../../dc/d0a/_n_i_importer___open_drive_8cpp.html#a0d306bfae8005487a9e4ebeedc65e287">C_LENGTH</a>;
<a name="l00749"></a>00749         <span class="keywordflow">if</span> (geo_posE - g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#afc1f3fc40bbb8976cdd6983cd17447ae">s</a> &gt; g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#ab38ab2800ab06cfb78822e2aff581118">length</a>) {
<a name="l00750"></a>00750             geo_posE = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#afc1f3fc40bbb8976cdd6983cd17447ae">s</a> + g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#ab38ab2800ab06cfb78822e2aff581118">length</a>;
<a name="l00751"></a>00751         }
<a name="l00752"></a>00752         <span class="keywordflow">if</span> (geo_posE - g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#afc1f3fc40bbb8976cdd6983cd17447ae">s</a> &gt; g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#ab38ab2800ab06cfb78822e2aff581118">length</a>) {
<a name="l00753"></a>00753             geo_posE = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#afc1f3fc40bbb8976cdd6983cd17447ae">s</a> + g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#ab38ab2800ab06cfb78822e2aff581118">length</a>;
<a name="l00754"></a>00754         }
<a name="l00755"></a>00755         <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a851d207ee5b13f53e0ea8b4d60eed187">calcPointOnCurve</a>(&amp;endX, &amp;endY, centerX, centerY, radius, geo_posE - geo_posS);
<a name="l00756"></a>00756 
<a name="l00757"></a>00757         dist += (geo_posE - geo_posS);
<a name="l00758"></a>00758         <span class="keywordflow">if</span> (curvature &gt; 0.0) {
<a name="l00759"></a>00759             hdgE = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a8cd1583bf00d645f1a153ce2243034db">hdg</a> + dist / fabs(radius);
<a name="l00760"></a>00760         } <span class="keywordflow">else</span> {
<a name="l00761"></a>00761             hdgE = g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a8cd1583bf00d645f1a153ce2243034db">hdg</a> - dist / fabs(radius);
<a name="l00762"></a>00762         }
<a name="l00763"></a>00763         <span class="comment">//</span>
<a name="l00764"></a>00764         ret.push_back(<a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a>(startX, startY));
<a name="l00765"></a>00765         <span class="comment">//</span>
<a name="l00766"></a>00766         startX = endX;
<a name="l00767"></a>00767         startY = endY;
<a name="l00768"></a>00768         geo_posS = geo_posE;
<a name="l00769"></a>00769         hdgS = hdgE;
<a name="l00770"></a>00770 
<a name="l00771"></a>00771         <span class="keywordflow">if</span> (geo_posE  - (g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#afc1f3fc40bbb8976cdd6983cd17447ae">s</a> + g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#ab38ab2800ab06cfb78822e2aff581118">length</a>) &lt; 0.001 &amp;&amp; geo_posE  - (g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#afc1f3fc40bbb8976cdd6983cd17447ae">s</a> + g.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#ab38ab2800ab06cfb78822e2aff581118">length</a>) &gt; -0.001) {
<a name="l00772"></a>00772             end = <span class="keyword">true</span>;
<a name="l00773"></a>00773         }
<a name="l00774"></a>00774     } <span class="keywordflow">while</span> (!end);
<a name="l00775"></a>00775     <span class="keywordflow">return</span> ret;
<a name="l00776"></a>00776 }
<a name="l00777"></a>00777 
<a name="l00778"></a>00778 
<a name="l00779"></a>00779 std::vector&lt;Position&gt;
<a name="l00780"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a68761fcca2bc1d8798b20c2901f5f8d6">00780</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a68761fcca2bc1d8798b20c2901f5f8d6">NIImporter_OpenDrive::geomFromPoly</a>(<span class="keyword">const</span> <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>&amp; e, <span class="keyword">const</span> <a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html" title="Representation of an openDrive geometry part.">OpenDriveGeometry</a>&amp; g) {
<a name="l00781"></a>00781     <a class="code" href="../../da/dbd/_std_defs_8h.html#a3c95a90e7806e4b0d21edfae15b73465">UNUSED_PARAMETER</a>(g);
<a name="l00782"></a>00782     <a class="code" href="../../da/dbd/_std_defs_8h.html#a3c95a90e7806e4b0d21edfae15b73465">UNUSED_PARAMETER</a>(e);
<a name="l00783"></a>00783     std::vector&lt;Position&gt; ret;
<a name="l00784"></a>00784     <span class="keywordflow">return</span> ret;
<a name="l00785"></a>00785 }
<a name="l00786"></a>00786 
<a name="l00787"></a>00787 
<a name="l00788"></a>00788 <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a>
<a name="l00789"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a61e5d63f6bd3c55198be4843a0e94cd4">00789</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a61e5d63f6bd3c55198be4843a0e94cd4">NIImporter_OpenDrive::calculateStraightEndPoint</a>(<span class="keywordtype">double</span> hdg, <span class="keywordtype">double</span> length, <span class="keyword">const</span> <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a>&amp; start) {
<a name="l00790"></a>00790     <span class="keywordtype">double</span> normx = 1.0f;
<a name="l00791"></a>00791     <span class="keywordtype">double</span> normy = 0.0f;
<a name="l00792"></a>00792     <span class="keywordtype">double</span> x2 = normx * cos(hdg) - normy * sin(hdg);
<a name="l00793"></a>00793     <span class="keywordtype">double</span> y2 = normx * sin(hdg) + normy * cos(hdg);
<a name="l00794"></a>00794     normx = x2 * length;
<a name="l00795"></a>00795     normy = y2 * length;
<a name="l00796"></a>00796     <span class="keywordflow">return</span> <a class="code" href="../../d7/d3b/class_position.html" title="A point in 2D or 3D with translation and scaling methods.">Position</a>(start.<a class="code" href="../../d7/d3b/class_position.html#a51c33a67d08730631a34482850b2203b" title="Returns the x-position.">x</a>() + normx, start.<a class="code" href="../../d7/d3b/class_position.html#a4a65556f1de2548b23ce662f81c7ab1a" title="Returns the y-position.">y</a>() + normy);
<a name="l00797"></a>00797 }
<a name="l00798"></a>00798 
<a name="l00799"></a>00799 
<a name="l00800"></a>00800 <span class="keywordtype">void</span>
<a name="l00801"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#af9db7c1322359dd9bfd375cbf9f55a5c">00801</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#af9db7c1322359dd9bfd375cbf9f55a5c">NIImporter_OpenDrive::calculateCurveCenter</a>(<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>* ad_x, <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>* ad_y, <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> ad_radius, <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> ad_hdg) {
<a name="l00802"></a>00802     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> normX = 1.0;
<a name="l00803"></a>00803     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> normY = 0.0;
<a name="l00804"></a>00804     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> tmpX;
<a name="l00805"></a>00805     <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> turn;
<a name="l00806"></a>00806     <span class="keywordflow">if</span> (ad_radius &gt; 0) {
<a name="l00807"></a>00807         turn = -1.0;
<a name="l00808"></a>00808     } <span class="keywordflow">else</span> {
<a name="l00809"></a>00809         turn = 1.0;
<a name="l00810"></a>00810     }
<a name="l00811"></a>00811 
<a name="l00812"></a>00812     tmpX = normX;
<a name="l00813"></a>00813     normX = normX * cos(ad_hdg) + normY * sin(ad_hdg);
<a name="l00814"></a>00814     normY = tmpX * sin(ad_hdg) + normY * cos(ad_hdg);
<a name="l00815"></a>00815 
<a name="l00816"></a>00816     tmpX = normX;
<a name="l00817"></a>00817     normX = normX * cos(90 * <a class="code" href="../../d1/dc9/polyfonts_8c.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / 180) + turn * normY * sin(90 * <a class="code" href="../../d1/dc9/polyfonts_8c.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / 180);
<a name="l00818"></a>00818     normY = -1 * turn * tmpX * sin(90 * <a class="code" href="../../d1/dc9/polyfonts_8c.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / 180) + normY * cos(90 * <a class="code" href="../../d1/dc9/polyfonts_8c.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / 180);
<a name="l00819"></a>00819 
<a name="l00820"></a>00820     normX = fabs(ad_radius) * normX;
<a name="l00821"></a>00821     normY = fabs(ad_radius) * normY;
<a name="l00822"></a>00822 
<a name="l00823"></a>00823     *ad_x += normX;
<a name="l00824"></a>00824     *ad_y += normY;
<a name="l00825"></a>00825 }
<a name="l00826"></a>00826 
<a name="l00827"></a>00827 
<a name="l00828"></a>00828 <span class="keywordtype">void</span>
<a name="l00829"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a851d207ee5b13f53e0ea8b4d60eed187">00829</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a851d207ee5b13f53e0ea8b4d60eed187">NIImporter_OpenDrive::calcPointOnCurve</a>(<a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>* ad_x, <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a>* ad_y, <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> ad_centerX, <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> ad_centerY,
<a name="l00830"></a>00830                                        <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> ad_r, <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> ad_length) {
<a name="l00831"></a>00831     <span class="keywordtype">double</span> rotAngle = ad_length / fabs(ad_r);
<a name="l00832"></a>00832     <span class="keywordtype">double</span> vx = *ad_x - ad_centerX;
<a name="l00833"></a>00833     <span class="keywordtype">double</span> vy = *ad_y - ad_centerY;
<a name="l00834"></a>00834     <span class="keywordtype">double</span> tmpx;
<a name="l00835"></a>00835 
<a name="l00836"></a>00836     <span class="keywordtype">double</span> turn;
<a name="l00837"></a>00837     <span class="keywordflow">if</span> (ad_r &gt; 0) {
<a name="l00838"></a>00838         turn = -1;    <span class="comment">//left</span>
<a name="l00839"></a>00839     } <span class="keywordflow">else</span> {
<a name="l00840"></a>00840         turn = 1;    <span class="comment">//right</span>
<a name="l00841"></a>00841     }
<a name="l00842"></a>00842     tmpx = vx;
<a name="l00843"></a>00843     vx = vx * cos(rotAngle) + turn * vy * sin(rotAngle);
<a name="l00844"></a>00844     vy = -1 * turn * tmpx * sin(rotAngle) + vy * cos(rotAngle);
<a name="l00845"></a>00845     *ad_x = vx + ad_centerX;
<a name="l00846"></a>00846     *ad_y = vy + ad_centerY;
<a name="l00847"></a>00847 }
<a name="l00848"></a>00848 
<a name="l00849"></a>00849 <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00850"></a>00850 <span class="comment">// loader methods</span>
<a name="l00851"></a>00851 <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00852"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a830a433254c477bc059180277587629a">00852</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a830a433254c477bc059180277587629a" title="Constructor.">NIImporter_OpenDrive::NIImporter_OpenDrive</a>(
<a name="l00853"></a>00853     std::vector&lt;OpenDriveEdge&gt; &amp;innerEdges,
<a name="l00854"></a>00854     std::vector&lt;OpenDriveEdge&gt; &amp;outerEdges)
<a name="l00855"></a>00855     : <a class="code" href="../../da/da8/class_generic_s_a_x_handler.html" title="A handler which converts occuring elements and attributes into enums.">GenericSAXHandler</a>(openDriveTags, OPENDRIVE_TAG_NOTHING, openDriveAttrs, OPENDRIVE_ATTR_NOTHING, <span class="stringliteral">&quot;opendrive&quot;</span>),
<a name="l00856"></a>00856       myCurrentEdge(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, -1), myInnerEdges(innerEdges), myOuterEdges(outerEdges) {
<a name="l00857"></a>00857 }
<a name="l00858"></a>00858 
<a name="l00859"></a>00859 
<a name="l00860"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a35b25f146aab9714d14a2e414cb210e5">00860</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a35b25f146aab9714d14a2e414cb210e5" title="Destructor.">NIImporter_OpenDrive::~NIImporter_OpenDrive</a>() {
<a name="l00861"></a>00861 }
<a name="l00862"></a>00862 
<a name="l00863"></a>00863 
<a name="l00864"></a>00864 <span class="keywordtype">void</span>
<a name="l00865"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3a8a4da27abad774d5ec2515c48fc55e">00865</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3a8a4da27abad774d5ec2515c48fc55e" title="Called on the opening of a tag;.">NIImporter_OpenDrive::myStartElement</a>(<span class="keywordtype">int</span> element,
<a name="l00866"></a>00866                                      <span class="keyword">const</span> <a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html" title="Encapsulated SAX-Attributes.">SUMOSAXAttributes</a>&amp; attrs) {
<a name="l00867"></a>00867     <span class="keywordtype">bool</span> ok = <span class="keyword">true</span>;
<a name="l00868"></a>00868     <span class="keywordflow">switch</span> (element) {
<a name="l00869"></a>00869         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a0f50bbb0aebfd56f36ecd711662f6fc5">OPENDRIVE_TAG_HEADER</a>: {
<a name="l00870"></a>00870             <span class="keywordtype">int</span> majorVersion = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa20314c8b11251d9d6d82566d6b34136" title="Tries to read given attribute assuming it is an int.">getIntReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa1f1b81957a5befc71829fd88aa56eec1">OPENDRIVE_ATTR_REVMAJOR</a>, 0, ok);
<a name="l00871"></a>00871             <span class="keywordtype">int</span> minorVersion = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa20314c8b11251d9d6d82566d6b34136" title="Tries to read given attribute assuming it is an int.">getIntReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa55715db23d89b38b84c6719eb221f11a">OPENDRIVE_ATTR_REVMINOR</a>, 0, ok);
<a name="l00872"></a>00872             <span class="keywordflow">if</span> (majorVersion != 1 || minorVersion != 2) {
<a name="l00873"></a>00873                 <a class="code" href="../../d4/df7/_msg_handler_8h.html#a6875e463bd2d24f027eba135e7a5fdfa">WRITE_WARNING</a>(<span class="stringliteral">&quot;Given openDrive file &#39;&quot;</span> + <a class="code" href="../../da/da8/class_generic_s_a_x_handler.html#a1f77121dce3632bf4642ff0eba72ce04" title="returns the current file name">getFileName</a>() + <span class="stringliteral">&quot;&#39; uses version &quot;</span> + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(majorVersion) + <span class="stringliteral">&quot;.&quot;</span> + <a class="code" href="../../d8/d08/_to_string_8h.html#a18065e342d6bcbee25664108f38176f9">toString</a>(minorVersion) + <span class="stringliteral">&quot;;\n Version 1.2 is supported.&quot;</span>);
<a name="l00874"></a>00874             }
<a name="l00875"></a>00875         }
<a name="l00876"></a>00876         <span class="keywordflow">break</span>;
<a name="l00877"></a>00877         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a3dd9c68b96a9de981266b4ea0b615657">OPENDRIVE_TAG_ROAD</a>: {
<a name="l00878"></a>00878             std::string <span class="keywordtype">id</span> = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#a60fb11617232827b1e57ed41151dd67c" title="Tries to read given attribute assuming it is a string.">getStringReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa34e8f53105030aa1964108ee8874c537">OPENDRIVE_ATTR_ID</a>, 0, ok);
<a name="l00879"></a>00879             std::string junction = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#a60fb11617232827b1e57ed41151dd67c" title="Tries to read given attribute assuming it is a string.">getStringReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa796d1b8ded775ebb9a01929a0d3ce4d7">OPENDRIVE_ATTR_JUNCTION</a>, <span class="keywordtype">id</span>.c_str(), ok);
<a name="l00880"></a>00880             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> length = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa8fca927b8dda4f7a3ebafc4b1195ad41">OPENDRIVE_ATTR_LENGTH</a>, <span class="keywordtype">id</span>.c_str(), ok);
<a name="l00881"></a>00881             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a> = <a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html" title="Representation of an openDrive &amp;quot;link&amp;quot;.">OpenDriveEdge</a>(<span class="keywordtype">id</span>, junction, length);
<a name="l00882"></a>00882         }
<a name="l00883"></a>00883         <span class="keywordflow">break</span>;
<a name="l00884"></a>00884         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14ae2524919b79c3f0970d33c275b9a618f">OPENDRIVE_TAG_PREDECESSOR</a>: {
<a name="l00885"></a>00885             <span class="keywordflow">if</span> (<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>.size() &gt;= 2 &amp;&amp; <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>[<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>.size() - 2] == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a3dd9c68b96a9de981266b4ea0b615657">OPENDRIVE_TAG_ROAD</a>) {
<a name="l00886"></a>00886                 std::string elementType = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#a60fb11617232827b1e57ed41151dd67c" title="Tries to read given attribute assuming it is a string.">getStringReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa699ee0bf7260cd178eca060cc0d170b5">OPENDRIVE_ATTR_ELEMENTTYPE</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00887"></a>00887                 std::string elementID = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#a60fb11617232827b1e57ed41151dd67c" title="Tries to read given attribute assuming it is a string.">getStringReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03faccb0e3a63f132ae37b0cda14e18b8803">OPENDRIVE_ATTR_ELEMENTID</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00888"></a>00888                 std::string contactPoint = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#ae1e4d97d854c6f3a5a422b5666bc6472" title="Returns the information whether the named (by its enum-value) attribute is within...">hasAttribute</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa3b82de75fa66fdaab6f475d5df467cdd">OPENDRIVE_ATTR_CONTACTPOINT</a>)
<a name="l00889"></a>00889                                            ? attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#a60fb11617232827b1e57ed41151dd67c" title="Tries to read given attribute assuming it is a string.">getStringReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa3b82de75fa66fdaab6f475d5df467cdd">OPENDRIVE_ATTR_CONTACTPOINT</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok)
<a name="l00890"></a>00890                                            : <span class="stringliteral">&quot;end&quot;</span>;
<a name="l00891"></a>00891                 <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a439f39d109cfed92a081d2c00871502f">addLink</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07ae7688ceef1eb3024d2753cee8ae7ab21">OPENDRIVE_LT_PREDECESSOR</a>, elementType, elementID, contactPoint);
<a name="l00892"></a>00892             }
<a name="l00893"></a>00893             <span class="keywordflow">if</span> (<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>.size() &gt;= 2 &amp;&amp; <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>[<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>.size() - 2] == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a042509043dc8fa3c76fbcde78b8288d8">OPENDRIVE_TAG_LANE</a>) {
<a name="l00894"></a>00894                 <span class="keywordtype">int</span> no = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa20314c8b11251d9d6d82566d6b34136" title="Tries to read given attribute assuming it is an int.">getIntReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa34e8f53105030aa1964108ee8874c537">OPENDRIVE_ATTR_ID</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00895"></a>00895                 <a class="code" href="../../d9/de3/struct_n_i_importer___open_drive_1_1_open_drive_lane.html" title="Representation of a lane.">OpenDriveLane</a>&amp; l = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>[<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>.size() - 1].lanesByDir[<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6cea0f36787e50a73d9b163139939ee8">myCurrentLaneDirection</a>].back();
<a name="l00896"></a>00896                 l.<a class="code" href="../../d9/de3/struct_n_i_importer___open_drive_1_1_open_drive_lane.html#a367a8affab5d80e695c5a107ba63f2bb">predecessor</a> = no;
<a name="l00897"></a>00897             }
<a name="l00898"></a>00898         }
<a name="l00899"></a>00899         <span class="keywordflow">break</span>;
<a name="l00900"></a>00900         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14add56981f7e1ef0e77ba4884ae61a595a">OPENDRIVE_TAG_SUCCESSOR</a>: {
<a name="l00901"></a>00901             <span class="keywordflow">if</span> (<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>.size() &gt;= 2 &amp;&amp; <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>[<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>.size() - 2] == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a3dd9c68b96a9de981266b4ea0b615657">OPENDRIVE_TAG_ROAD</a>) {
<a name="l00902"></a>00902                 std::string elementType = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#a60fb11617232827b1e57ed41151dd67c" title="Tries to read given attribute assuming it is a string.">getStringReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa699ee0bf7260cd178eca060cc0d170b5">OPENDRIVE_ATTR_ELEMENTTYPE</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00903"></a>00903                 std::string elementID = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#a60fb11617232827b1e57ed41151dd67c" title="Tries to read given attribute assuming it is a string.">getStringReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03faccb0e3a63f132ae37b0cda14e18b8803">OPENDRIVE_ATTR_ELEMENTID</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00904"></a>00904                 std::string contactPoint = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#ae1e4d97d854c6f3a5a422b5666bc6472" title="Returns the information whether the named (by its enum-value) attribute is within...">hasAttribute</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa3b82de75fa66fdaab6f475d5df467cdd">OPENDRIVE_ATTR_CONTACTPOINT</a>)
<a name="l00905"></a>00905                                            ? attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#a60fb11617232827b1e57ed41151dd67c" title="Tries to read given attribute assuming it is a string.">getStringReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa3b82de75fa66fdaab6f475d5df467cdd">OPENDRIVE_ATTR_CONTACTPOINT</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok)
<a name="l00906"></a>00906                                            : <span class="stringliteral">&quot;start&quot;</span>;
<a name="l00907"></a>00907                 <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a439f39d109cfed92a081d2c00871502f">addLink</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07a1193f5a48dbe095884b4c429122564ed">OPENDRIVE_LT_SUCCESSOR</a>, elementType, elementID, contactPoint);
<a name="l00908"></a>00908             }
<a name="l00909"></a>00909             <span class="keywordflow">if</span> (<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>.size() &gt;= 2 &amp;&amp; <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>[<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>.size() - 2] == <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a042509043dc8fa3c76fbcde78b8288d8">OPENDRIVE_TAG_LANE</a>) {
<a name="l00910"></a>00910                 <span class="keywordtype">int</span> no = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa20314c8b11251d9d6d82566d6b34136" title="Tries to read given attribute assuming it is an int.">getIntReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa34e8f53105030aa1964108ee8874c537">OPENDRIVE_ATTR_ID</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00911"></a>00911                 <a class="code" href="../../d9/de3/struct_n_i_importer___open_drive_1_1_open_drive_lane.html" title="Representation of a lane.">OpenDriveLane</a>&amp; l = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>[<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>.size() - 1].lanesByDir[<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6cea0f36787e50a73d9b163139939ee8">myCurrentLaneDirection</a>].back();
<a name="l00912"></a>00912                 l.<a class="code" href="../../d9/de3/struct_n_i_importer___open_drive_1_1_open_drive_lane.html#a64d47bc70ef933ef39091d35b4b23296">successor</a> = no;
<a name="l00913"></a>00913             }
<a name="l00914"></a>00914         }
<a name="l00915"></a>00915         <span class="keywordflow">break</span>;
<a name="l00916"></a>00916         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a8f4f6e0bd0e1b12372b5c30a5b13b327">OPENDRIVE_TAG_GEOMETRY</a>: {
<a name="l00917"></a>00917             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> length = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa8fca927b8dda4f7a3ebafc4b1195ad41">OPENDRIVE_ATTR_LENGTH</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00918"></a>00918             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> s = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa8e6a5154c0fccfb61d8b5337b0e74239">OPENDRIVE_ATTR_S</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00919"></a>00919             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> x = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa345eb6c9a72e5645c9cede23ec518ee3">OPENDRIVE_ATTR_X</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00920"></a>00920             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> y = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa26439c77995dc13c76a20f3840d08d68">OPENDRIVE_ATTR_Y</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00921"></a>00921             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> hdg = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa56b3fe0fb418303b2e7c63d1bd4c36a1">OPENDRIVE_ATTR_HDG</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00922"></a>00922             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae4c771fff9ddb0ad3d530a855907d0d6">geometries</a>.push_back(<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html" title="Representation of an openDrive geometry part.">OpenDriveGeometry</a>(length, s, x, y, hdg));
<a name="l00923"></a>00923         }
<a name="l00924"></a>00924         <span class="keywordflow">break</span>;
<a name="l00925"></a>00925         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14ac864d49f51d0980da4683f3c76e10994">OPENDRIVE_TAG_LINE</a>: {
<a name="l00926"></a>00926             std::vector&lt;SUMOReal&gt; vals;
<a name="l00927"></a>00927             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3472fbd33c8d87ef19946dc08b376600">addGeometryShape</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ffad572af38ec5f0c4ce1052d4bbf34a7516ba7e8a2a6b45d1170e31a57a84e9">OPENDRIVE_GT_LINE</a>, vals);
<a name="l00928"></a>00928         }
<a name="l00929"></a>00929         <span class="keywordflow">break</span>;
<a name="l00930"></a>00930         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a245f5746eb7b8e3b4f4c297dbf104f52">OPENDRIVE_TAG_SPIRAL</a>: {
<a name="l00931"></a>00931             std::vector&lt;SUMOReal&gt; vals;
<a name="l00932"></a>00932             vals.push_back(attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa25d8ab872e54b8acdcf49971da0feef5">OPENDRIVE_ATTR_CURVSTART</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok));
<a name="l00933"></a>00933             vals.push_back(attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03faa106f1e5a6bf5013a82311669e39d9d9">OPENDRIVE_ATTR_CURVEND</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok));
<a name="l00934"></a>00934             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3472fbd33c8d87ef19946dc08b376600">addGeometryShape</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ffad572af38ec5f0c4ce1052d4bbf34ac92aa3ba1401822d079f34517a90f758">OPENDRIVE_GT_SPIRAL</a>, vals);
<a name="l00935"></a>00935         }
<a name="l00936"></a>00936         <span class="keywordflow">break</span>;
<a name="l00937"></a>00937         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14ac7b34de297393dd8cea85329958831e5">OPENDRIVE_TAG_ARC</a>: {
<a name="l00938"></a>00938             std::vector&lt;SUMOReal&gt; vals;
<a name="l00939"></a>00939             vals.push_back(attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa61b82baf2dc060febb47802558f2459b">OPENDRIVE_ATTR_CURVATURE</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok));
<a name="l00940"></a>00940             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3472fbd33c8d87ef19946dc08b376600">addGeometryShape</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ffad572af38ec5f0c4ce1052d4bbf34a24d0b7378aaafa017dbbc7abca79f1a9">OPENDRIVE_GT_ARC</a>, vals);
<a name="l00941"></a>00941         }
<a name="l00942"></a>00942         <span class="keywordflow">break</span>;
<a name="l00943"></a>00943         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a47d8f8ea8e7cdcd8b74cb3fef114e1fa">OPENDRIVE_TAG_POLY3</a>: {
<a name="l00944"></a>00944             std::vector&lt;SUMOReal&gt; vals;
<a name="l00945"></a>00945             vals.push_back(attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fab3aec237cbb25fe73f9732fb73465663">OPENDRIVE_ATTR_A</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok));
<a name="l00946"></a>00946             vals.push_back(attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa7da911dcefd85125a556b36cc4e7d6d1">OPENDRIVE_ATTR_B</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok));
<a name="l00947"></a>00947             vals.push_back(attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa3b0df2eb6319a88fb79adfd7bb6f66b5">OPENDRIVE_ATTR_C</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok));
<a name="l00948"></a>00948             vals.push_back(attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03faab4e01166834c4865e2c6ebfe1b4b752">OPENDRIVE_ATTR_D</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok));
<a name="l00949"></a>00949             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3472fbd33c8d87ef19946dc08b376600">addGeometryShape</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ffad572af38ec5f0c4ce1052d4bbf34a46d82de4b115a5e925d3ecc8fcbd52a6">OPENDRIVE_GT_POLY3</a>, vals);
<a name="l00950"></a>00950         }
<a name="l00951"></a>00951         <span class="keywordflow">break</span>;
<a name="l00952"></a>00952         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14ae3b0b1205ae7890f2736b13563cb9867">OPENDRIVE_TAG_LANESECTION</a>: {
<a name="l00953"></a>00953             <a class="code" href="../../db/d16/config_8h.html#a2481f526aef497857d2b407bc09129fd">SUMOReal</a> s = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa9ec53287d0fee3001f064b9eda3ab3f" title="Tries to read given attribute assuming it is a SUMOReal.">getSUMORealReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa8e6a5154c0fccfb61d8b5337b0e74239">OPENDRIVE_ATTR_S</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00954"></a>00954             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>.push_back(<a class="code" href="../../dc/dd7/struct_n_i_importer___open_drive_1_1_open_drive_lane_section.html" title="Representation of a lane section.">OpenDriveLaneSection</a>(s));
<a name="l00955"></a>00955         }
<a name="l00956"></a>00956         <span class="keywordflow">break</span>;
<a name="l00957"></a>00957         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>:
<a name="l00958"></a>00958             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6cea0f36787e50a73d9b163139939ee8">myCurrentLaneDirection</a> = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a74fe2a8b3cff83300a412d2282121e8c">OPENDRIVE_TAG_LEFT</a>;
<a name="l00959"></a>00959             <span class="keywordflow">break</span>;
<a name="l00960"></a>00960         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a1011a10789624a1655ada99bfa1bab57">OPENDRIVE_TAG_CENTER</a>:
<a name="l00961"></a>00961             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6cea0f36787e50a73d9b163139939ee8">myCurrentLaneDirection</a> = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a1011a10789624a1655ada99bfa1bab57">OPENDRIVE_TAG_CENTER</a>;
<a name="l00962"></a>00962             <span class="keywordflow">break</span>;
<a name="l00963"></a>00963         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a>:
<a name="l00964"></a>00964             <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6cea0f36787e50a73d9b163139939ee8">myCurrentLaneDirection</a> = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a6fcee9305d040d004a7be115f28e1244">OPENDRIVE_TAG_RIGHT</a>;
<a name="l00965"></a>00965             <span class="keywordflow">break</span>;
<a name="l00966"></a>00966         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a042509043dc8fa3c76fbcde78b8288d8">OPENDRIVE_TAG_LANE</a>: {
<a name="l00967"></a>00967             std::string type = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#a60fb11617232827b1e57ed41151dd67c" title="Tries to read given attribute assuming it is a string.">getStringReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fafc3d6edf502b42ce9377971148c5bf3f">OPENDRIVE_ATTR_TYPE</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00968"></a>00968             <span class="keywordtype">int</span> <span class="keywordtype">id</span> = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#aa20314c8b11251d9d6d82566d6b34136" title="Tries to read given attribute assuming it is an int.">getIntReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa34e8f53105030aa1964108ee8874c537">OPENDRIVE_ATTR_ID</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok);
<a name="l00969"></a>00969             std::string level = attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#ae1e4d97d854c6f3a5a422b5666bc6472" title="Returns the information whether the named (by its enum-value) attribute is within...">hasAttribute</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa8ddbc1fca36306301c92d3df6cdb96fd">OPENDRIVE_ATTR_LEVEL</a>)
<a name="l00970"></a>00970                                 ? attrs.<a class="code" href="../../db/ddf/class_s_u_m_o_s_a_x_attributes.html#a60fb11617232827b1e57ed41151dd67c" title="Tries to read given attribute assuming it is a string.">getStringReporting</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a52cabf239edcce701d023c0136c5b03fa8ddbc1fca36306301c92d3df6cdb96fd">OPENDRIVE_ATTR_LEVEL</a>, <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a>.c_str(), ok)
<a name="l00971"></a>00971                                 : <span class="stringliteral">&quot;&quot;</span>;
<a name="l00972"></a>00972             <a class="code" href="../../dc/dd7/struct_n_i_importer___open_drive_1_1_open_drive_lane_section.html" title="Representation of a lane section.">OpenDriveLaneSection</a>&amp; ls = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>[<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ab1a3bd567d4d59713eb115388cfc5cfd">laneSections</a>.size() - 1];
<a name="l00973"></a>00973             ls.<a class="code" href="../../dc/dd7/struct_n_i_importer___open_drive_1_1_open_drive_lane_section.html#a5eb1a91b0fab162adbddfc33ed289437">lanesByDir</a>[<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a6cea0f36787e50a73d9b163139939ee8">myCurrentLaneDirection</a>].push_back(<a class="code" href="../../d9/de3/struct_n_i_importer___open_drive_1_1_open_drive_lane.html" title="Representation of a lane.">OpenDriveLane</a>(<span class="keywordtype">id</span>, level, type));
<a name="l00974"></a>00974         }
<a name="l00975"></a>00975         <span class="keywordflow">break</span>;
<a name="l00976"></a>00976         <span class="keywordflow">default</span>:
<a name="l00977"></a>00977             <span class="keywordflow">break</span>;
<a name="l00978"></a>00978     }
<a name="l00979"></a>00979     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>.push_back(element);
<a name="l00980"></a>00980 }
<a name="l00981"></a>00981 
<a name="l00982"></a>00982 
<a name="l00983"></a>00983 <span class="keywordtype">void</span>
<a name="l00984"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#abccbeeaa1130f91508dfb023ea0313ec">00984</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#abccbeeaa1130f91508dfb023ea0313ec" title="Called when characters occure.">NIImporter_OpenDrive::myCharacters</a>(<span class="keywordtype">int</span> element,
<a name="l00985"></a>00985                                    <span class="keyword">const</span> std::string&amp; chars) {
<a name="l00986"></a>00986     <a class="code" href="../../da/dbd/_std_defs_8h.html#a3c95a90e7806e4b0d21edfae15b73465">UNUSED_PARAMETER</a>(element);
<a name="l00987"></a>00987     <a class="code" href="../../da/dbd/_std_defs_8h.html#a3c95a90e7806e4b0d21edfae15b73465">UNUSED_PARAMETER</a>(chars);
<a name="l00988"></a>00988 }
<a name="l00989"></a>00989 
<a name="l00990"></a>00990 
<a name="l00991"></a>00991 
<a name="l00992"></a>00992 <span class="keywordtype">void</span>
<a name="l00993"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a104902ba95d8bd9b61c32fc540f8316b">00993</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a104902ba95d8bd9b61c32fc540f8316b" title="Called when a closing tag occurs.">NIImporter_OpenDrive::myEndElement</a>(<span class="keywordtype">int</span> element) {
<a name="l00994"></a>00994     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3407329d90dd7d35a21370e274a287b3">myElementStack</a>.pop_back();
<a name="l00995"></a>00995     <span class="keywordflow">switch</span> (element) {
<a name="l00996"></a>00996         <span class="keywordflow">case</span> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a1cb0d42fb77dc0f20bccde8013c66e14a3dd9c68b96a9de981266b4ea0b615657">OPENDRIVE_TAG_ROAD</a>:
<a name="l00997"></a>00997             <span class="keywordflow">if</span> (<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a518ac8c3e12309a93d85d4f3d1c51a2b" title="The id of the junction the edge belongs to.">junction</a> == <span class="stringliteral">&quot;&quot;</span> || <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a518ac8c3e12309a93d85d4f3d1c51a2b" title="The id of the junction the edge belongs to.">junction</a> == <span class="stringliteral">&quot;-1&quot;</span>) {
<a name="l00998"></a>00998                 <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a627dd87b2194b15371da2017da92cf0d">myOuterEdges</a>.push_back(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>);
<a name="l00999"></a>00999             } <span class="keywordflow">else</span> {
<a name="l01000"></a>01000                 <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#abb190f5ebf87ae4f382055d65f6edb9c">myInnerEdges</a>.push_back(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>);
<a name="l01001"></a>01001             }
<a name="l01002"></a>01002             <span class="keywordflow">break</span>;
<a name="l01003"></a>01003         <span class="keywordflow">default</span>:
<a name="l01004"></a>01004             <span class="keywordflow">break</span>;
<a name="l01005"></a>01005     }
<a name="l01006"></a>01006 }
<a name="l01007"></a>01007 
<a name="l01008"></a>01008 
<a name="l01009"></a>01009 
<a name="l01010"></a>01010 <span class="keywordtype">void</span>
<a name="l01011"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a439f39d109cfed92a081d2c00871502f">01011</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a439f39d109cfed92a081d2c00871502f">NIImporter_OpenDrive::addLink</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ae960a6b828ac617d59140479702c8f07">LinkType</a> lt, <span class="keyword">const</span> std::string&amp; elementType,
<a name="l01012"></a>01012                               <span class="keyword">const</span> std::string&amp; elementID,
<a name="l01013"></a>01013                               <span class="keyword">const</span> std::string&amp; contactPoint) {
<a name="l01014"></a>01014     <a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html" title="Representation of an openDrive connection.">OpenDriveLink</a> l(lt, elementID);
<a name="l01015"></a>01015     <span class="comment">// elementType</span>
<a name="l01016"></a>01016     <span class="keywordflow">if</span> (elementType == <span class="stringliteral">&quot;road&quot;</span>) {
<a name="l01017"></a>01017         l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a505427ece8a203068870e2f6324da822">elementType</a> = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a35ac7077f55a8b19c6a7ab928d737835a30c65f222d2f4a2b676084cf0389660d">OPENDRIVE_ET_ROAD</a>;
<a name="l01018"></a>01018     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elementType == <span class="stringliteral">&quot;junction&quot;</span>) {
<a name="l01019"></a>01019         l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a505427ece8a203068870e2f6324da822">elementType</a> = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a35ac7077f55a8b19c6a7ab928d737835a981b4a93749dcd0d684916cbce84c922">OPENDRIVE_ET_JUNCTION</a>;
<a name="l01020"></a>01020     }
<a name="l01021"></a>01021     <span class="comment">// contact point</span>
<a name="l01022"></a>01022     <span class="keywordflow">if</span> (contactPoint == <span class="stringliteral">&quot;start&quot;</span>) {
<a name="l01023"></a>01023         l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a8f28e39325e14094708f1b0f1773a67e">contactPoint</a> = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ad0c9b5bb37efe9f5cc4dd70a5cb6107eab77e17c32fec54df2d360fa279ba4497">OPENDRIVE_CP_START</a>;
<a name="l01024"></a>01024     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (contactPoint == <span class="stringliteral">&quot;end&quot;</span>) {
<a name="l01025"></a>01025         l.<a class="code" href="../../d4/d83/struct_n_i_importer___open_drive_1_1_open_drive_link.html#a8f28e39325e14094708f1b0f1773a67e">contactPoint</a> = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#ad0c9b5bb37efe9f5cc4dd70a5cb6107ead0b89e97aa05133e825ecd4a1262ce7d">OPENDRIVE_CP_END</a>;
<a name="l01026"></a>01026     }
<a name="l01027"></a>01027     <span class="comment">// add</span>
<a name="l01028"></a>01028     <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a896f5170482231e86985a2d25753c989">links</a>.push_back(l);
<a name="l01029"></a>01029 }
<a name="l01030"></a>01030 
<a name="l01031"></a>01031 
<a name="l01032"></a>01032 <span class="keywordtype">void</span>
<a name="l01033"></a><a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3472fbd33c8d87ef19946dc08b376600">01033</a> <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a3472fbd33c8d87ef19946dc08b376600">NIImporter_OpenDrive::addGeometryShape</a>(<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ffad572af38ec5f0c4ce1052d4bbf34">GeometryType</a> type, <span class="keyword">const</span> std::vector&lt;SUMOReal&gt; &amp;vals) {
<a name="l01034"></a>01034     <span class="comment">// checks</span>
<a name="l01035"></a>01035     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae4c771fff9ddb0ad3d530a855907d0d6">geometries</a>.size() == 0) {
<a name="l01036"></a>01036         <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Mismatching paranthesis in geometry definition for road &#39;&quot;</span> + <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a> + <span class="stringliteral">&quot;&#39;&quot;</span>);
<a name="l01037"></a>01037     }
<a name="l01038"></a>01038     <a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html" title="Representation of an openDrive geometry part.">OpenDriveGeometry</a>&amp; last = <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae4c771fff9ddb0ad3d530a855907d0d6">geometries</a>[<a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#ae4c771fff9ddb0ad3d530a855907d0d6">geometries</a>.size() - 1];
<a name="l01039"></a>01039     <span class="keywordflow">if</span> (last.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a1e1eef4175f65d8731791951330693f8">type</a> != <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ffad572af38ec5f0c4ce1052d4bbf34a53d0ebf6f428913486b39575085d8bfd">OPENDRIVE_GT_UNKNOWN</a>) {
<a name="l01040"></a>01040         <span class="keywordflow">throw</span> <a class="code" href="../../da/d18/class_process_error.html">ProcessError</a>(<span class="stringliteral">&quot;Double geometry information for road &#39;&quot;</span> + <a class="code" href="../../d7/d17/class_n_i_importer___open_drive.html#a8ef96479aaa3ee20875f31ae04b15f8b">myCurrentEdge</a>.<a class="code" href="../../d5/d28/struct_n_i_importer___open_drive_1_1_open_drive_edge.html#a2a1936e1ecb5c660b9430e09b70a7f5b" title="The id of the edge.">id</a> + <span class="stringliteral">&quot;&#39;&quot;</span>);
<a name="l01041"></a>01041     }
<a name="l01042"></a>01042     <span class="comment">// set</span>
<a name="l01043"></a>01043     last.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a1e1eef4175f65d8731791951330693f8">type</a> = type;
<a name="l01044"></a>01044     last.<a class="code" href="../../d1/d7e/struct_n_i_importer___open_drive_1_1_open_drive_geometry.html#a63ec5c38890b91338c1071fca1f352bf">params</a> = vals;
<a name="l01045"></a>01045 }
<a name="l01046"></a>01046 
<a name="l01047"></a>01047 
<a name="l01048"></a>01048 <span class="comment">/****************************************************************************/</span>
<a name="l01049"></a>01049 
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Jul 17 12:16:06 2012 for SUMO - Simulation of Urban MObility by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
